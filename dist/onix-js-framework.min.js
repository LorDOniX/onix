/**
 * OnixJS framework
 * 2.7.3/8. 7. 2016
 * source: https://gitlab.com/LorDOniX/onix
 * documentation: https://gitlab.com/LorDOniX/onix/tree/master/docs

 * @license MIT
 * - Free for use in both personal and commercial projects
 */
function _classCallCheck2(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==("undefined"==typeof e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==("undefined"==typeof e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==("undefined"==typeof e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==("undefined"==typeof e?"undefined":_typeof2(e))&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof e?"undefined":_typeof2(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}if(function(){Event=Event||window.Event,Event.prototype.stopPropagation=Event.prototype.stopPropagation||function(){this.cancelBubble=!0},Event.prototype.preventDefault=Event.prototype.preventDefault||function(){this.returnValue=!1}}(),"btoa"in window||(window.btoa=function(t){return t}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),function(){"use strict";var t=Array.prototype.slice;try{t.call(document.documentElement)}catch(e){Array.prototype.slice=function(e,n){if(n="undefined"!=typeof n?n:this.length,"[object Array]"===Object.prototype.toString.call(this))return t.call(this,e,n);var i,o,r=[],s=this.length,a=e||0;a=a>=0?a:Math.max(0,s+a);var c="number"==typeof n?Math.min(n,s):s;if(n<0&&(c=s+n),o=c-a,o>0)if(r=new Array(o),this.charAt)for(i=0;i<o;i++)r[i]=this.charAt(a+i);else for(i=0;i<o;i++)r[i]=this[a+i];return r}}}(),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){for(var n=this.length,i=0;i<n;i++)i in this&&t.call(e,this[i],i,this)}),Array.prototype.every||(Array.prototype.every=function(t,e){for(var n=this.length,i=0;i<n;i++)if(i in this&&!t.call(e,this[i],i,this))return!1;return!0}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){var n=this.length,i=e||0;for(i<0&&(i+=n);i<n;i++)if(i in this&&this[i]===t)return i;return-1}),!("console"in window)){var emptyFn=function(){};window.console={},["log","warn","error","clear","info"].forEach(function(t){window.console[t]=emptyFn})}if(Function.prototype.bind||(Function.prototype.bind=function(t){var e=this,n=Array.prototype.slice.call(arguments,1);return function(){return e.apply(t,n.concat(Array.prototype.slice.call(arguments)))}}),!("addEventListener"in document)){var w=Window.prototype,h=HTMLDocument.prototype,e=Element.prototype;document.addEventListener=w.addEventListener=h.addEventListener=e.addEventListener=function(t,e){if(this.__eventListeners||(this.__eventListeners={}),"DOMContentLoaded"==t)this.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&e()});else{this.__eventListeners[t]||(this.__eventListeners[t]=[]);var n=function(){return e.apply(this,arguments)}.bind(this);this.__eventListeners[t].push({fn:n,listener:e}),this.attachEvent("on"+t,n)}},document.removeEventListener=w.removeEventListener=h.removeEventListener=e.removeEventListener=function(t,e){for(var n=this.__eventListeners||{},i=n[t]||[],o=null,r=-1,s=0;s<i.length;s++){var a=i[s];if(a.listener==e){o=a.fn,r=s;break}}return o?(i.splice(r,1),i.length||delete n[t],this.detachEvent("on"+t,o)):null}}"classList"in document.documentElement||!window.Element||!function(){function t(t){if(this._element=t,t.className!=this._classCache&&(this._classCache=t.className,this._classCache))for(var e=this._classCache.replace(/^\s+|\s+$/g,"").split(/\s+/),n=0;n<e.length;n++)s.call(this,e[n])}function e(t,e){t.className=e.join(" ")}function n(t,e,n){Object.defineProperty?Object.defineProperty(t,e,{get:n}):t.__defineGetter__(e,n)}var i=Array.prototype,o=i.indexOf,r=i.slice,s=i.push,a=i.splice,c=i.join;window.DOMTokenList=t,t.prototype={add:function(t){this.contains(t)||(s.call(this,t),e(this._element,r.call(this,0)))},contains:function(t){return o.call(this,t)!=-1},item:function(t){return this[t]||null},remove:function(t){var n=o.call(this,t);n!=-1&&(a.call(this,n,1),e(this._element,r.call(this,0)))},toString:function(){return c.call(this," ")},toggle:function(t){return o.call(this,t)==-1?(this.add(t),!0):(this.remove(t),!1)}},n(Element.prototype,"classList",function(){return new t(this)})}(),Date.now||(Date.now=function(){return+new Date}),function(t,e){"use strict";"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.returnExports=e()}(this,function(){var t,e,n,i,o=Function.call,r=Object.prototype,s=o.bind(r.hasOwnProperty),a=o.bind(r.propertyIsEnumerable),c=o.bind(r.toString),h=s(r,"__defineGetter__");h&&(t=o.bind(r.__defineGetter__),e=o.bind(r.__defineSetter__),n=o.bind(r.__lookupGetter__),i=o.bind(r.__lookupSetter__)),Object.keys||(Object.keys=function(){"use strict";var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],i=n.length;return function(o){if("object"!=typeof o&&("function"!=typeof o||null===o))throw new TypeError("Object.keys called on non-object");var r,s,a=[];for(r in o)t.call(o,r)&&a.push(r);if(e)for(s=0;s<i;s++)t.call(o,n[s])&&a.push(n[s]);return a}}()),Object.getPrototypeOf||(Object.getPrototypeOf=function(t){var e=t.__proto__;return e||null===e?e:"[object Function]"===c(t.constructor)?t.constructor.prototype:t instanceof Object?r:null});var u=function(t){try{return t.sentinel=0,0===Object.getOwnPropertyDescriptor(t,"sentinel").value}catch(e){return!1}};if(Object.defineProperty){var l=u({}),p="undefined"==typeof document||u(document.createElement("div"));if(!p||!l)var f=Object.getOwnPropertyDescriptor}if(!Object.getOwnPropertyDescriptor||f){var d="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(t,e){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError(d+t);if(f)try{return f.call(Object,t,e)}catch(o){}var c;if(!s(t,e))return c;if(c={enumerable:a(t,e),configurable:!0},h){var u=t.__proto__,l=t!==r;l&&(t.__proto__=r);var p=n(t,e),_=i(t,e);if(l&&(t.__proto__=u),p||_)return p&&(c.get=p),_&&(c.set=_),c}return c.value=t[e],c.writable=!0,c}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(t){return Object.keys(t)}),!Object.create){var _,y=!({__proto__:null}instanceof Object),m=function(){if(!document.domain)return!1;try{return!!new ActiveXObject("htmlfile")}catch(t){return!1}},v=function(){var t,e;return e=new ActiveXObject("htmlfile"),e.write("<script></script>"),e.close(),t=e.parentWindow.Object.prototype,e=null,t},g=function(){var t,e=document.createElement("iframe"),n=document.body||document.documentElement;return e.style.display="none",n.appendChild(e),e.src="javascript:",t=e.contentWindow.Object.prototype,n.removeChild(e),e=null,t};_=y||"undefined"==typeof document?function(){return{__proto__:null}}:function(){var t=m()?v():g();delete t.constructor,delete t.hasOwnProperty,delete t.propertyIsEnumerable,delete t.isPrototypeOf,delete t.toLocaleString,delete t.toString,delete t.valueOf;var e=function(){};return e.prototype=t,_=function(){return new e},new e},Object.create=function(t,e){var n,i=function(){};if(null===t)n=_();else{if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object prototype may only be an Object or null");i.prototype=t,n=new i,n.__proto__=t}return void 0!==e&&Object.defineProperties(n,e),n}}var w=function(t){try{return Object.defineProperty(t,"sentinel",{}),"sentinel"in t}catch(e){return!1}};if(Object.defineProperty){var E=w({}),b="undefined"==typeof document||w(document.createElement("div"));if(!E||!b)var C=Object.defineProperty,S=Object.defineProperties}if(!Object.defineProperty||C){var x="Property description must be an object: ",T="Object.defineProperty called on non-object: ",O="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(o,s,a){if("object"!=typeof o&&"function"!=typeof o||null===o)throw new TypeError(T+o);if("object"!=typeof a&&"function"!=typeof a||null===a)throw new TypeError(x+a);if(C)try{return C.call(Object,o,s,a)}catch(c){}if("value"in a)if(h&&(n(o,s)||i(o,s))){var u=o.__proto__;o.__proto__=r,delete o[s],o[s]=a.value,o.__proto__=u}else o[s]=a.value;else{if(!h&&("get"in a||"set"in a))throw new TypeError(O);"get"in a&&t(o,s,a.get),"set"in a&&e(o,s,a.set)}return o}}Object.defineProperties&&!S||(Object.defineProperties=function(t,e){if(S)try{return S.call(Object,t,e)}catch(n){}return Object.keys(e).forEach(function(n){"__proto__"!==n&&Object.defineProperty(t,n,e[n])}),t}),Object.seal||(Object.seal=function(t){if(Object(t)!==t)throw new TypeError("Object.seal can only be called on Objects.");return t}),Object.freeze||(Object.freeze=function(t){if(Object(t)!==t)throw new TypeError("Object.freeze can only be called on Objects.");return t});try{Object.freeze(function(){})}catch(L){Object.freeze=function(t){return function(e){return"function"==typeof e?e:t(e)}}(Object.freeze)}Object.preventExtensions||(Object.preventExtensions=function(t){if(Object(t)!==t)throw new TypeError("Object.preventExtensions can only be called on Objects.");return t}),Object.isSealed||(Object.isSealed=function(t){if(Object(t)!==t)throw new TypeError("Object.isSealed can only be called on Objects.");return!1}),Object.isFrozen||(Object.isFrozen=function(t){if(Object(t)!==t)throw new TypeError("Object.isFrozen can only be called on Objects.");return!1}),Object.isExtensible||(Object.isExtensible=function(t){if(Object(t)!==t)throw new TypeError("Object.isExtensible can only be called on Objects.");for(var e="";s(t,e);)e+="?";t[e]=!0;var n=s(t,e);return delete t[e],n})}),function(){function t(t){return!!t.exifdata}function e(t,e){e=e||t.match(/^data\:([^\;]+)\;base64,/im)[1]||"",t=t.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var n=atob(t),i=n.length,o=new ArrayBuffer(i),r=new Uint8Array(o),s=0;s<i;s++)r[s]=n.charCodeAt(s);return o}function i(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="blob",n.onload=function(t){200!=this.status&&0!==this.status||e(this.response)},n.send()}function o(t,n){function o(e){var i=r(e),o=s(e);t.exifdata=i||{},t.iptcdata=o||{},n&&n.call(t)}if(t.src)if(/^data\:/i.test(t.src)){var a=e(t.src);o(a)}else if(/^blob\:/i.test(t.src)){var c=new FileReader;c.onload=function(t){o(t.target.result)},i(t.src,function(t){c.readAsArrayBuffer(t)})}else{var h=new XMLHttpRequest;h.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";o(h.response),h=null},h.open("GET",t.src,!0),h.responseType="arraybuffer",h.send(null)}else if(window.FileReader&&(t instanceof window.Blob||t instanceof window.File)){var c=new FileReader;c.onload=function(t){p&&console.log("Got file of length "+t.target.result.byteLength),o(t.target.result)},c.readAsArrayBuffer(t)}}function r(t){var e=new DataView(t);if(p&&console.log("Got file of length "+t.byteLength),255!=e.getUint8(0)||216!=e.getUint8(1))return p&&console.log("Not a valid JPEG"),!1;for(var n,i=2,o=t.byteLength;i<o;){if(255!=e.getUint8(i))return p&&console.log("Not a valid marker at offset "+i+", found: "+e.getUint8(i)),!1;if(n=e.getUint8(i+1),p&&console.log(n),225==n)return p&&console.log("Found 0xFFE1 marker"),l(e,i+4,e.getUint16(i+2)-2);i+=2+e.getUint16(i+2)}}function s(t){var e=new DataView(t);if(p&&console.log("Got file of length "+t.byteLength),255!=e.getUint8(0)||216!=e.getUint8(1))return p&&console.log("Not a valid JPEG"),!1;for(var n=2,i=t.byteLength,o=function(t,e){return 56===t.getUint8(e)&&66===t.getUint8(e+1)&&73===t.getUint8(e+2)&&77===t.getUint8(e+3)&&4===t.getUint8(e+4)&&4===t.getUint8(e+5)};n<i;){if(o(e,n)){var r=e.getUint8(n+7);r%2!==0&&(r+=1),0===r&&(r=4);var s=n+8+r,c=e.getUint16(n+6+r);return a(t,s,c)}n++}}function a(t,e,n){for(var i,o,r,s,a,c=new DataView(t),h={},l=e;l<e+n;)28===c.getUint8(l)&&2===c.getUint8(l+1)&&(s=c.getUint8(l+2),s in g&&(r=c.getInt16(l+3),a=r+5,o=g[s],i=u(c,l+5,r),h.hasOwnProperty(o)?h[o]instanceof Array?h[o].push(i):h[o]=[h[o],i]:h[o]=i)),l++;return h}function c(t,e,n,i,o){var r,s,a,c=t.getUint16(n,!o),u={};for(a=0;a<c;a++)r=n+12*a+2,s=i[t.getUint16(r,!o)],!s&&p&&console.log("Unknown tag: "+t.getUint16(r,!o)),u[s]=h(t,r,e,n,o);return u}function h(t,e,n,i,o){var r,s,a,c,h,l,p=t.getUint16(e+2,!o),f=t.getUint32(e+4,!o),d=t.getUint32(e+8,!o)+n;switch(p){case 1:case 7:if(1==f)return t.getUint8(e+8,!o);for(r=f>4?d:e+8,s=[],c=0;c<f;c++)s[c]=t.getUint8(r+c);return s;case 2:return r=f>4?d:e+8,u(t,r,f-1);case 3:if(1==f)return t.getUint16(e+8,!o);for(r=f>2?d:e+8,s=[],c=0;c<f;c++)s[c]=t.getUint16(r+2*c,!o);return s;case 4:if(1==f)return t.getUint32(e+8,!o);for(s=[],c=0;c<f;c++)s[c]=t.getUint32(d+4*c,!o);return s;case 5:if(1==f)return h=t.getUint32(d,!o),l=t.getUint32(d+4,!o),a=new Number(h/l),a.numerator=h,a.denominator=l,a;for(s=[],c=0;c<f;c++)h=t.getUint32(d+8*c,!o),l=t.getUint32(d+4+8*c,!o),s[c]=new Number(h/l),s[c].numerator=h,s[c].denominator=l;return s;case 9:if(1==f)return t.getInt32(e+8,!o);for(s=[],c=0;c<f;c++)s[c]=t.getInt32(d+4*c,!o);return s;case 10:if(1==f)return t.getInt32(d,!o)/t.getInt32(d+4,!o);for(s=[],c=0;c<f;c++)s[c]=t.getInt32(d+8*c,!o)/t.getInt32(d+4+8*c,!o);return s}}function u(t,e,i){var o="";for(n=e;n<e+i;n++)o+=String.fromCharCode(t.getUint8(n));return o}function l(t,e){if("Exif"!=u(t,e,4))return p&&console.log("Not valid EXIF data! "+u(t,e,4)),!1;var n,i,o,r,s,a=e+6;if(18761==t.getUint16(a))n=!1;else{if(19789!=t.getUint16(a))return p&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;n=!0}if(42!=t.getUint16(a+2,!n))return p&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var h=t.getUint32(a+4,!n);if(h<8)return p&&console.log("Not valid TIFF data! (First offset less than 8)",t.getUint32(a+4,!n)),!1;if(i=c(t,a,a+h,y,n),i.ExifIFDPointer){r=c(t,a,a+i.ExifIFDPointer,_,n);for(o in r){switch(o){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":r[o]=v[o][r[o]];break;case"ExifVersion":case"FlashpixVersion":r[o]=String.fromCharCode(r[o][0],r[o][1],r[o][2],r[o][3]);break;case"ComponentsConfiguration":r[o]=v.Components[r[o][0]]+v.Components[r[o][1]]+v.Components[r[o][2]]+v.Components[r[o][3]]}i[o]=r[o]}}if(i.GPSInfoIFDPointer){s=c(t,a,a+i.GPSInfoIFDPointer,m,n);for(o in s){switch(o){case"GPSVersionID":s[o]=s[o][0]+"."+s[o][1]+"."+s[o][2]+"."+s[o][3]}i[o]=s[o]}}return i}var p=!1,f=this,d=function(t){return t instanceof d?t:this instanceof d?void(this.EXIFwrapped=t):new d(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=d),exports.EXIF=d):f.EXIF=d;var _=d.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},y=d.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},m=d.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},v=d.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}},g={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};d.getData=function(e,n){return!((e instanceof Image||e instanceof HTMLImageElement)&&!e.complete)&&(t(e)?n&&n.call(e):o(e,n),!0)},d.getTag=function(e,n){if(t(e))return e.exifdata[n]},d.getAllTags=function(e){if(!t(e))return{};var n,i=e.exifdata,o={};for(n in i)i.hasOwnProperty(n)&&(o[n]=i[n]);return o},d.pretty=function(e){if(!t(e))return"";var n,i=e.exifdata,o="";for(n in i)i.hasOwnProperty(n)&&(o+="object"==typeof i[n]?i[n]instanceof Number?n+" : "+i[n]+" ["+i[n].numerator+"/"+i[n].denominator+"]\r\n":n+" : ["+i[n].length+" values]\r\n":n+" : "+i[n]+"\r\n");return o},d.readFromBinaryFile=function(t){return r(t)},"function"==typeof define&&define.amd&&define("exif-js",[],function(){return d})}.call(this);var _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};onix=function(){var t=function(){function t(e,n){_classCallCheck2(this,t),this._objects={},this._runs=[],this._configs=[],this._name=e||"",this._dependencies=n||[]}return t.parseParam=function(t){var e=void 0,n=[];return Array.isArray(t)?t.every(function(t){return"function"==typeof t?(e=t,!1):("string"==typeof t&&n.push(t),!0)}):e=t,{fn:e,inject:n}},t.getFilterName=function(e){return e=e||"",t.CONST.FILTER_NAME+e[0].toUpperCase()+e.substr(1)},t.prototype.getDependencies=function(){return this._dependencies},t.prototype.getName=function(){return this._name},t.prototype.getConfigs=function(){return this._configs},t.prototype.getRuns=function(){return this._runs},t.prototype.getObjects=function(){return this._objects},t.prototype.provider=function(e,n){if(!e||!n)return this;var i=t.parseParam(n);return this._objects[e+t.CONST.PROVIDER_NAME]={name:e+t.CONST.PROVIDER_NAME,inject:i.inject,fn:i.fn,cache:null,type:t.CONST.TYPE.PROVIDER},this._objects[e]={name:e,inject:null,fn:null,cache:null,provider:e+t.CONST.PROVIDER_NAME,type:t.CONST.TYPE.FACTORY},this},t.prototype.service=function(e,n){if(!e||!n)return this;var i=t.parseParam(n);return this._objects[e]={name:e,inject:i.inject,fn:i.fn,cache:null,type:t.CONST.TYPE.SERVICE},this},t.prototype.factory=function(e,n){if(!e||!n)return this;var i=t.parseParam(n);return this._objects[e]={name:e,inject:i.inject,fn:i.fn,cache:null,type:t.CONST.TYPE.FACTORY},this},t.prototype.constant=function(e,n){return e&&n?(this._objects[e]={name:e,cache:n,type:t.CONST.TYPE.CONSTANT},this):this},t.prototype.value=function(e,n){return e&&n?(this._objects[e]={name:e,cache:n,type:t.CONST.TYPE.VALUE},this):this},t.prototype.filter=function(e,n){if(!e||!n)return this;var i=t.parseParam(n);return this._objects[t.getFilterName(e)]={name:e,inject:i.inject,fn:i.fn,cache:null,type:t.CONST.TYPE.FILTER},this},t.prototype.config=function(e){if(!e)return this;var n=t.parseParam(e);return this._configs.push({fn:n.fn,inject:n.inject,type:t.CONST.TYPE.CONFIG}),this},t.prototype.run=function(e){if(!e)return this;var n=t.parseParam(e);return this._runs.push({fn:n.fn,inject:n.inject,type:t.CONST.TYPE.RUN}),this},t.prototype.controller=function(){return this},t.prototype.directive=function(){return this},t}();t.CONST={PROVIDER_NAME:"Provider",FILTER_NAME:"$filter",TYPE:{PROVIDER:1,SERVICE:2,FACTORY:3,CONSTANT:4,VALUE:5,FILTER:6,CONFIG:7,RUN:8}};var e=function(){function e(){var t=this;_classCallCheck2(this,e),this._modules=[],this._modulesObj={},this._CONST={MODULE_SEPARATOR:"::"},document.addEventListener("DOMContentLoaded",function(){t._domLoad()})}return e.prototype._domLoad=function(){var t=this,e=[],n=[];this._modules.forEach(function(i){var o=!1,r=i.getDependencies();r.every(function(e){return e in t._modulesObj||(console.error("Module '"+t._name+"' dependency '"+e+"' not found!"),o=!0,!1)}),o||(e=e.concat(i.getConfigs()),n=n.concat(i.getRuns()))}),e.forEach(function(e){t.run(e,!0)}),n.forEach(function(e){t.run(e)})},e.prototype._getObject=function(t){var e=null,n="",i="";if(t.indexOf(this._CONST.MODULE_SEPARATOR)!=-1){var o=t.split(this._CONST.MODULE_SEPARATOR);if(2!=o.length)return console.error("Get object "+t+" error! Wrong module separator use."),null;n=o[0],i=o[1]}else i=t;return this._modules.every(function(t){var o=t.getObjects();return n?t.getName()!=n||(i in o?(e=o[i],!1):(console.error("Get object "+i+" error! Cannot find object in the module "+n+"."),!1)):!(i in o)||(e=o[i],!1)}),e},e.prototype.noop=function(){},e.prototype.run=function(e,n,i){var o=this;if(i=i||[],i.indexOf(e.name)!=-1)return console.error("Circular dependency error! Object name: "+e.name+", parents: "+i.join("|")),null;var r=[];if(e.provider){var s=this._getObject(e.provider);if(!s.cache){var a=s.fn||this.noop;s.cache=new a}var c=s.cache.$get||this.noop,h=t.parseParam(c);e.fn=h.fn,e.inject=h.inject,delete e.provider}if(e.inject&&e.inject.length&&e.inject.forEach(function(t){if("string"==typeof t){var s=o._getObject(t);s?r.push(o.run(s,n,e.name?i.concat(e.name):i)):(console.error("Object name: "+t+" not found!"),r.push(null))}else"object"===("undefined"==typeof t?"undefined":_typeof2(t))&&r.push(t)}),n)switch(e.type){case t.CONST.TYPE.PROVIDER:if(!e.cache){var u=e.fn||this.noop;e.cache=new u}return e.cache;case t.CONST.TYPE.CONSTANT:return e.cache;case t.CONST.TYPE.CONFIG:var l=e.fn||this.noop;return l.apply(l,r);default:return null}else switch(e.type){case t.CONST.TYPE.FACTORY:case t.CONST.TYPE.FILTER:if(!e.cache){var p=e.fn||this.noop;e.cache=p.apply(p,r)}return e.cache;case t.CONST.TYPE.SERVICE:if(!e.cache){var f=e.fn||this.noop,d=Object.create(f.prototype);f.apply(d,r),e.cache=d}return e.cache;case t.CONST.TYPE.VALUE:return e.cache;case t.CONST.TYPE.CONSTANT:return e.cache;case t.CONST.TYPE.RUN:var _=e.fn||this.noop;return _.apply(_,r);default:return null}},e.prototype.addModule=function(e,n){var i=new t(e,n);return this._modulesObj[e]=i,this._modules.push(i),i},e}(),n=new e,i=n.addModule("onix");return i.module=function(t,e){return n.addModule(t,e)},i.noop=n.noop,i.info=function(){console.log("OnixJS framework\n2.7.3/8. 7. 2016\nsource: https://gitlab.com/LorDOniX/onix\ndocumentation: https://gitlab.com/LorDOniX/onix/tree/master/docs\n@license MIT\n- Free for use in both personal and commercial projects\n")},i.factory("$di",function(){return{parseParam:t.parseParam,getFilterName:t.getFilterName,run:function(e){return e?(e.fn||(e.fn=function(){}),e.type=t.CONST.TYPE.RUN,n.run(e)):null}}}),i}(),onix.factory("$filter",["$di",function(t){return function(e){var n=function(t){return t||""};return e?t.run({fn:function(t){return t||n},inject:[t.getFilterName(e)]}):n}}]),onix.service("$common",["$promise",function(t){this._objCopy=function(t,e){var n=this;Object.keys(e).forEach(function(i){e.hasOwnProperty(i)&&(t[i]=n.cloneValue(e[i]))})},this._chainPromisesInner=function(t,e,n){var i=this,o=t.shift();if(o){var r=void 0,s=!1;switch(_typeof2(o.method)){case"string":o.scope&&o.method in o.scope?(r=o.scope[o.method],"function"!=typeof r&&(s=!0)):s=!0;break;case"function":r=o.method;break;default:s=!0}s?e(n):r.apply(o.scope||r,o.args||[]).then(function(o){n.push(o),i._chainPromisesInner(t,e,n)},function(o){n.push(o),i._chainPromisesInner(t,e,n)})}else e(n)},this.confirm=function(e){return new t(function(t,n){confirm(e)?t():n()})},this.merge=function(){var t=arguments.length,e={};if(t>0)for(var n=0;n<t;n++){var i=arguments[n];this._objCopy(e,i)}return e},this.extend=function(t,e){t=t||{},e=e||{},this._objCopy(t,e)},this.cloneValue=function(t,e){var n=this;if(e=e||1,e>100)return null;switch("undefined"==typeof t?"undefined":_typeof2(t)){case"object":if(Array.isArray(t)){var i=function(){var i=[];return t.forEach(function(t){i.push(n.cloneValue(t,e+1))}),{v:i}}();if("object"===("undefined"==typeof i?"undefined":_typeof2(i)))return i.v}else{if(t instanceof Date)return new Date(t.getTime());if(t instanceof Element)return t;if(!t)return null;var o=function(){var i={};return Object.keys(t).forEach(function(o){t.hasOwnProperty(o)&&(i[o]=n.cloneValue(t[o],e+1))}),{v:i}}();if("object"===("undefined"==typeof o?"undefined":_typeof2(o)))return o.v}case"undefined":case"function":case"number":case"string":return t}},this.inherit=function(){var t=arguments;if(!(t.length<2)){var e=t[0].prototype,n=Array.prototype.slice.call(t,1);n.forEach(function(t){for(var n in t.prototype)e[n]="object"!=_typeof2(t.prototype[n])?t.prototype[n]:JSON.parse(JSON.stringify(t.prototype[n]))})}},this.bindWithoutScope=function(t){var e=Array.prototype.slice.call(arguments,1);
return function(){var n=Array.prototype.slice.call(arguments,0),i=Array.prototype.concat(n,e);return t.apply(this,i)}},this.nodesForEach=function(t,e,n){"function"==typeof e&&t&&Array.prototype.slice.call(t).forEach(function(t,i){e.apply(n||e,[t,i])})},this.reverseForEach=function(t,e,n){if("function"==typeof e){t=t||[];for(var i=t.length-1;i>=0;i--)e.apply(n||this,[t[i],i])}},this.hexToD=function(t){switch(t=t.toLowerCase()){case"a":return 10;case"b":return 11;case"c":return 12;case"d":return 13;case"e":return 14;case"f":return 15;default:return parseInt(t,10)}},this.hexToRGB=function(t){return"#"==t[0]?(t=t.replace("#",""),3==t.length?{r:16*this.hexToD(t[0])+this.hexToD(t[0]),g:16*this.hexToD(t[1])+this.hexToD(t[1]),b:16*this.hexToD(t[2])+this.hexToD(t[2])}:{r:16*this.hexToD(t[0])+this.hexToD(t[1]),g:16*this.hexToD(t[2])+this.hexToD(t[3]),b:16*this.hexToD(t[4])+this.hexToD(t[5])}):t},this.isElement=function(t){return t instanceof HTMLElement},this.isObject=function(t){return"object"===("undefined"==typeof t?"undefined":_typeof2(t))&&!Array.isArray(t)&&null!==t},this.col=function(){var t=Array.prototype.slice.call(arguments),e="",n={};t.forEach(function(t,i){0==i?e=t:n["[{]"+(i-1)+"[}]"]=t}),Object.keys(n).forEach(function(t){e=e.replace(new RegExp(t,"g"),n[t])}),e&&console.log(e)},this.formatSize=function(t){if("number"!=typeof t)return"null";var e=t>0?Math.floor(Math.log(t)/Math.log(1e3)):0,n=["","K","M","G","T"];e=Math.min(n.length,e);var i=e>0?(t/Math.pow(1e3,e)).toFixed(2):t;return i+" "+n[e]+"B"},this.chainPromises=function(e){var n=this;return new t(function(t){n._chainPromisesInner(e,t,[])})},this.cancelEvents=function(t){t&&(t.stopPropagation(),t.preventDefault())},this.cssNameToJS=function(t){var e=t.split("-"),n="";return e.forEach(function(t,e){n+=e?t[0].toUpperCase()+t.substr(1):t}),n}}]),onix.service("$cookie",["$date",function(t){this._CONST={EXPIRES:{MAX:"Fri, 31 Dec 9999 23:59:59 GMT",MIN:"Thu, 01 Jan 1970 00:00:00 GMT"}},this.set=function(e,n,i){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var o={expiration:t.addDays(new Date,30),path:"",domain:"",secure:""},r="";if(o.expiration)switch(o.expiration.constructor){case Number:r=o.expiration===1/0?"; expires="+this._CONST.EXPIRES.MAX:"; max-age="+o.expiration;break;case String:r="; expires="+o.expiration;break;case Date:r="; expires="+o.expiration.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(n)+r+(o.domain?"; domain="+o.domain:"")+(o.path?"; path="+o.path:"")+(o.secure?"; secure":""),!0},this.get=function(t){t=t||"";var e=null;if(document.cookie&&""!=document.cookie){var n=document.cookie.split(";");n.every(function(n){return n=n.trim(),n.substring(0,t.length+1)!=t+"="||(e=decodeURIComponent(n.substring(t.length+1)),!1)})}return e},this.remove=function(t,e,n){return!!this.contains(t)&&(document.cookie=encodeURIComponent(t)+"=; expires="+this._CONST.EXPIRES.MIN+(e?"; domain="+e:"")+(n?"; path="+n:""),!0)},this.contains=function(t){return!!t&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}}]),onix.service("$date",function(){this.dateENtoCS=function(t){t=t||"";var e=t.split("-");return 3==e.length?[e[2].replace(/^0/,""),e[1].replace(/^0/,""),e[0]].join(". "):""},this.dateCStoEN=function(t){t=t||"";var e=t.split(".");if(3==e.length){var n=e[2].trim(),i=e[1].trim(),o=e[0].trim();return o=1==o.length?"0"+o:o,i=1==i.length?"0"+i:i,[n,i,o].join("-")}return""},this.isCSdate=function(t){return t=t||"",!!t.match(/([1-9]|[1-3][0-9])\.[ ]*([1-9]|1[0-2])\.[ ]*[1-9][0-9]{3}/)},this.addDays=function(t,e){e=e||0;var n=864e5*e;return new Date(t.getTime()+n)}}),onix.service("$dom",["$common",function(t){this.create=function(e,n){var i=this,o=document.createElement(e.el||"div");return Object.keys(e).forEach(function(r){var s=void 0;switch(r){case"el":break;case"attrs":s=e.attrs,s&&"object"===("undefined"==typeof s?"undefined":_typeof2(s))&&!Array.isArray(s)&&Object.keys(s).forEach(function(t){o.setAttribute(t,s[t])});break;case"css":s=e.css,s&&"object"===("undefined"==typeof s?"undefined":_typeof2(s))&&!Array.isArray(s)&&Object.keys(s).forEach(function(e){o.style[t.cssNameToJS(e)]=s[e]});break;case"events":s=e.events,Array.isArray(s)||(s=[s]),s.forEach(function(t){o.addEventListener(item.event,item.fn)});break;case"child":s=e.child,Array.isArray(s)||(s=[s]),s.forEach(function(t){o.appendChild(i.create(t,n))});break;case"_exported":n[e._exported]=o;break;case"class":s=e["class"],"string"==typeof s?o.classList.add(s):Array.isArray(s)&&s.forEach(function(t){o.classList.add(t)});break;default:o[r]=e[r]}}),o},this.get=function(t,e){e=e||document;var n=void 0;return"string"==typeof t&&t?n=e.querySelector(t):Array.isArray(t)&&(n={},t.forEach(function(t){var i=void 0;"string"==typeof t?(i=t.replace(/^[.# ]+/g,""),n[i]=e.querySelector(t)):(i=t.sel.replace(/^[.# ]+/g,""),n[t.name||i]=e.querySelector(t.sel))})),n}}]),onix.factory("$event",function(){var t=function(){function t(){_classCallCheck(this,t)}return t.prototype._eventInit=function(){this._allEvents=[]},t.prototype.on=function(t,e,n){t&&e&&this._allEvents.push({name:t,fn:e,scope:n})},t.prototype.off=function(t,e,n){if(t)for(var i=this._allEvents.length-1,o=i;o>=0;o--){var r=this._allEvents[o];r.name==t&&(e&&e!=r.fn||n&&n!=r.scope||this._allEvents.splice(o,1))}},t.prototype.once=function(t,e,n){t&&e&&this._allEvents.push({name:t,fn:e,scope:n,once:!0})},t.prototype.trigger=function(t){if(t)for(var e=Array.prototype.slice.call(arguments,1),n=this._allEvents.length-1,i=n;i>=0;i--){var o=this._allEvents[i];o.name==t&&(o.fn.apply(o.scope||this,e),o.once&&this._allEvents.splice(i,1))}},t}();return t}),onix.factory("$resize",["$event",function(t){var e=function(t){function e(){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,t.call(this));return n._eventInit(),n._active=!1,n._resizeObj={id:null,timeout:333},n._binds={resize:n._resize.bind(n),resizeInner:n._resizeInner.bind(n)},n}return _inherits(e,t),e.prototype._resize=function(){this._resizeObj.id&&(clearTimeout(this._resizeObj.id),this._resizeObj.id=null),this._resizeObj.id=setTimeout(this._binds.resizeInner,this._resizeObj.timeout)},e.prototype._resizeInner=function(){this.trigger("resize")},e.prototype.start=function(){this._active||(window.addEventListener("resize",this._binds.resize),this._active=!0)},e.prototype.end=function(){this._active&&(window.removeEventListener("resize",this._binds.resize),this._active=!1)},e}(t);return new e}]);var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(t){return"undefined"==typeof t?"undefined":_typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":"undefined"==typeof t?"undefined":_typeof2(t)};onix.filter("lowercase",function(){return function(t){return"string"==typeof t?t.toLowerCase():t}}),onix.filter("uppercase",function(){return function(t){return"string"==typeof t?t.toUpperCase():t}}),onix.filter("json",function(){return function(t,e){if("object"===("undefined"==typeof t?"undefined":_typeof(t))){var n=null;return e&&(e=parseInt(e,10),n=isNaN(e)?null:e),JSON.stringify(t,null,n)}return t}}),onix.service("$http",["$promise","$common","$location",function(t,e,n){this._preparePostData=function(t){var e=new FormData;return t&&(Array.isArray(t)?t.forEach(function(t){e.append(t.name,t.value)}):Object.keys(t).forEach(function(n){e.append(n,t[n])})),e},this._updateURL=function(t,e){var i=n.objToURL(e);return i&&(t+=(t.indexOf("?")==-1?"?":"")+i),t},this.POST_TYPES={JSON:1,FORM_DATA:2},this.METHOD={POST:"POST",GET:"GET",DELETE:"DELETE",PATCH:"PATCH"},this.createRequest=function(n){var i=this;return new t(function(t,o){n=n||{};var r=new XMLHttpRequest,s=n.method||i.METHOD.GET,a=n.url||"";if(!a)return void o();a=i._updateURL(a,n.getData),r.onerror=function(t){o(t)},r.open(s,a,!0),r.onreadystatechange=function(){if(4==r.readyState){var e=r.responseText||"",n=r.getResponseHeader("Content-Type"),i=null;i="application/json"==n?e.length?JSON.parse(e):{}:e;var c={status:r.status,data:i,url:a,method:s};r.status>=200&&r.status<300?t(c):o(c)}};try{!function(){var t=n.headers;e.isObject(t)&&Object.keys(t).forEach(function(e){r.setRequestHeader(e,t[e])}),s==i.METHOD.GET&&r.setRequestHeader("Accept","application/json");var o=n.postType||i.POST_TYPES.JSON;n.postData&&o==i.POST_TYPES.JSON?(r.setRequestHeader("Content-Type","application/json; charset=UTF-8"),r.send(JSON.stringify(n.postData))):n.postData&&o==i.POST_TYPES.FORM_DATA?r.send(i._preparePostData(n.postData)):r.send()}()}catch(c){o(c)}})}}]),onix.provider("$i18n",function(){var t={},e="",n=!0,i=function(t,e){t=t||"",e=e||{};var n=t.match(/{[^}]+,.*}|{[^}]*}/g);return n&&!function(){var i={};n.forEach(function(t){var n=t;n.length>2&&(n=n.substr(1,n.length-2));var o=n.split(","),r=o[0].trim(),s={};if(2==o.length){var a=o[1].match(/[a-zA-Z0-9_]+{[^}]*}/g);a&&a.forEach(function(t){var e=t.split("{"),n=e[1];n=n.substr(0,n.length-1),s[e[0].trim()]=n})}var c=r in e?e[r]:"";if("number"==typeof c&&Object.keys(s).length){var h=void 0;switch(c){case 1:h="one";break;case 2:case 3:case 4:h="few";break;default:h="other"}c=h in s?s[h]:""}i[t]=c}),Object.keys(i).forEach(function(e){t=t.replace(new RegExp(e,"g"),i[e])})}(),t},o=function(n,o){n=n||"";var r=t[e],s="";return r&&!function(){var t=n.split("."),e=t.length;t.every(function(t,n){return t in r&&(r=r[t],n!=e-1||(s=r,!1))})}(),i(s,o)},r=function(e,n){e&&n&&(t[e]||(t[e]={}),Object.keys(n).forEach(function(i){t[e][i]=n[i]}))},s=function(t){e=t||""};this.disableGlobalTranslation=function(){n=!1},this.addLanguage=function(t,e){r(t,e)},this.setLanguage=function(t){s(t)},this.postProcess=function(){n&&(window._=o)},this.$get=["$http","$promise",function(n,i){var a=function(){function a(){_classCallCheck(this,a)}return a.prototype._=function(t,e){return o(t,e)},a.prototype.addLanguage=function(t,e){r(t,e)},a.prototype.setLanguage=function(t){s(t)},a.prototype.getLanguage=function(t){return e},a.prototype.getAllLanguages=function(e){return Object.keys(t)},a.prototype.loadLanguage=function(t,e){return new i(function(i,o){n.createRequest({url:e}).then(function(e){r(t,e.data),i()},function(t){o(t)})})},a}();return new a}]}),onix.config(["$i18nProvider",function(t){t.postProcess()}]),onix.service("$image",["$promise","$features",function(t,e){this.readFromFile=function(n,i){var o=this;return new t(function(t,r){if(!e.FILE_READER)return void r();var s=new FileReader,a={img:null,exif:null,canvas:null};s.onload=function(e){var r=s.result,c=new Uint8Array(r),h=null;"image/jpeg"!=n.type&&"image/pjpeg"!=n.type||(h=o.getEXIF(r));var u=new Image;u.onload=function(){var e=o.getImageDim(u,i),n=o.getCanvas(u,{width:e.width,height:e.height,orientation:h?h.Orientation:0,scaled:1!=e.scale});a.img=u,a.exif=h,a.canvas=n,t(a)},u.src=o.fileToBase64(n.type,c)},s.readAsArrayBuffer(n)})},this.getImageDim=function(t,e){e=e||0;var n=e>0&&t.width>e,i=e>0&&t.height>e,o={width:t.width,height:t.height,scale:1};if(n||i){var r=t.width,s=t.height;t.width>t.height?(s=e*s/r,r=e):(r=e*r/s,s=e),o.scale=t.width/r,o.width=r,o.height=s}return o},this.getCanvas=function(t,n){var i={width:t.width||0,height:t.height||0,orientation:0,scaled:!1,canvas:null};for(var o in n)i[o]=n[o];if(!e.CANVAS)return null;var r=i.canvas||document.createElement("canvas");r.width=i.width,r.height=i.height;var s=r.getContext("2d"),a=!0;if(i.orientation)switch(i.orientation){case 2:s.translate(i.width,0),s.scale(-1,1);break;case 180:case 3:s.translate(i.width,i.height),s.rotate(Math.PI);break;case 4:s.translate(0,i.height),s.scale(1,-1);break;case 5:r.width=i.height,r.height=i.width,s.rotate(.5*Math.PI),s.scale(1,-1),i.scaled&&(s.clearRect(0,0,r.width,r.height),s.drawImage(t,0,0,t.width,t.height,0,0,r.height,r.width),a=!1);break;case 90:case 6:r.width=i.height,r.height=i.width,s.rotate(.5*Math.PI),s.translate(0,-i.height),i.scaled&&(s.clearRect(0,0,r.width,r.height),s.drawImage(t,0,0,t.width,t.height,0,0,r.height,r.width),a=!1);break;case 7:r.width=i.height,r.height=i.width,s.rotate(.5*Math.PI),s.translate(i.width,-i.height),s.scale(-1,1),i.scaled&&(s.clearRect(0,0,r.width,r.height),s.drawImage(t,0,0,t.width,t.height,0,0,r.height,r.width),a=!1);break;case 270:case 8:r.width=i.height,r.height=i.width,s.rotate(-.5*Math.PI),s.translate(-i.width,0),i.scaled&&(s.clearRect(0,0,r.width,r.height),s.drawImage(t,0,0,t.width,t.height,0,0,r.height,r.width),a=!1)}return a&&(s.clearRect(0,0,r.width,r.height),i.scaled?s.drawImage(t,0,0,t.width,t.height,0,0,r.width,r.height):s.drawImage(t,0,0)),r},this.fileToBase64=function(t,e){for(var n=e.length,i="",o=0;o<n;o+=1)i+=String.fromCharCode(e[o]);return"data:"+t+";base64,"+btoa(i)},this.isPicture=function(t){return t&&("image/jpeg"==t.type||"image/pjpeg"==t.type||"image/png"==t.type)},this.getPictureFiles=function(t){var e=[];if(t&&t.length)for(var n=0;n<t.length;n++){var i=t[n];this.isPicture(i)&&e.push(i)}return e},this.getPicturesCount=function(t){return this.getPictureFiles(t).length},this.getEXIF=function(t){return"EXIF"in window?EXIF.readFromBinaryFile(t):{}}}]),onix.factory("$job",["$promise",function(t){var e=function(){function e(){_classCallCheck(this,e),this._isRunning=!1,this._tasks=[],this._taskDone={cb:null,scope:null}}return e.prototype.add=function(t,e,n){n=n||[],Array.isArray(n)||(n=[n]),this._tasks.push({task:t,scope:e,args:n})},e.prototype.start=function(){var e=this;return new t(function(t,n){return e._isRunning||!e._tasks.length?void n():(e._isRunning=!0,e._tasks.reverse(),void e._doJob(t))})},e.prototype.clear=function(){this._tasks=[]},e.prototype.setTaskDone=function(t,e){this._taskDone.cb=t,this._taskDone.scope=e},e.prototype._doJob=function(t){var e=this,n=arguments,i=this._tasks.length;if(0==i)this._isRunning=!1,t();else{var o=this._tasks.pop();o.task.apply(o.scope||o.task,o.args.concat(function(){if(e._taskDone.cb){var i=Array.prototype.slice.call(n,0);e._taskDone.cb.apply(e._taskDone.scope||e._taskDone.cb,i)}e._doJob(t)}))}},e}();return{create:function(){return new e},multipleJobs:function(e,n,i){for(var o=e.length,r=[],s=0;s<o;s++){var a=n>0?s%n:s,c=e[s];r[a]||(r[a]=this.create(),i&&r[a].setTaskDone(i.cb,i.scope)),r[a].add(c.task,c.scope,c.args)}var h=[];return r.forEach(function(t){h.push(t.start())}),t.all(h)}}}]),onix.factory("$localStorage",["$features",function(t){var e=t.LOCAL_STORAGE?window.localStorage:{_data:{},setItem:function(t,e){t&&(this._data[t]=e)},getItem:function(t){return t?this._data[t]:null},removeItem:function(t){t&&t in this._data&&delete this._data[t]}};return{set:function(t,n){e.setItem(t,n)},get:function(t){return e.getItem(t)},remove:function(t){e.removeItem(t)}}}]);var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(t){return"undefined"==typeof t?"undefined":_typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":"undefined"==typeof t?"undefined":_typeof2(t)};onix.service("$location",function(){this.refresh=function(){window.location.reload()},this.createSearchURL=function(t){var e=this.objToURL(t);return e?"?"+e:""},this.objToURL=function(t){var e=[];return Array.isArray(t)?t.forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}):"object"===("undefined"==typeof t?"undefined":_typeof(t))&&Object.keys(t).forEach(function(n){e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]))}),e.join("&")},this.search=function(t){if(t){var e=this.createSearchURL(t);e&&(window.location.search=e)}else{var n=function(){var t=location.search,e={};return t&&(t=t.replace("?",""),t.split("&").forEach(function(t){var n=t.split("="),i=decodeURIComponent(n[0]);e[i]=decodeURIComponent(n[1])})),{v:e}}();if("object"===("undefined"==typeof n?"undefined":_typeof(n)))return n.v}},this.get=function(){return window.location.pathname}}),onix.service("$math",function(){this._CONST={ZOOM:156543.034},this.isBBoxIntersection=function(t,e){var n=Math.max(t.x,e.x),i=Math.max(t.y,e.y),o=Math.min(t.x+t.width,e.x+e.width),r=Math.min(t.y+t.height,e.y+e.height),s=Math.abs(o-n),a=Math.abs(r-i);return n<=o&&i<=r&&s*a>0},this.getBBox=function(t){for(var e=1/0,n=1/0,i=-(1/0),o=-(1/0),r=0;r<t.length;r++)e=Math.min(t[r].x,e),n=Math.min(t[r].y,n),i=Math.max(t[r].x,i),o=Math.max(t[r].y,o);return{x:e,y:n,width:Math.abs(i-e),height:Math.abs(o-n)}},this.det2=function(t,e,n,i){return t*i-n*e},this.linesIntersection=function(t,e){var n=1e-6,i=this.det2(t.x1-t.x2,t.y1-t.y2,e.x1-e.x2,e.y1-e.y2);if(Math.abs(i)<n)return null;var o=this.det2(t.x1,t.y1,t.x2,t.y2),r=this.det2(e.x1,e.y1,e.x2,e.y2),s=this.det2(o,t.x1-t.x2,r,e.x1-e.x2)/i,a=this.det2(o,t.y1-t.y2,r,e.y1-e.y2)/i;return s<Math.min(t.x1,t.x2)-n||s>Math.max(t.x1,t.x2)+n?null:a<Math.min(t.y1,t.y2)-n||a>Math.max(t.y1,t.y2)+n?null:s<Math.min(e.x1,e.x2)-n||s>Math.max(e.x1,e.x2)+n?null:a<Math.min(e.y1,e.y2)-n||a>Math.max(e.y1,e.y2)+n?null:{x:Math.round(s),y:Math.round(a)}},this.pointBBoxIntersection=function(t,e){return t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height},this.log2=function(t){return Math.log(t)/Math.log(2)},this.zoomToDistance=function(t,e,n){var i=this._CONST.ZOOM/Math.pow(2,t),o=n/2,r=Math.floor(i*o),s=e/360*Math.PI;return Math.floor(r/Math.tan(s))},this.distanceToZoom=function(t,e,n){var i=e/360*Math.PI,o=Math.tan(i)*t,r=2*o/n;return Math.floor(this.log2(this._CONST.ZOOM/r))},this.movePointByAngle=function(t,e){var n=(360-e)/180*Math.PI,i=t.x,o=t.y;t.x=i*Math.cos(n)-o*Math.sin(n),t.y=i*Math.sin(n)+o*Math.cos(n)},this.movePointByVector=function(t,e,n){var i={x:e.x,y:e.y};this.movePointByAngle(i,n||0),t.x+=i.x,t.y+=i.y},this.setRange=function(t,e,n){return t<e?e:t>n?n:t}}),onix.factory("$myQuery",["$common",function(t){var e=function(){function e(t,n){return _classCallCheck2(this,e),this._els=this._getElementsFromValue(t,n),this}return e.prototype._getElementsFromValue=function(t,n){t=Array.isArray(t)?t:[t];var i=[];return t.forEach(function(t){if("string"!=typeof t)t instanceof e&&(t=t.getEl()),(t instanceof Element||t==document||t==window)&&i.push(t);else if(t.match(/<[a-zA-Z]+>/)){var o=document.createElement("div");o.innerHTML=t,i.push(o)}else{n instanceof e&&(n=n.getEl()),n=n instanceof Element||n==window||n==document?n:document;var r=n.querySelectorAll(t);r&&(i=i.concat(Array.prototype.slice.call(r)))}}),i},e.prototype._operation=function(t,e){Array.isArray(this._els)||(this._els=Array.prototype.slice.call(this._els)),this._els.forEach(function(n,i){t.apply(e||t,[n,i])})},e.prototype._setGetAll=function(t,e){var n=this;if("undefined"==typeof t)return this;if("undefined"!=typeof e)return this._operation(function(n){n[t]=e}),this;var i=function(){var e=[];return n._operation(function(n){e.push(n[t])}),e.length?1==e.length?{v:e[0]}:{v:e}:{v:null}}();return"object"===("undefined"==typeof i?"undefined":_typeof2(i))?i.v:void 0},e.prototype._bindEvent=function(t,e,n){return this._operation(function(i){i.addEventListener(t,function(t){e.apply(n||e,[t,i])})}),this},e.prototype.get=function(t){return t=t||0,t>this._els.length?null:this._els[t]},e.prototype.getEl=function(t){return this.get(t)},e.prototype.attr=function(t,e){var n=this;if("undefined"==typeof t)return this;if("undefined"!=typeof e)return this._operation(function(n){n.setAttribute(t,e)}),this;var i=function(){var e=[];return n._operation(function(n){e.push(n.getAttribute(t))}),e.length?1==e.length?{v:e[0]}:{v:e}:{v:null}}();return"object"===("undefined"==typeof i?"undefined":_typeof2(i))?i.v:void 0},e.prototype.css=function(e,n){var i=this;if("undefined"!=typeof e){if("undefined"!=typeof n)return this._operation(function(i){i.style[t.cssNameToJS(e)]=n}),this;if("object"!==("undefined"==typeof e?"undefined":_typeof2(e))||Array.isArray(e)){var o=this.getEl();return o?o.style[t.cssNameToJS(e)]:null}return Object.keys(e).forEach(function(n){i._operation(function(i){i.style[t.cssNameToJS(n)]=e[n]})}),this}return this},e.prototype.src=function(t){return this._setGetAll("src",t)},e.prototype.hide=function(){return this.css("display","none")},e.prototype.show=function(t){return this.css("display",t||"")},e.prototype.val=function(t){return this._setGetAll("value",t)},e.prototype.html=function(t){return this._setGetAll("innerHTML",t)},e.prototype.addClass=function(t){return this._operation(function(e){e.classList.add(t)}),this},e.prototype.removeClass=function(t){return this._operation(function(e){e.classList.remove(t)}),this},e.prototype.toggleClass=function(t){return this._operation(function(e){e.classList.toggle(t)}),this},e.prototype.width=function n(){var n=0;return this._operation(function(t){n+=t.offsetWidth}),n},e.prototype.height=function i(){var i=0;return this._operation(function(t){i+=t.offsetHeight}),i},e.prototype.click=function(t,e){return this._bindEvent("click",t,e)},e.prototype.change=function(t,e){return this._bindEvent("change",t,e)},e.prototype.mouseenter=function(t,e){return this._bindEvent("mouseenter",t,e)},e.prototype.mouseleave=function(t,e){return this._bindEvent("mouseleave",t,e)},e.prototype.mousemove=function(t,e){return this._bindEvent("mousemove",t,e)},e.prototype.keydown=function(t,e){return this._bindEvent("keydown",t,e)},e.prototype.keyup=function(t,e){return this._bindEvent("keyup",t,e)},e.prototype.keypress=function(t,e){return this._bindEvent("keypress",t,e)},e.prototype.blur=function(t,e){return this._bindEvent("blur",t,e)},e.prototype.focus=function(t,e){return this._bindEvent("focus",t,e)},e.prototype.each=function(t,e){return this._operation(function(n,i){t.apply(e||t,[n,i])}),this},e.prototype.forEach=function(t,e){return this.each(t,e)},e.prototype.remove=function(){return this._operation(function(t){t.parentNode.removeChild(t)}),this},e.prototype.append=function(t){return t=this._getElementsFromValue(t),t.length&&this._operation(function(e){e.appendChild(t[0])}),this},e.prototype.prepend=function(t){return t=this._getElementsFromValue(t),t.length&&this._operation(function(e){e.parentNode.insertBefore(t[0],e)}),this},e.prototype.insertBefore=function(t){t=this._getElementsFromValue(t);var e=this.getEl();return e&&t.length&&t[0].parentNode.insertBefore(e,t[0]),this},e.prototype.empty=function(){return this._operation(function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}),this},e.prototype.len=function(){return this._els.length},e.prototype.parent=function(){var t=this.getEl();return t?new this(t):null},e.prototype.children=function(){var t=this.getEl();return t?t.children:[]},e.prototype.scrollTop=function(){var t=this.getEl(),e=document.body.scrollTop;return t?t.scrollTop+e:e+0},e.prototype.scrollLeft=function(){var t=this.getEl(),e=document.body.scrollLeft;return t?t.scrollLeft+e:e+0},e}();return onix.element=function(t,n){return new e(t,n)},{get:function(t,n){return new e(t,n)}}}]),onix.run(["$myQuery",function(){}]),onix.factory("$promise",function(){var t=function(){function t(e){if(_classCallCheck(this,t),this._STATES={IDLE:0,RESOLVED:1,REJECTED:2},this._state=this._STATES.IDLE,this._thens=[],this._fulfillData=null,e&&"function"==typeof e)try{e.apply(e,[this._resolve.bind(this),this._reject.bind(this)])}catch(n){console.error("$promise exception "+n)}}return t.prototype._resolve=function(t){this._fulfillData=t,this._state=this._STATES.RESOLVED,this._resolveFuncs()},t.prototype._reject=function(t){this._fulfillData=t,this._state=this._STATES.REJECTED,this._resolveFuncs()},t.prototype._resolveFuncs=function(){for(var e=this,n=this._thens.length,i=this._state==this._STATES.REJECTED,o=0;o<n;o++){var r=this._thens[o],s=i&&r.rejectCb?r.rejectCb:!i&&r.resolveCb?r.resolveCb:null;if(s)try{var a=s(this._fulfillData);if(a&&o!=n-1){var c=function(){var n=null,i=e._thens.slice(o+1),r=void 0;return r=a instanceof t?a:new t(function(t){n=t}),i.forEach(function(t){r.then(t.resolveCb,t.rejectCb)}),n&&n(a),"break"}();if("break"===c)break}}catch(h){console.error(h)}}this._thens.length=0},t.prototype._isAlreadyFinished=function(){this._state!=this._STATES.IDLE&&this._resolveFuncs()},t.prototype.then=function(t,e){return this._thens.push({resolveCb:t&&"function"==typeof t?t:null,rejectCb:e&&"function"==typeof e?e:null}),this._isAlreadyFinished(),this},t.prototype["catch"]=function(t){return this._thens.push({resolveCb:null,rejectCb:t&&"function"==typeof t?t:null}),this._isAlreadyFinished(),this},t._multiplePromises=function(e,n){return new t(function(t){Array.isArray(e)&&e.length?!function(){var i=n?1:e.length,o=function(e){i--,0==i&&t(n?e:null)};e.forEach(function(t){t.then(function(t){o(t)},function(t){o(t)})})}():t()})},t.all=function(e){return t._multiplePromises(e)},t.race=function(e){return t._multiplePromises(e,!0)},t.resolve=function(e){return new t(function(t){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t}();return t}),onix.service("$route",["$location","$template","$di","$routeParams",function(t,e,n,i){this._routes=[],this._otherwise=null,this._setRouteParams=function(t){Object.keys(i).forEach(function(t){delete i[t]}),t=t||{},Object.keys(t).forEach(function(e){i[e]=t[e]})},this.when=function(t,e){return this._routes.push({url:t,config:e}),this},this.otherwise=function(t){return this._otherwise={config:t},this},this._runController=function(t,e){var i=n.parseParam(t);this._setRouteParams(e),n.run({fn:i.fn,inject:i.inject})},this.go=function(){var n=this,i=t.get(),o=!1,r=null;this._routes.every(function(t){return!i.match(new RegExp(t.url))||(r=t.config,o=!0,!1)}),!o&&this._otherwise&&(r=this._otherwise.config),r&&!function(){var t="",i=null,o=null,s={};Object.keys(r).forEach(function(e){var n=r[e];switch(e){case"templateId":t=n;break;case"templateUrl":i=n;break;case"controller":o=n;break;default:s[e]=n}});var a=function(){o&&n._runController(o,s)};i?e.load(r.templateId||r.templateUrl,r.templateUrl).then(a):a()}()}}]),onix.factory("$routeParams",function(){return{}});var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(t){return"undefined"==typeof t?"undefined":_typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":"undefined"==typeof t?"undefined":_typeof2(t)};onix.provider("$template",function(){var t={left:"{{",right:"}}",elPrefix:"data-",elDataBind:"data-bind"};this.setConfig=function(e){Object.keys(e).forEach(function(n){t[n]=e[n]})},this.$get=["$common","$promise","$http","$filter",function(e,n,i,o){var r=function(){function e(){_classCallCheck(this,e),this._cache={},this._RE={VARIABLE:/[$_a-zA-Z][$_a-zA-Z0-9]+/g,NUMBERS:/[-]?[0-9]+[.]?([0-9e]+)?/g,STRINGS:/["'][^"']+["']/g,JSONS:/[{][^}]+[}]/g,ALL:/[-]?[0-9]+[.]?([0-9e]+)?|["'][^"']+["']|[{][^}]+[}]|[$_a-zA-Z][$_a-zA-Z0-9]+/g},this._CONST={FILTER_DELIMETER:"|",FILTER_PARAM_DELIMETER:":",TEMPLATE_SCRIPT_SELECTOR:"script[type='text/template']"},this._init()}return e.prototype._parseFnName=function(t){return t=t||"",t.match(/[a-zA-Z0-9_]+/)[0]},e.prototype._parseArgs=function(t,e){var n=this,i=t?t.replace(/^[^(]+./,"").replace(/\).*$/,""):"",o=[],r=i.match(this._RE.ALL);return r&&!function(){var t=[];r.forEach(function(o){var r=void 0;if(o.match(n._RE.STRINGS))r=o.substr(1,o.length-2);else if(o.match(n._RE.NUMBERS))r=parseFloat(o);else if(o.match(n._RE.JSONS))r=JSON.parse(o);else if(o.match(n._RE.VARIABLE)){var s=o.match(n._RE.VARIABLE)[0];r="$event"==s?e.event:"$element"==s?e.el:null}t.push({value:r,pos:i.indexOf(o)})}),t.length&&t.sort(function(t,e){return t.pos-e.pos}).forEach(function(t){o.push(t.value)})}(),o},e.prototype._bindEvent=function(e,n,i){var o=this;if(e&&n&&i){var r=n.name.replace(t.elPrefix,""),s=this._parseFnName(n.value);r&&s in i&&e.addEventListener(r,function(t){var r=o._parseArgs(n.value,{el:e,event:t});i[s].apply(i,r)})}},e.prototype._getAttributes=function(e){var n=[];return e&&"attributes"in e&&Object.keys(e.attributes).forEach(function(i){var o=e.attributes[i];o&&"object"===("undefined"==typeof o?"undefined":_typeof(o))&&o.name&&o.name.indexOf(t.elPrefix)!=-1&&n.push({name:o.name,value:o.value})}),n},e.prototype._init=function(){var t=this;onix.element(this._CONST.TEMPLATE_SCRIPT_SELECTOR).forEach(function(e){t.add(e.id||"",e.innerHTML)})},e.prototype.add=function(t,e){this._cache[t]=e},e.prototype.compile=function(e,n){var i=this,r=this.get(e);if(n){var s=r.match(new RegExp(t.left+"(.*?)"+t.right,"g"))||[];s.forEach(function(e){var s=e;if(e=e.replace(new RegExp("^"+t.left),"").replace(new RegExp(t.right+"$"),""),e.indexOf(i._CONST.FILTER_DELIMETER)!=-1)!function(){var t=void 0;e.split(i._CONST.FILTER_DELIMETER).forEach(function(e,r){e=e.trim(),r?!function(){var n=[t],r=e.split(i._CONST.FILTER_PARAM_DELIMETER),s="";1==r.length?s=r[0].trim():r.forEach(function(t,e){t=t.trim(),e?n.push(t):s=t});var a=o(s);t=a.apply(a,n)}():e in n&&(t=n[e])}),r=r.replace(s,t||"")}();else{var a="";e=e.trim(),e in n&&(a=n[e]),r=r.replace(s,a)}})}return r},e.prototype.get=function(t){return this._cache[t]||""},e.prototype.bindTemplate=function(e,n,i){var o=this,r=onix.element("*",e);r.len()&&!function(){var e={};r.forEach(function(i){var r=o._getAttributes(i);r.forEach(function(r){r.name==t.elDataBind?e[r.value]=i:o._bindEvent(i,r,n)})}),i&&"function"==typeof i&&i(e)}()},e.prototype.load=function(t,e){var o=this;return new n(function(n,r){i.createRequest({url:e}).then(function(e){o.add(t,e.data),n()},function(t){r(t)})})},e}();return new r}]}),onix.service("$features",function(){this.FILE_READER="FileReader"in window,this.CANVAS=!!document.createElement("canvas").getContext;var t=!0;try{window.localStorage}catch(e){t=!1}this.LOCAL_STORAGE=t}),onix.factory("$anonymizer",["$math","$event","$loader","$promise","$common","$features",function(t,e,n,i,o,r){var s=function(e){function s(t,i){_classCallCheck(this,s);var o=_possibleConstructorReturn(this,e.call(this));if(o._eventInit(),!r.CANVAS)return console.error("Canvas is not available!"),_possibleConstructorReturn(o);o._parent=t,o._parent.classList.add("anonymizer"),o._opts={canWidth:t.offsetWidth||0,canHeight:t.offsetHeight||0,zoom:100,minZoom:20,maxZoom:100,zoomStep:10,zoomMoveStep:1,curEntity:s.ENTITES.CIRCLE,showPreview:!0,previewLeft:17,previewTop:17,previewWidth:200,entityPreview:null};for(var a in i)o._opts[a]=i[a];return o._canWidth=o._opts.canWidth,o._canHeight=o._opts.canHeight,o._zoom=o._opts.zoom,o._zoomStep=o._opts.zoomStep,o._zoomMoveStep=0,o._curWidth=0,o._curHeight=0,o._canvas=document.createElement("canvas"),o._canvas.width=o._canWidth,o._canvas.height=o._canHeight,o._ctx=o._canvas.getContext("2d"),o._img=null,o._imgWidth=0,o._imgHeight=0,o._lineCanvas=null,o._lineCanvasCtx=null,o._entityCanvas=null,o._entityCanvasCtx=null,o._entites=[],o._x=0,o._y=0,o._THRESHOLD={MIN:-1,MAX:1},o._mouse={startXSave:0,startYSave:0,startX:0,startY:0,bcr:null},o._flags={wasRightClick:!1,wasMove:!1,wasPreview:!1,wasLine:!1,wasImgMove:!1},o._binds={mouseWheel:o._mouseWheel.bind(o),mouseDown:o._mouseDown.bind(o),mouseMove:o._mouseMove.bind(o),mouseUp:o._mouseUp.bind(o),mouseMoveLine:o._mouseMoveLine.bind(o),mouseUpLine:o._mouseUpLine.bind(o),contextMenu:o._cancelEvents.bind(o)},o._canvas.addEventListener("DOMMouseScroll",o._binds.mouseWheel),o._canvas.addEventListener("mousewheel",o._binds.mouseWheel),o._canvas.addEventListener("mousedown",o._binds.mouseDown),o._canvas.addEventListener("contextmenu",o._binds.contextMenu),o._spinner=n.getSpinner(),t.appendChild(o._spinner),t.appendChild(o._canvas),o._opts.entityPreview&&(o._entityCanvas=document.createElement("canvas"),o._entityCanvas.width=300,o._entityCanvas.height=150,o._entityCanvasCtx=o._entityCanvas.getContext("2d"),o._opts.entityPreview.appendChild(o._entityCanvas)),o}return _inherits(s,e),s.prototype._redraw=function(){var t=this;this._ctx.clearRect(0,0,this._canWidth,this._canHeight),this._ctx.drawImage(this._img,this._x,this._y,this._img.width,this._img.height,0,0,this._curWidth,this._curHeight),this._entites.length&&!function(){var e=t._zoom/100,n=t._x*e,i=t._y*e;t._entites.forEach(function(o){var r=void 0,a=void 0;switch(o.id){case s.ENTITES.CIRCLE.id:
var c=Math.round(o.value*e);r=Math.round(t._curWidth*o.xRatio-n),a=Math.round(t._curHeight*o.yRatio-i),t._drawCircle(t._ctx,r,a,c);break;case s.ENTITES.LINE.id:var h=Math.round(o.value*e);r=Math.round(t._curWidth*o.xRatio-n),a=Math.round(t._curHeight*o.yRatio-i);var u=Math.round(t._curWidth*o.x2Ratio-n),l=Math.round(t._curHeight*o.y2Ratio-i);t._drawLine(t._ctx,r,a,u,l,h)}})}(),this._drawPreview()},s.prototype._setWhiteCanvas=function(){this._ctx.clearRect(0,0,this._canWidth,this._canHeight),this._drawFillRect(this._ctx,0,0,this._canWidth,this._canHeight,"#fff")},s.prototype._drawCircle=function(t,e,n,i){t.beginPath(),t.arc(e,n,i,0,2*Math.PI),t.fillStyle=s.ENTITES.CIRCLE.fillStyle,t.closePath(),t.fill()},s.prototype._drawLine=function(t,e,n,i,o,r){t.beginPath(),t.moveTo(e,n),t.lineTo(i,o),t.lineWidth=r,t.strokeStyle=s.ENTITES.LINE.strokeStyle,t.closePath(),t.stroke()},s.prototype._drawFillRect=function(t,e,n,i,o,r){t.beginPath(),t.fillStyle=r||"",t.fillRect(e,n,i,o),t.closePath()},s.prototype._drawRect=function(t,e,n,i,o,r,s){t.beginPath(),t.rect(e,n,i,o),t.lineWidth=s||1,t.strokeStyle=r||"",t.closePath(),t.stroke()},s.prototype._drawPreview=function(){if(this._opts.showPreview){var e=this._imgWidth/this._imgHeight,n=Math.round(this._opts.previewWidth/e);this._drawFillRect(this._ctx,this._opts.previewLeft-1,this._opts.previewTop-1,this._opts.previewWidth+2,n+2,"rgba(255, 255, 255, 0.5)"),this._ctx.drawImage(this._img,0,0,this._img.width,this._img.height,this._opts.previewLeft,this._opts.previewTop,this._opts.previewWidth,n);var i=this._zoom/100,o=this._x*i,r=this._y*i,s=o/this._curWidth,a=r/this._curHeight,c=(o+this._canWidth)/this._curWidth,h=(r+this._canHeight)/this._curHeight;s=t.setRange(s,0,1),a=t.setRange(a,0,1),c=t.setRange(c,0,1),h=t.setRange(h,0,1);var u=Math.round(this._opts.previewLeft+s*this._opts.previewWidth),l=Math.round(this._opts.previewTop+a*n),p=Math.round(this._opts.previewLeft+c*this._opts.previewWidth),f=Math.round(this._opts.previewTop+h*n);this._drawRect(this._ctx,u,l,p-u,f-l,"#C01",1)}},s.prototype._drawEntityPreview=function(){if(this._opts.entityPreview){var t=this._entityCanvas.width,e=this._entityCanvas.height;this._entityCanvasCtx.clearRect(0,0,t,e),this._drawFillRect(this._entityCanvasCtx,0,0,t,e,"#f9f9f9");var n=this._opts.curEntity,i=this._zoom/100;switch(n.id){case s.ENTITES.CIRCLE.id:var o=Math.round(n.value*i),r=Math.round(t/2),a=Math.round(e/2);this._drawCircle(this._entityCanvasCtx,r,a,o);break;case s.ENTITES.LINE.id:var c=Math.round(.2*t),h=Math.round(e/2),u=Math.round(.8*t),l=Math.round(n.value*i);this._drawLine(this._entityCanvasCtx,c,h,u,h,l)}}},s.prototype._getFromPoint=function(t,e){var n={x:t||Math.round(this._canWidth/2),y:e||Math.round(this._canHeight/2)},i=this._zoom/100,o=Math.round(this._x*i)+n.x,r=Math.round(this._y*i)+n.y;return n.xRatio=o/this._curWidth,n.yRatio=r/this._curHeight,n},s.prototype._postZoom=function(){var t=this._zoom/100;this._curWidth=Math.round(this._img.width*t),this._curHeight=Math.round(this._img.height*t),this._zoom<100&&(this._zoomMoveStep=Math.max((100-this._zoom)/10*this._opts.zoomMoveStep/2,1))},s.prototype._setCenter=function(){this._setPosition(.5,.5)},s.prototype._setPosition=function(e,n,i,o){i=i||this._canWidth/2,o=o||this._canHeight/2,e=t.setRange(e,0,1),n=t.setRange(n,0,1);var r=this._zoom/100,s=this._curWidth*e-i,a=this._curHeight*n-o;this._x=Math.max(Math.round(s/r),0),this._y=Math.max(Math.round(a/r),0)},s.prototype._alignImgToCanvas=function(){var t=Math.max(this._curWidth-this._canWidth,0),e=Math.round(this._x*this._zoom/100);this._x<0?this._x=0:e>t&&(this._x=Math.round(100*t/this._zoom));var n=Math.max(this._curHeight-this._canHeight,0),i=Math.round(this._y*this._zoom/100);this._y<0?this._y=0:i>n&&(this._y=Math.round(100*n/this._zoom))},s.prototype._isRightClick=function(t){return!(!t||!(t.which&&3==t.which||t.button&&2==t.button))},s.prototype._cancelEvents=function(t){o.cancelEvents(t)},s.prototype._mouseWheel=function(t){if(this._imgWidth||this._imgHeight){var e=t.wheelDelta||-t.detail;if(e){this._cancelEvents(t),this._setBCR();var n=this._getMouseXY(t),i=this._getFromPoint(n.x,n.y);e>0?this._setZoom(this._zoom+this._zoomStep,i):this._setZoom(this._zoom-this._zoomStep,i)}}},s.prototype._getMouseXY=function(t){return{x:t.clientX-this._mouse.bcr.left,y:t.clientY-this._mouse.bcr.top}},s.prototype._setBCR=function(){this._mouse.bcr=this._canvas.getBoundingClientRect()},s.prototype._mouseDown=function(t){if(this._imgWidth||this._imgHeight){this._cancelEvents(t),this._setBCR();var e=this._getMouseXY(t);if(this._mouse.startXSave=e.x,this._mouse.startYSave=e.y,this._mouse.startX=this._mouse.startXSave,this._mouse.startY=this._mouse.startYSave,this._flags.wasMove=!1,this._flags.wasRightClick=this._isRightClick(t),this._opts.curEntity==s.ENTITES.CIRCLE)this._flags.wasImgMove=!1,this._flags.wasPreview=!1,document.addEventListener("mousemove",this._binds.mouseMove),document.addEventListener("mouseup",this._binds.mouseUp);else if(this._opts.curEntity==s.ENTITES.LINE){var n=document.createElement("canvas");n.width=this._canWidth,n.height=this._canHeight,n.classList.add("line-canvas"),this._flags.wasPreview=!1,this._flags.wasLine=!1,this._lineCanvas=n,this._lineCanvas.addEventListener("contextmenu",this._binds.contextMenu),document.addEventListener("mousemove",this._binds.mouseMoveLine),document.addEventListener("mouseup",this._binds.mouseUpLine),this._flags.wasRightClick&&this._lineCanvas.classList.add("is-dragged"),this._lineCanvasCtx=this._lineCanvas.getContext("2d"),this._parent.appendChild(n)}}},s.prototype._imgMove=function(t,e){var n=this._mouse.startX-t,i=this._mouse.startY-e;if(0!=n||0!=i){var o=this._zoomMoveStep>0?this._zoomMoveStep:1;this._x=n*o+this._x,this._y=i*o+this._y,this._alignImgToCanvas(),this._redraw()}},s.prototype._mouseMove=function(t){var e=this._getMouseXY(t);this._flags.wasMove||this._canvas.classList.add("is-dragged"),this._flags.wasMove=!0;var n=this._isPreview(e.x,e.y);this._flags.wasRightClick||this._flags.wasImgMove||!n?this._flags.wasPreview||(this._flags.wasImgMove=!0,this._imgMove(e.x,e.y)):(this._flags.wasPreview=!0,this._setPosition(n.xRatio,n.yRatio),this._alignImgToCanvas(),this._redraw()),this._mouse.startX=e.x,this._mouse.startY=e.y},s.prototype._isPreview=function(t,e){if(!this._opts.showPreview)return null;var n=this._imgWidth/this._imgHeight,i=this._opts.previewWidth,o=Math.round(this._opts.previewWidth/n),r=this._opts.previewLeft,s=this._opts.previewTop;this._zoom/100;return t=t||0,e=e||0,t>=r&&t<=r+i&&e>=s&&e<=s+o?{xRatio:(t-r)/i,yRatio:(e-s)/o}:null},s.prototype._mouseUp=function(t){var e=this._getMouseXY(t),n=!1;if(this._flags.wasMove){var i=this._mouse.startXSave-e.x,o=this._mouse.startYSave-e.y;i>=this._THRESHOLD.MIN&&i<=this._THRESHOLD.MAX&&o>=this._THRESHOLD.MIN&&o<=this._THRESHOLD.MAX&&(n=!0)}if(!this._flags.wasRightClick&&(!this._flags.wasMove||n)){var r=this._isPreview(e.x,e.y);if(r)this._setPosition(r.xRatio,r.yRatio),this._alignImgToCanvas(),this._redraw();else{var s=this._zoom/100,a=Math.round(this._x*s)+e.x,c=Math.round(this._y*s)+e.y;this._entites.push({id:this._opts.curEntity.id,value:this._opts.curEntity.value,xRatio:a/this._curWidth,yRatio:c/this._curHeight}),this._redraw()}}this._canvas.classList.remove("is-dragged"),document.removeEventListener("mousemove",this._binds.mouseMove),document.removeEventListener("mouseup",this._binds.mouseUp)},s.prototype._mouseMoveLine=function(t){var e=this._getMouseXY(t);if(this._flags.wasMove=!0,this._flags.wasRightClick)this._imgMove(e.x,e.y),this._mouse.startX=e.x,this._mouse.startY=e.y;else{var n=this._isPreview(e.x,e.y),i=this._flags.wasPreview;if(!this._flags.wasLine&&n)this._flags.wasPreview=!0,this._setPosition(n.xRatio,n.yRatio),this._alignImgToCanvas(),this._redraw();else if(!this._flags.wasPreview){this._flags.wasLine=!0;var o=Math.round(this._opts.curEntity.value*this._zoom/100);this._lineCanvasCtx.clearRect(0,0,this._canWidth,this._canHeight),this._drawLine(this._lineCanvasCtx,this._mouse.startX,this._mouse.startY,e.x,e.y,o)}!i&&this._flags.wasPreview&&this._lineCanvas.classList.add("is-dragged")}},s.prototype._mouseUpLine=function(t){var e=this._getMouseXY(t),n=null;if(this._flags.wasMove||(n=this._isPreview(e.x,e.y)),!this._flags.wasRightClick)if(n)this._setPosition(n.xRatio,n.yRatio),this._alignImgToCanvas(),this._redraw();else if(this._flags.wasLine){var i=this._zoom/100,o=Math.round(this._x*i),r=Math.round(this._y*i),s=o+this._mouse.startX,a=r+this._mouse.startY,c=o+e.x,h=r+e.y;this._entites.push({id:this._opts.curEntity.id,value:this._opts.curEntity.value,xRatio:s/this._curWidth,yRatio:a/this._curHeight,x2Ratio:c/this._curWidth,y2Ratio:h/this._curHeight}),this._redraw()}this._lineCanvas.classList.remove("is-dragged"),this._lineCanvas.removeEventListener("contextmenu",this._binds.contextMenu),document.removeEventListener("mousemove",this._binds.mouseMoveLine),document.removeEventListener("mouseup",this._binds.mouseUpLine),this._parent.removeChild(this._lineCanvas),this._lineCanvas=null},s.prototype._setZoom=function(e,n){n=n||this._getFromPoint();var i=this._zoom,o=t.setRange(e,this._opts.minZoom,this._opts.maxZoom);o!=i&&(this._zoom=o,this.trigger("zoom",this._zoom),this._postZoom(),this._setPosition(n.xRatio,n.yRatio,n.x,n.y),this._alignImgToCanvas(),this._drawEntityPreview(),this._redraw())},s.prototype.loadImage=function(t){var e=this;return new i(function(n,i){e._setWhiteCanvas(),e._spinner.classList.remove("hide");var o=new Image;o.addEventListener("load",function(){e._spinner.classList.add("hide"),e._img=o,e._imgWidth=o.width,e._imgHeight=o.height,e._zoom=e._opts.zoom,e.trigger("zoom",e._zoom),e._postZoom(),e._setCenter(),e._alignImgToCanvas(),e._drawEntityPreview(),e._redraw(),n()}),o.addEventListener("error",function(){e._spinner.classList.add("hide"),e._img=null,e._imgWidth=0,e._imgHeight=0,i()}),o.src=t||""})},s.prototype.zoomPlus=function(){this._setZoom(this._zoom+this._zoomStep)},s.prototype.zoomMinus=function(){this._setZoom(this._zoom-this._zoomStep)},s.prototype.setZoom=function(t){this._setZoom(t)},s.prototype.getEntityId=function(){return this._opts.curEntity.id},s.prototype.switchEntity=function(){var t=this,e=Object.keys(s.ENTITES),n=(this._opts.curEntity.priority,null),i=null;e.forEach(function(e){var o=s.ENTITES[e];!n&&o.priority>t._opts.curEntity.priority&&(n=o),(!i||o.priority<i.priority)&&(i=o)}),n||(n=i),this._opts.curEntity=n,this._drawEntityPreview()},s.prototype.getEntity=function(){return this._opts.curEntity},s.prototype.setEntityValue=function(t){return t=t||0,t>=this._opts.curEntity.min&&t<=this._opts.curEntity.max&&(this._opts.curEntity.value=t,this._drawEntityPreview(),!0)},s.prototype.setCircleEntity=function(){this._opts.curEntity=s.ENTITES.CIRCLE,this._drawEntityPreview()},s.prototype.setLineEntity=function(){this._opts.curEntity=s.ENTITES.LINE,this._drawEntityPreview()},s.prototype.stepBack=function(){(this._imgWidth||this._imgHeight)&&(this._entites.pop(),this._redraw())},s.prototype.removeAll=function(){(this._imgWidth||this._imgHeight)&&(this._entites=[],this._redraw())},s.prototype.exportEntites=function(){var e=this,n={actions:[],image:{width:this._imgWidth,height:this._imgHeight}};return this._entites.forEach(function(i){switch(i.id){case s.ENTITES.CIRCLE.id:n.actions.push({type:i.id.toLowerCase(),x:t.setRange(Math.round(e._imgWidth*i.xRatio),0,e._imgWidth),y:t.setRange(Math.round(e._imgHeight*i.yRatio),0,e._imgHeight),r:i.value});break;case s.ENTITES.LINE.id:n.actions.push({type:i.id.toLowerCase(),x1:t.setRange(Math.round(e._imgWidth*i.xRatio),0,e._imgWidth),y1:t.setRange(Math.round(e._imgHeight*i.yRatio),0,e._imgHeight),x2:t.setRange(Math.round(e._imgWidth*i.x2Ratio),0,e._imgWidth),y2:t.setRange(Math.round(e._imgHeight*i.y2Ratio),0,e._imgHeight),width:i.value})}}),n},s.prototype.syncPort=function(t,e){t=t||this._parent.offsetWidth,e=e||this._parent.offsetHeight,this._canWidth=t,this._canHeight=e,this._canvas.width=t,this._canvas.height=e,this._img&&(this._postZoom(),this._setCenter(),this._alignImgToCanvas(),this._drawEntityPreview(),this._redraw())},s}(e);return s.ENTITES={CIRCLE:{min:10,value:50,max:100,id:"CIRCLE",fillStyle:"rgba(0, 0, 255, 0.5)",priority:1},LINE:{min:10,value:20,max:100,id:"LINE",strokeStyle:"rgba(0, 255, 0, 0.5)",priority:2}},s}]),onix.factory("$loader",["$dom",function(t){var e=function(){function e(){_classCallCheck(this,e),this._create()}return e.prototype._create=function(){this._el=t.create({el:"div","class":"loader"}),document.body.insertBefore(this._el,document.body.firstChild)},e.prototype.start=function(){this._el.classList.add("start")},e.prototype.end=function(){var t=this;this._el.classList.remove("start"),this._el.classList.add("end"),setTimeout(function(){t._el.classList.remove("end"),t._el.classList.add("hide"),setTimeout(function(){t._el.classList.remove("hide")},350)},150)},e.prototype.getSpinner=function(e){for(var n=[],i=1;i<6;i++)n.push({el:"div","class":"rect"+i});var o={el:"div","class":"spinner",child:n};return e?o:t.create(o)},e}();return new e}]),onix.service("$notify",["$common","$promise",function(t,e){var n=function(){function n(t){return _classCallCheck(this,n),this._el=t,this._HIDE_TIMEOUT=1500,this._options={ok:"alert-success",error:"alert-danger",info:"alert-info",warn:"alert-warning"},this}return n.prototype._setValue=function(e){t.isElement(e)?onix.element(this._el).empty().append(e):"string"==typeof e&&(this._el.innerHTML=e)},n.prototype.reset=function(){var t=this;return Object.keys(this._options).forEach(function(e){t._el.classList.remove(t._options[e])}),this},n.prototype.ok=function(t){return this._el.classList.add(this._options.ok),this._setValue(t),this},n.prototype.error=function(t){return this._el.classList.add(this._options.error),this._setValue(t),this},n.prototype.info=function(t){return this._el.classList.add(this._options.info),this._setValue(t),this},n.prototype.warn=function(t){return this._el.classList.add(this._options.warn),this._setValue(t),this},n.prototype.hide=function(t){var n=this;return new e(function(e){setTimeout(function(){n.reset(),e()},t||n._HIDE_TIMEOUT)})},n}();this.get=function(t){return new n(t)}}]),onix.service("$previewImages",["$image","$dom","$job","$loader",function(t,e,n,i){this._createPreview=function(t,n){var o={},r=e.create({el:"span","class":["preview-item","preview-loading"],child:[{el:"span","class":"canvas-cover",child:[i.getSpinner(!0)],style:"height: "+(n||100)+"px",_exported:"canvasCover"},{el:"span","class":"title",innerHTML:t.name.replace(/\..*/g,"")}]},o);return{cont:r,canvasCover:o.canvasCover}},this._createPreviewHolders=function(t,n){if(t&&(4==n||7==n)){var i={};7==n&&t.appendChild(e.create({el:"div",child:[{el:"span",_exported:"img_06"}]},i));for(var o=[],r=7==n?6:4,s=0;s<r;s++)o.push({el:"span",_exported:"img_0"+s});t.appendChild(e.create({el:"div",child:o},i));for(var a=0;a<n;a++)this._dom["img_0"+a]=i["img_0"+a]}},this._jobTask=function(e,n,i){var o=e.file,r=e.previewID,s=this._createPreview(o,n);r in this._dom?this._dom[r].appendChild(s.cont):this._dom.previewItems.appendChild(s.cont),t.readFromFile(o,n).then(function(t){s.cont.classList.remove("preview-loading"),s.canvasCover.innerHTML="",s.canvasCover.appendChild(t.canvas),i()})},this.show=function(e,i,o){var r=this;e.innerHTML="",e.classList.add("preview-images");var s={maxSize:0,count:0,createHolder:!1};for(var a in o)s[a]=o[a];this._dom={previewItems:e};var c=t.getPictureFiles(i),h=c.length;h&&!function(){s.createHolder&&r._createPreviewHolders(e,h);var t=[];c=c.sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0}).forEach(function(e,n){t.push({task:r._jobTask,scope:r,args:[{file:e,previewID:"img_0"+n},s.maxSize]})}),n.multipleJobs(t,s.count)}()}}]),onix.factory("$select",["$common","$event","$dom",function(t,e,n){var i=function(t){function e(n,i){_classCallCheck(this,e);var o=_possibleConstructorReturn(this,t.call(this));o._eventInit(),o._opts={addCaption:!1};for(var r in i)o._opts[r]=i[r];return o._CONST={CAPTION_SEL:".dropdown-toggle",OPTIONS_SEL:".dropdown-menu a",CARET_SEL:".caret",OPEN_DROPDOWN_SEL:".dropdown.open",OPEN_CLASS:"open",ACTIVE_CLASS:"active"},o._el=n,o._optinsRef=[],o._captionEl=null,o.captionTextEl=null,o._binds={captionClick:o._captionClick.bind(o),choiceClick:o._choiceClick.bind(o),removeAllOpened:o._removeAllOpened.bind(o),click:o._click.bind(o)},o._bind(),o}return _inherits(e,t),e.prototype._bind=function(){this._bindCaption(),this._bindChoices()},e.prototype._bindCaption=function(){var t=this._el.querySelector(this._CONST.CAPTION_SEL);if(t&&(t.addEventListener("click",this._binds.captionClick),this._opts.addCaption)){var e=t.querySelector(this._CONST.CARET_SEL);if(e){var i=n.create({el:"span","class":"add-caption"});t.insertBefore(i,e),this._captionTextEl=i}}this._captionEl=t},e.prototype._removeAllOpened=function(){var t=this;onix.element(this._CONST.OPEN_DROPDOWN_SEL).forEach(function(e){e.classList.remove(t._CONST.OPEN_CLASS)})},e.prototype._click=function(){this._removeAllOpened(),document.removeEventListener("click",this._binds.click)},e.prototype._captionClick=function(t){t.stopPropagation();var e=this._el.classList.contains(this._CONST.OPEN_CLASS);this._binds.removeAllOpened(),e?document.removeEventListener("click",this._binds.click):(document.addEventListener("click",this._binds.click),this._el.classList.add(this._CONST.OPEN_CLASS))},e.prototype._bindChoices=function(){var t=this;onix.element(this._CONST.OPTIONS_SEL,this._el).forEach(function(e){e.addEventListener("click",t._binds.choiceClick),t._optinsRef.push({el:e,event:"click",fn:t._binds.choiceClick})})},e.prototype._choiceClick=function(t){t.stopPropagation();var e=t.target||t.srcElement;if(e&&!e.parentNode.classList.contains(this._CONST.ACTIVE_CLASS)){var n=e.parentNode.parentNode.querySelector("."+this._CONST.ACTIVE_CLASS);n&&n.classList.remove(this._CONST.ACTIVE_CLASS),e.parentNode.classList.add(this._CONST.ACTIVE_CLASS),this._el.classList.remove(this._CONST.OPEN_CLASS),this._opts.addCaption&&this._captionTextEl&&(this._captionTextEl.innerHTML=e.innerHTML);var i=e.getAttribute("data-value")||"";this.trigger("change",i)}},e.prototype.unbindChoices=function(){this._optinsRef.length&&(this._optinsRef.forEach(function(t){t.el.removeEventListener(t.event,t.fn)}),this._optinsRef=[])},e.prototype.rebindChoices=function(){this.unbindChoices(),this._bindChoices()},e.prototype.selectOption=function(t){t=t||0;var e=this._optinsRef.length;if(e>0&&t>=0&&t<e){var n=this._optinsRef[t].el,i=this._optinsRef[t].el.parentNode;if(!i.classList.contains(this._CONST.ACTIVE_CLASS)){i.classList.add(this._CONST.ACTIVE_CLASS),this._opts.addCaption&&this._captionTextEl&&(this._captionTextEl.innerHTML=n.innerHTML);var o=n.getAttribute("data-value")||"";this.trigger("change",o)}}},e.prototype.setAddCaption=function(){var t=this;this._opts.addCaption&&this._optinsRef.every(function(e){var n=e.el.parentNode;return!n.classList.contains(t._CONST.ACTIVE_CLASS)||(t._captionTextEl.innerHTML=e.el.innerHTML,!1)})},e}(e);return i}]),onix.factory("$slider",["$dom","$event","$common","$math",function(t,e,n,i){var o=function(e){function o(t,n){_classCallCheck(this,o);var i=_possibleConstructorReturn(this,e.call(this));i._eventInit(),i._parent=t,i._root=i._create(),i._opts={min:0,max:100,wheelStep:1,timeout:333};for(var r in n)i._opts[r]=n[r];return i._value=null,i._signalObj={id:null,lastValue:null},t.appendChild(i._root),i._binds={keyUp:i._keyUp.bind(i),click:i._click.bind(i),mouseDownCaret:i._mouseDownCaret.bind(i),mouseMove:i._mouseMove.bind(i),mouseWheel:i._mouseWheel.bind(i),mouseUp:i._mouseUp.bind(i),sendSignalInner:i._sendSignalInner.bind(i)},i._mouse={bcr:null},i._els.input.addEventListener("keyup",i._binds.keyUp),i._els.tube.addEventListener("click",i._binds.click),i._els.caret.addEventListener("mousedown",i._binds.mouseDownCaret),i._els.lineHolder.addEventListener("DOMMouseScroll",i._binds.mouseWheel),i._els.lineHolder.addEventListener("mousewheel",i._binds.mouseWheel),i.setValue(i._opts.max),i}return _inherits(o,e),o.prototype._create=function(){return this._els={},t.create({el:"div","class":"slider",child:[{el:"input",type:"text",value:"",_exported:"input"},{el:"span","class":"line-holder",_exported:"lineHolder",child:[{el:"span","class":"lh-tube",_exported:"tube"},{el:"span","class":"lh-caret",_exported:"caret"}]}]},this._els)},o.prototype._setCaret=function(t){var e=this._els.lineHolder.offsetWidth;t<0?t=0:t>e&&(t=e),this._els.caret.style.left=t.toFixed(2)+"px"},o.prototype._getMouseXY=function(t){return{x:t.clientX-this._mouse.bcr.left,y:t.clientY-this._mouse.bcr.top}},o.prototype._setBCR=function(){this._mouse.bcr=this._els.lineHolder.getBoundingClientRect()},o.prototype._keyUp=function(){var t=this._els.input,e=parseFloat(t.value),n=!1;isNaN(e)||e<this._opts.min||e>this._opts.max?n=!0:(this.setValue(e),this._sendSignal(!0)),t.classList[n?"add":"remove"]("error")},o.prototype._click=function(t){n.cancelEvents(t),this._setBCR();var e=this._els.lineHolder.offsetWidth,i=this._getMouseXY(t).x,o=i/e;o<=.05?i=0:o>=.95&&(i=e),this._setCaret(i),this._setValue(i,!0)},o.prototype._mouseDownCaret=function(t){n.cancelEvents(t),this._setBCR(),document.addEventListener("mousemove",this._binds.mouseMove),document.addEventListener("mouseup",this._binds.mouseUp)},o.prototype._mouseMove=function(t){var e=(this._els.caret,this._getMouseXY(t).x);this._setCaret(e),this._setValue(e)},o.prototype._mouseUp=function(){document.removeEventListener("mousemove",this._binds.mouseMove),document.removeEventListener("mouseup",this._binds.mouseUp)},o.prototype._mouseWheel=function(t){var e=t.wheelDelta||-t.detail;e&&(n.cancelEvents(t),e>0?(this.setValue(this._value+this._opts.wheelStep),this._sendSignal()):(this.setValue(this._value-this._opts.wheelStep),this._sendSignal()))},o.prototype._getPosFromValue=function(t){t=t||this._value;var e=this._els.lineHolder.offsetWidth,n=this._opts.max-this._opts.min,i=(t-this._opts.min)/n*e;return i},o.prototype._setValue=function(t,e){t=t||0;var n=this._els.lineHolder.offsetWidth,i=this._opts.max-this._opts.min;t<0?t=0:t>n&&(t=n);var o=Math.round(t/n*i+this._opts.min);this._value=o,this._els.input.value=o,this._els.input.classList.remove("error"),this._sendSignal(!e)},o.prototype._sendSignal=function(t){this._signalObj.id&&(clearTimeout(this._signalObj.id),this._signalObj.id=null),t?this._signalObj.id=setTimeout(this._binds.sendSignalInner,this._opts.timeout):this._sendSignalInner()},o.prototype._sendSignalInner=function(){this._value!=this._signalObj.lastValue&&(this._signalObj.lastValue=this._value,this.trigger("change",this._value))},o.prototype.setValue=function(t){return"number"==typeof t&&(t=i.setRange(t,this._opts.min,this._opts.max),this._value=t,this._els.input.value=t,this._els.input.classList.remove("error"),this._setCaret(this._getPosFromValue(t)),!0)},o.prototype.getValue=function(){return this._value},o.prototype.rewriteOpts=function(t){for(var e in t)this._opts[e]=t[e];this._value=i.setRange(this._value,this._opts.min,this._opts.max),this.setValue(this._value)},o}(e);return o}]),onix.factory("$crop",["$dom","$math","$common",function(t,e,n){var i=function(){function i(t){_classCallCheck(this,i),this._CONST={HIDE_CLASS:"hide"},this._options={width:250,height:250,minWidth:10,minHeight:10,maxWidth:1/0,maxHeight:1/0,resizable:!0,aspectRatio:0};for(var e in t)this._options[e]=t[e];this._dim={areaWidth:0,areaHeight:0,width:this._options.width,height:this._options.height},this._changed=!1,this._backupData=null,this._groups={"point-nw":[{type:"nw",x:!0,y:!0},{type:"sw",x:!0},{type:"ne",y:!0}],"point-ne":[{type:"ne",x:!0,y:!0},{type:"se",x:!0},{type:"nw",y:!0}],"point-sw":[{type:"sw",x:!0,y:!0},{type:"nw",x:!0},{type:"se",y:!0}],"point-se":[{type:"se",x:!0,y:!0},{type:"ne",x:!0},{type:"sw",y:!0}]},this._points={nw:{x:0,y:0},ne:{x:0,y:0},sw:{x:0,y:0},se:{x:0,y:0}},this._type=null,this._mouse={startXSave:0,startYSave:0,startX:0,startY:0},this._binds={mouseDown:this._mouseDown.bind(this),mouseMove:this._mouseMove.bind(this),mouseUp:this._mouseUp.bind(this)},this._dom={},this._create(),this._dom.container.addEventListener("mousedown",this._binds.mouseDown),this.hide()}return i.prototype._create=function(){var e=["crop"];this._options.resizable&&e.push("resizable"),t.create({el:"div","class":e,child:[{el:"div","class":"crop-top",child:[{el:"span","class":"point-nw"},{el:"span","class":"point-ne"}],_exported:"cropTop"},{el:"div","class":"crop-bottom",child:[{el:"span","class":"point-sw"},{el:"span","class":"point-se"}],_exported:"cropBottom"},{el:"div","class":"crop-left",_exported:"cropLeft"},{el:"div","class":"crop-right",_exported:"cropRight"},{el:"div","class":"crop-middle",_exported:"cropMiddle"}],_exported:"container"},this._dom)},i.prototype._setCenter=function(){var t=this._dim.width,e=this._dim.height,n=Math.round((this._dim.areaWidth-t)/2),i=Math.round((this._dim.areaHeight-e)/2),o=this._points;o.nw.x=n,o.nw.y=i,o.ne.x=o.nw.x+t,o.ne.y=o.nw.y+e,o.sw.x=this._dim.areaWidth-n,o.sw.y=this._dim.areaHeight-i,o.se.x=o.ne.x,o.se.y=o.ne.y},i.prototype._alignPoints=function(){var t=this._points,n=this._dim.areaWidth-this._dim.width,i=this._dim.areaHeight-this._dim.height;t.nw.x=e.setRange(t.nw.x,0,n),t.sw.x=e.setRange(t.sw.x,0,n),t.ne.x=e.setRange(t.ne.x,this._dim.width,this._dim.areaWidth),t.se.x=e.setRange(t.se.x,this._dim.width,this._dim.areaWidth),t.nw.y=e.setRange(t.nw.y,0,i),t.ne.y=e.setRange(t.ne.y,0,i),t.sw.y=e.setRange(t.sw.y,this._dim.height,this._dim.areaHeight),t.se.y=e.setRange(t.se.y,this._dim.height,this._dim.areaHeight)},i.prototype._redraw=function(){var t=this._points,e=t.nw.x,n=t.nw.y,i=this._getSize();this._dom.cropTop.style.left=e+"px",this._dom.cropTop.style.width=i.width+"px",this._dom.cropTop.style.height=n+"px",this._dom.cropBottom.style.left=e+"px",this._dom.cropBottom.style.width=i.width+"px",this._dom.cropBottom.style.height=this._dim.areaHeight-t.sw.y+"px",this._dom.cropLeft.style.width=e+"px",this._dom.cropLeft.style.height=this._dim.areaHeight+"px",this._dom.cropRight.style.width=this._dim.areaWidth-t.ne.x+"px",this._dom.cropRight.style.height=this._dim.areaHeight+"px",this._dom.cropMiddle.style.width=i.width+"px",this._dom.cropMiddle.style.height=i.height+"px",this._dom.cropMiddle.style.left=e+"px",this._dom.cropMiddle.style.top=n+"px"},i.prototype._mouseDown=function(t){n.cancelEvents(t);var e=t.target||t.srcElement;switch(this._type=e.getAttribute("class"),this._type){case"crop-top":case"crop-bottom":case"crop-left":case"crop-right":return}this._mouse.startX=t.clientX,this._mouse.startY=t.clientY,this._mouse.startXSave=t.clientX,this._mouse.startYSave=t.clientY,document.addEventListener("mousemove",this._binds.mouseMove),document.addEventListener("mouseup",this._binds.mouseUp)},i.prototype._mouseMove=function(t){var e=this;n.cancelEvents(t);var i=t.clientX-this._mouse.startX,o=t.clientY-this._mouse.startY;if("crop-middle"==this._type)Object.keys(this._points).forEach(function(t){e._points[t].x+=i,e._points[t].y+=o}),this._alignPoints(),this._redraw();else{var r=this._groups[this._type];if(this._options.aspectRatio&&(o=i/this._options.aspectRatio*("point-nw"==this._type||"point-se"==this._type?1:-1)),this._resizeTest(i,o,r)){r.forEach(function(t){var n=e._points[t.type];n.x+=t.x?i:0,n.y+=t.y?o:0});var s=this._getSize();this._dim.width=s.width,this._dim.height=s.height,this._redraw()}}this._mouse.startX=t.clientX,this._mouse.startY=t.clientY},i.prototype._mouseUp=function(t){n.cancelEvents(t),document.removeEventListener("mousemove",this._binds.mouseMove),document.removeEventListener("mouseup",this._binds.mouseUp),this._mouse.startXSave==t.clientX&&this._mouse.startYSave==t.clientY||(this._changed=!0)},i.prototype._getSize=function(t){return t=t||this._points,{width:Math.abs(t.ne.x-t.nw.x),height:Math.abs(t.sw.y-t.nw.y)}},i.prototype._resizeTest=function(t,e,n){var i=this;if(!this._options.aspectRatio)return!1;var o={nw:{x:this._points.nw.x,y:this._points.nw.y},ne:{x:this._points.ne.x,y:this._points.ne.y},sw:{x:this._points.sw.x,y:this._points.sw.y},se:{x:this._points.se.x,y:this._points.se.y}};n.forEach(function(n){var r=o[n.type];r.x=i._points[n.type].x+(n.x?t:0),r.y=i._points[n.type].y+(n.y?e:0)});var r=this._getSize(o);return!(r.width<this._options.minWidth||r.width>this._options.maxWidth||r.height<this._options.minHeight||r.height>this._options.maxHeight||o.nw.x<0||o.se.x>this._dim.areaWidth||o.nw.y<0||o.sw.y>this._dim.areaHeight)},i.prototype.setCenter=function(){this._setCenter(),this._redraw()},i.prototype.fitToArea=function(){var t=void 0,e=void 0;if(this._options.aspectRatio){var n=this._options.aspectRatio;t=this._dim.areaWidth,e=Math.round(t/n),e>this._dim.areaHeight&&(e=this._dim.areaHeight,t=Math.round(e*n))}else t=Math.min(this._options.maxWidth,this._dim.areaWidth),e=Math.min(this._options.maxHeight,this._dim.areaHeight);this._dim.width=t,this._dim.height=e,this.setCenter()},i.prototype.destroy=function(){var t=this.getContainer();t.parentNode&&t.parentNode.removeChild(t),this._dom.container.removeEventListener("mousedown",this._binds.mouseDown)},i.prototype.getContainer=function(){return this._dom.container},i.prototype.setDim=function(t){t=t||{},t.areaWidth&&(this._dim.areaWidth=t.areaWidth,this._dom.container.style.width=this._dim.areaWidth+"px"),t.areaHeight&&(this._dim.areaHeight=t.areaHeight,this._dom.container.style.height=this._dim.areaHeight+"px")},i.prototype.show=function(){this._dom.container.classList.remove(this._CONST.HIDE_CLASS)},i.prototype.hide=function(){this._dom.container.classList.add(this._CONST.HIDE_CLASS)},i.prototype.isVisible=function(){return!this._dom.container.classList.contains(this._CONST.HIDE_CLASS)},i.prototype.isChanged=function(){return this._changed},i.prototype.backup=function(){this._backupData={changed:this._changed,aabb:this.getAABB()}},i.prototype.restore=function(){if(this._backupData){this._changed=this._backupData.changed;var t=this._backupData.aabb,e=this._points.nw,n=this._points.ne,i=this._points.sw,o=this._points.se;e.x=t[0],e.y=t[1],o.x=t[2],o.y=t[3],n.x=o.x,n.y=e.y,i.x=e.x,i.y=o.y,this._redraw(),this._backupData=null}},i.prototype.getAABB=function(t){var e=this._points.nw,n=this._points.se;return t=t||1,[Math.round(e.x*t),Math.round(e.y*t),Math.round(n.x*t),Math.round(n.y*t)]},i}();return i}]);