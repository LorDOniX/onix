/**
 * OnixJS framework
 * 2.7.8/14. 7. 2016
 * source: https://gitlab.com/LorDOniX/onix
 * documentation: https://gitlab.com/LorDOniX/onix/tree/master/docs

 * @license MIT
 * - Free for use in both personal and commercial projects
 */
function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":_typeof2(t))&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":_typeof2(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":_typeof2(t))&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":_typeof2(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":_typeof2(t))&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":_typeof2(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":_typeof2(t))&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":_typeof2(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(){"use strict";var e=Array.prototype.slice;try{e.call(document.documentElement)}catch(t){Array.prototype.slice=function(t,n){if(n="undefined"!=typeof n?n:this.length,"[object Array]"===Object.prototype.toString.call(this))return e.call(this,t,n);var i,o,r=[],s=this.length,a=t||0;a=a>=0?a:Math.max(0,s+a);var c="number"==typeof n?Math.min(n,s):s;if(n<0&&(c=s+n),o=c-a,o>0)if(r=new Array(o),this.charAt)for(i=0;i<o;i++)r[i]=this.charAt(a+i);else for(i=0;i<o;i++)r[i]=this[a+i];return r}}}(),function(){Event=Event||window.Event,Event.prototype.stopPropagation=Event.prototype.stopPropagation||function(){this.cancelBubble=!0},Event.prototype.preventDefault=Event.prototype.preventDefault||function(){this.returnValue=!1},"btoa"in window||(window.btoa=function(e){return e}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var n=this.length,i=0;i<n;i++)i in this&&e.call(t,this[i],i,this)}),Array.prototype.every||(Array.prototype.every=function(e,t){for(var n=this.length,i=0;i<n;i++)if(i in this&&!e.call(t,this[i],i,this))return!1;return!0}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n=this.length,i=t||0;for(i<0&&(i+=n);i<n;i++)if(i in this&&this[i]===e)return i;return-1}),Object.keys||(Object.keys=function(){"use strict";var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],i=n.length;return function(o){if("object"!=typeof o&&("function"!=typeof o||null===o))throw new TypeError("Object.keys called on non-object");var r,s,a=[];for(r in o)e.call(o,r)&&a.push(r);if(t)for(s=0;s<i;s++)e.call(o,n[s])&&a.push(n[s]);return a}}());try{Object.defineProperty({},"a",{value:3})}catch(t){var e=Object.defineProperty;Object.defineProperty=function(t,n,i){try{return e.apply(Object,arguments)}catch(e){return t[n]=i.value,t}},Object.defineProperties=function(e,t){for(var n in t)Object.defineProperty(e,n,t[n]);return e}}Object.create||(Object.create=function(e,t){var n=function(){};n.prototype=e;var i=new n;return Object.defineProperties(i,t),i});var t={};if(!Object.setPrototypeOf&&!t.__proto__){var n=Object.getPrototypeOf;Object.getPrototypeOf=function(e){return e.__proto__?e.__proto__:n.call(Object,e)}}if(Date.now||(Date.now=function(){return+new Date}),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice.call(arguments,1);return function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){return this.split(e).join(t)}),String.prototype.format||(String.prototype.format=function(){var e=Array.prototype.slice.call(arguments),t=this.toString();return e.forEach(function(e,n){t=t.replace(new RegExp("{\\s*"+n+"\\s*}","g"),e)}),t}),!("console"in window)){var i=function(){};window.console={},["log","warn","error","clear","info"].forEach(function(e){window.console[e]=i})}if(!("addEventListener"in document)){var o=Window.prototype,r=HTMLDocument.prototype,s=Element.prototype;document.addEventListener=o.addEventListener=r.addEventListener=s.addEventListener=function(e,t){if(this.__eventListeners||(this.__eventListeners={}),"DOMContentLoaded"==e)this.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&t()});else{this.__eventListeners[e]||(this.__eventListeners[e]=[]);var n=function(){return t.apply(this,arguments)}.bind(this);this.__eventListeners[e].push({fn:n,listener:t}),this.attachEvent("on"+e,n)}},document.removeEventListener=o.removeEventListener=r.removeEventListener=s.removeEventListener=function(e,t){for(var n=this.__eventListeners||{},i=n[e]||[],o=null,r=-1,s=0;s<i.length;s++){var a=i[s];if(a.listener==t){o=a.fn,r=s;break}}return o?(i.splice(r,1),i.length||delete n[e],this.detachEvent("on"+e,o)):null}}"classList"in document.documentElement||!window.Element||!function(){function e(e){if(this._element=e,e.className!=this._classCache&&(this._classCache=e.className,this._classCache))for(var t=this._classCache.replace(/^\s+|\s+$/g,"").split(/\s+/),n=0;n<t.length;n++)s.call(this,t[n])}function t(e,t){e.className=t.join(" ")}function n(e,t,n){Object.defineProperty?Object.defineProperty(e,t,{get:n}):e.__defineGetter__(t,n)}var i=Array.prototype,o=i.indexOf,r=i.slice,s=i.push,a=i.splice,c=i.join;window.DOMTokenList=e,e.prototype={add:function(e){this.contains(e)||(s.call(this,e),t(this._element,r.call(this,0)))},contains:function(e){return o.call(this,e)!=-1},item:function(e){return this[e]||null},remove:function(e){var n=o.call(this,e);n!=-1&&(a.call(this,n,1),t(this._element,r.call(this,0)))},toString:function(){return c.call(this," ")},toggle:function(e){return o.call(this,e)==-1?(this.add(e),!0):(this.remove(e),!1)}},n(Element.prototype,"classList",function(){return new e(this)})}()}(),function(){function e(e){return!!e.exifdata}function t(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/im)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var n=atob(e),i=n.length,o=new ArrayBuffer(i),r=new Uint8Array(o),s=0;s<i;s++)r[s]=n.charCodeAt(s);return o}function i(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="blob",n.onload=function(e){200!=this.status&&0!==this.status||t(this.response)},n.send()}function o(e,n){function o(t){var i=r(t),o=s(t);e.exifdata=i||{},e.iptcdata=o||{},n&&n.call(e)}if(e.src)if(/^data\:/i.test(e.src)){var a=t(e.src);o(a)}else if(/^blob\:/i.test(e.src)){var c=new FileReader;c.onload=function(e){o(e.target.result)},i(e.src,function(e){c.readAsArrayBuffer(e)})}else{var u=new XMLHttpRequest;u.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";o(u.response),u=null},u.open("GET",e.src,!0),u.responseType="arraybuffer",u.send(null)}else if(window.FileReader&&(e instanceof window.Blob||e instanceof window.File)){var c=new FileReader;c.onload=function(e){f&&console.log("Got file of length "+e.target.result.byteLength),o(e.target.result)},c.readAsArrayBuffer(e)}}function r(e){var t=new DataView(e);if(f&&console.log("Got file of length "+e.byteLength),255!=t.getUint8(0)||216!=t.getUint8(1))return f&&console.log("Not a valid JPEG"),!1;for(var n,i=2,o=e.byteLength;i<o;){if(255!=t.getUint8(i))return f&&console.log("Not a valid marker at offset "+i+", found: "+t.getUint8(i)),!1;if(n=t.getUint8(i+1),f&&console.log(n),225==n)return f&&console.log("Found 0xFFE1 marker"),l(t,i+4,t.getUint16(i+2)-2);i+=2+t.getUint16(i+2)}}function s(e){var t=new DataView(e);if(f&&console.log("Got file of length "+e.byteLength),255!=t.getUint8(0)||216!=t.getUint8(1))return f&&console.log("Not a valid JPEG"),!1;for(var n=2,i=e.byteLength,o=function(e,t){return 56===e.getUint8(t)&&66===e.getUint8(t+1)&&73===e.getUint8(t+2)&&77===e.getUint8(t+3)&&4===e.getUint8(t+4)&&4===e.getUint8(t+5)};n<i;){if(o(t,n)){var r=t.getUint8(n+7);r%2!==0&&(r+=1),0===r&&(r=4);var s=n+8+r,c=t.getUint16(n+6+r);return a(e,s,c)}n++}}function a(e,t,n){for(var i,o,r,s,a,c=new DataView(e),u={},l=t;l<t+n;)28===c.getUint8(l)&&2===c.getUint8(l+1)&&(s=c.getUint8(l+2),s in g&&(r=c.getInt16(l+3),a=r+5,o=g[s],i=h(c,l+5,r),u.hasOwnProperty(o)?u[o]instanceof Array?u[o].push(i):u[o]=[u[o],i]:u[o]=i)),l++;return u}function c(e,t,n,i,o){var r,s,a,c=e.getUint16(n,!o),h={};for(a=0;a<c;a++)r=n+12*a+2,s=i[e.getUint16(r,!o)],!s&&f&&console.log("Unknown tag: "+e.getUint16(r,!o)),h[s]=u(e,r,t,n,o);return h}function u(e,t,n,i,o){var r,s,a,c,u,l,f=e.getUint16(t+2,!o),d=e.getUint32(t+4,!o),p=e.getUint32(t+8,!o)+n;switch(f){case 1:case 7:if(1==d)return e.getUint8(t+8,!o);for(r=d>4?p:t+8,s=[],c=0;c<d;c++)s[c]=e.getUint8(r+c);return s;case 2:return r=d>4?p:t+8,h(e,r,d-1);case 3:if(1==d)return e.getUint16(t+8,!o);for(r=d>2?p:t+8,s=[],c=0;c<d;c++)s[c]=e.getUint16(r+2*c,!o);return s;case 4:if(1==d)return e.getUint32(t+8,!o);for(s=[],c=0;c<d;c++)s[c]=e.getUint32(p+4*c,!o);return s;case 5:if(1==d)return u=e.getUint32(p,!o),l=e.getUint32(p+4,!o),a=new Number(u/l),a.numerator=u,a.denominator=l,a;for(s=[],c=0;c<d;c++)u=e.getUint32(p+8*c,!o),l=e.getUint32(p+4+8*c,!o),s[c]=new Number(u/l),s[c].numerator=u,s[c].denominator=l;return s;case 9:if(1==d)return e.getInt32(t+8,!o);for(s=[],c=0;c<d;c++)s[c]=e.getInt32(p+4*c,!o);return s;case 10:if(1==d)return e.getInt32(p,!o)/e.getInt32(p+4,!o);for(s=[],c=0;c<d;c++)s[c]=e.getInt32(p+8*c,!o)/e.getInt32(p+4+8*c,!o);return s}}function h(e,t,i){var o="";for(n=t;n<t+i;n++)o+=String.fromCharCode(e.getUint8(n));return o}function l(e,t){if("Exif"!=h(e,t,4))return f&&console.log("Not valid EXIF data! "+h(e,t,4)),!1;var n,i,o,r,s,a=t+6;if(18761==e.getUint16(a))n=!1;else{if(19789!=e.getUint16(a))return f&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;n=!0}if(42!=e.getUint16(a+2,!n))return f&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var u=e.getUint32(a+4,!n);if(u<8)return f&&console.log("Not valid TIFF data! (First offset less than 8)",e.getUint32(a+4,!n)),!1;if(i=c(e,a,a+u,v,n),i.ExifIFDPointer){r=c(e,a,a+i.ExifIFDPointer,_,n);for(o in r){switch(o){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":r[o]=m[o][r[o]];break;case"ExifVersion":case"FlashpixVersion":r[o]=String.fromCharCode(r[o][0],r[o][1],r[o][2],r[o][3]);break;case"ComponentsConfiguration":r[o]=m.Components[r[o][0]]+m.Components[r[o][1]]+m.Components[r[o][2]]+m.Components[r[o][3]]}i[o]=r[o]}}if(i.GPSInfoIFDPointer){s=c(e,a,a+i.GPSInfoIFDPointer,y,n);for(o in s){switch(o){case"GPSVersionID":s[o]=s[o][0]+"."+s[o][1]+"."+s[o][2]+"."+s[o][3]}i[o]=s[o]}}return i}var f=!1,d=this,p=function(e){return e instanceof p?e:this instanceof p?void(this.EXIFwrapped=e):new p(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=p),exports.EXIF=p):d.EXIF=p;var _=p.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},v=p.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},y=p.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},m=p.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}},g={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};p.getData=function(t,n){return!((t instanceof Image||t instanceof HTMLImageElement)&&!t.complete)&&(e(t)?n&&n.call(t):o(t,n),!0)},p.getTag=function(t,n){if(e(t))return t.exifdata[n]},p.getAllTags=function(t){if(!e(t))return{};var n,i=t.exifdata,o={};for(n in i)i.hasOwnProperty(n)&&(o[n]=i[n]);return o},p.pretty=function(t){if(!e(t))return"";var n,i=t.exifdata,o="";for(n in i)i.hasOwnProperty(n)&&(o+="object"==typeof i[n]?i[n]instanceof Number?n+" : "+i[n]+" ["+i[n].numerator+"/"+i[n].denominator+"]\r\n":n+" : ["+i[n].length+" values]\r\n":n+" : "+i[n]+"\r\n");return o},p.readFromBinaryFile=function(e){return r(e)},"function"==typeof define&&define.amd&&define("exif-js",[],function(){return p})}.call(this);var _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},_typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":"undefined"==typeof e?"undefined":_typeof2(e)},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();onix=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this._objects={},this._runs=[],this._configs=[],this._name=t||"",this._dependencies=n||[]}return _createClass(e,[{key:"getDependencies",value:function(){return this._dependencies}},{key:"getName",value:function(){return this._name}},{key:"getConfigs",value:function(){return this._configs}},{key:"getRuns",value:function(){return this._runs}},{key:"getObjects",value:function(){return this._objects}},{key:"provider",value:function(t,n){if(!t||!n)return this;var i=e.parseParam(n);return this._objects[t+e.CONST.PROVIDER_NAME]={name:t+e.CONST.PROVIDER_NAME,inject:i.inject,fn:i.fn,cache:null,type:e.CONST.TYPE.PROVIDER},this._objects[t]={name:t,inject:null,fn:null,cache:null,provider:t+e.CONST.PROVIDER_NAME,type:e.CONST.TYPE.FACTORY},this}},{key:"service",value:function(t,n){if(!t||!n)return this;var i=e.parseParam(n);return this._objects[t]={name:t,inject:i.inject,fn:i.fn,cache:null,type:e.CONST.TYPE.SERVICE},this}},{key:"factory",value:function(t,n){if(!t||!n)return this;var i=e.parseParam(n);return this._objects[t]={name:t,inject:i.inject,fn:i.fn,cache:null,type:e.CONST.TYPE.FACTORY},this}},{key:"constant",value:function(t,n){return t&&n?(this._objects[t]={name:t,cache:n,type:e.CONST.TYPE.CONSTANT},this):this}},{key:"value",value:function(t,n){return t&&n?(this._objects[t]={name:t,cache:n,type:e.CONST.TYPE.VALUE},this):this}},{key:"filter",value:function(t,n){if(!t||!n)return this;var i=e.parseParam(n);return this._objects[e.getFilterName(t)]={name:t,inject:i.inject,fn:i.fn,cache:null,type:e.CONST.TYPE.FILTER},this}},{key:"config",value:function(t){if(!t)return this;var n=e.parseParam(t);return this._configs.push({fn:n.fn,inject:n.inject,type:e.CONST.TYPE.CONFIG}),this}},{key:"run",value:function(t){if(!t)return this;var n=e.parseParam(t);return this._runs.push({fn:n.fn,inject:n.inject,type:e.CONST.TYPE.RUN}),this}},{key:"controller",value:function(){return this}},{key:"directive",value:function(){return this}}],[{key:"parseParam",value:function(e){var t=void 0,n=[];return Array.isArray(e)?e.every(function(e){return"function"==typeof e?(t=e,!1):("string"==typeof e&&n.push(e),!0)}):t=e,{fn:t,inject:n}}},{key:"getFilterName",value:function(t){return t=t||"",e.CONST.FILTER_NAME+t[0].toUpperCase()+t.substr(1)}}]),e}();e.CONST={PROVIDER_NAME:"Provider",FILTER_NAME:"$filter",TYPE:{PROVIDER:1,SERVICE:2,FACTORY:3,CONSTANT:4,VALUE:5,FILTER:6,CONFIG:7,RUN:8}};var t=function(){function t(){var e=this;_classCallCheck(this,t),this._modules=[],this._modulesObj={},this._CONST={MODULE_SEPARATOR:"::"},document.addEventListener("DOMContentLoaded",function(){e._domLoad()})}return _createClass(t,[{key:"_domLoad",value:function(){var e=this,t=[],n=[];this._modules.forEach(function(i){var o=!1,r=i.getDependencies();r.every(function(t){return t in e._modulesObj||(console.error("Module '"+e._name+"' dependency '"+t+"' not found!"),o=!0,!1)}),o||(t=t.concat(i.getConfigs()),n=n.concat(i.getRuns()))}),t.forEach(function(t){e.run(t,!0)}),n.forEach(function(t){e.run(t)})}},{key:"_getObject",value:function(e){var t=null,n="",i="";if(e.indexOf(this._CONST.MODULE_SEPARATOR)!=-1){var o=e.split(this._CONST.MODULE_SEPARATOR);if(2!=o.length)return console.error("Get object "+e+" error! Wrong module separator use."),null;n=o[0],i=o[1]}else i=e;return this._modules.every(function(e){var o=e.getObjects();return n?e.getName()!=n||(i in o?(t=o[i],!1):(console.error("Get object "+i+" error! Cannot find object in the module "+n+"."),!1)):!(i in o)||(t=o[i],!1)}),t}},{key:"noop",value:function(){}},{key:"run",value:function(t,n,i){var o=this;if(i=i||[],i.indexOf(t.name)!=-1)return console.error("Circular dependency error! Object name: "+t.name+", parents: "+i.join("|")),null;var r=[];if(t.provider){var s=this._getObject(t.provider);if(!s.cache){var a=s.fn||this.noop;s.cache=new a}var c=s.cache.$get||this.noop,u=e.parseParam(c);t.fn=u.fn,t.inject=u.inject,delete t.provider}if(t.inject&&t.inject.length&&t.inject.forEach(function(e){if("string"==typeof e){var s=o._getObject(e);s?r.push(o.run(s,n,t.name?i.concat(t.name):i)):(console.error("Object name: "+e+" not found!"),r.push(null))}else"object"===("undefined"==typeof e?"undefined":_typeof(e))&&r.push(e)}),n)switch(t.type){case e.CONST.TYPE.PROVIDER:if(!t.cache){var h=t.fn||this.noop;t.cache=new h}return t.cache;case e.CONST.TYPE.CONSTANT:return t.cache;case e.CONST.TYPE.CONFIG:var l=t.fn||this.noop;return l.apply(l,r);default:return null}else switch(t.type){case e.CONST.TYPE.FACTORY:case e.CONST.TYPE.FILTER:if(!t.cache){var f=t.fn||this.noop;t.cache=f.apply(f,r)}return t.cache;case e.CONST.TYPE.SERVICE:if(!t.cache){var d=t.fn||this.noop,p=Object.create(d.prototype);d.apply(p,r),t.cache=p}return t.cache;case e.CONST.TYPE.VALUE:return t.cache;case e.CONST.TYPE.CONSTANT:return t.cache;case e.CONST.TYPE.RUN:var _=t.fn||this.noop;return _.apply(_,r);default:return null}}},{key:"addModule",value:function(t,n){var i=new e(t,n);return this._modulesObj[t]=i,this._modules.push(i),i}}]),t}(),n=new t,i=n.addModule("onix");return i.module=function(e,t){return n.addModule(e,t)},i.noop=n.noop,i.info=function(){console.log("OnixJS framework\n2.7.8/14. 7. 2016\nsource: https://gitlab.com/LorDOniX/onix\ndocumentation: https://gitlab.com/LorDOniX/onix/tree/master/docs\n@license MIT\n- Free for use in both personal and commercial projects\n")},i.factory("$di",function(){return{parseParam:e.parseParam,getFilterName:e.getFilterName,run:function(t){return t?(t.fn||(t.fn=function(){}),t.type=e.CONST.TYPE.RUN,n.run(t)):null}}}),i}(),onix.factory("$filter",["$di",function(e){return function(t){var n=function(e){return e||""};return t?e.run({fn:function(e){return e||n},inject:[e.getFilterName(t)]}):n}}]);var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":"undefined"==typeof e?"undefined":_typeof2(e)};onix.service("$common",["$promise",function(e){this._objCopy=function(e,t){var n=this;Object.keys(t).forEach(function(i){t.hasOwnProperty(i)&&(e[i]=n.cloneValue(t[i]))})},this._chainPromisesInner=function(e,t,n){var i=this,o=e.shift();if(o){var r=void 0,s=!1;switch(_typeof(o.method)){case"string":o.scope&&o.method in o.scope?(r=o.scope[o.method],"function"!=typeof r&&(s=!0)):s=!0;break;case"function":r=o.method;break;default:s=!0}s?t(n):r.apply(o.scope||r,o.args||[]).then(function(o){n.push(o),i._chainPromisesInner(e,t,n)},function(o){n.push(o),i._chainPromisesInner(e,t,n)})}else t(n)},this.confirm=function(t){return new e(function(e,n){confirm(t)?e():n()})},this.merge=function(){var e=arguments.length,t={};if(e>0)for(var n=0;n<e;n++){var i=arguments[n];this._objCopy(t,i)}return t},this.extend=function(e,t){e=e||{},t=t||{},this._objCopy(e,t)},this.cloneValue=function(e,t){var n=this;if(t=t||1,t>100)return null;switch("undefined"==typeof e?"undefined":_typeof(e)){case"object":if(Array.isArray(e)){var i=function(){var i=[];return e.forEach(function(e){i.push(n.cloneValue(e,t+1))}),{v:i}}();if("object"===("undefined"==typeof i?"undefined":_typeof(i)))return i.v}else{if(e&&e instanceof Date)return new Date(e.getTime());if(this.isElement(e))return e;if(!e)return null;var o=function(){var i={};return Object.keys(e).forEach(function(o){e.hasOwnProperty(o)&&(i[o]=n.cloneValue(e[o],t+1))}),{v:i}}();if("object"===("undefined"==typeof o?"undefined":_typeof(o)))return o.v}case"undefined":case"function":case"number":case"string":return e}},this.inherit=function(){var e=arguments;if(!(e.length<2)){var t=e[0].prototype,n=Array.prototype.slice.call(e,1);n.forEach(function(e){for(var n in e.prototype)t[n]="object"!=_typeof(e.prototype[n])?e.prototype[n]:JSON.parse(JSON.stringify(e.prototype[n]))})}},this.bindWithoutScope=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){var n=Array.prototype.slice.call(arguments,0),i=Array.prototype.concat(n,t);return e.apply(this,i)}},this.nodesForEach=function(e,t,n){"function"==typeof t&&e&&Array.prototype.slice.call(e).forEach(function(e,i){t.apply(n||t,[e,i])})},this.reverseForEach=function(e,t,n){if("function"==typeof t){e=e||[];for(var i=e.length-1;i>=0;i--)t.apply(n||this,[e[i],i])}},this.hexToD=function(e){switch(e=e.toLowerCase()){case"a":return 10;case"b":return 11;case"c":return 12;case"d":return 13;case"e":return 14;case"f":return 15;default:return parseInt(e,10)}},this.hexToRGB=function(e){return"#"==e[0]?(e=e.replace("#",""),3==e.length?{r:16*this.hexToD(e[0])+this.hexToD(e[0]),g:16*this.hexToD(e[1])+this.hexToD(e[1]),b:16*this.hexToD(e[2])+this.hexToD(e[2])}:{r:16*this.hexToD(e[0])+this.hexToD(e[1]),g:16*this.hexToD(e[2])+this.hexToD(e[3]),b:16*this.hexToD(e[4])+this.hexToD(e[5])}):e},this.isElement=function(e){return e&&e instanceof Element},this.isObject=function(e){return"object"===("undefined"==typeof e?"undefined":_typeof(e))&&!Array.isArray(e)&&null!==e},this.col=function(){var e=arguments;if(e.length){var t=e[0];console.log(t.format.apply(t,Array.prototype.slice.call(e,1)))}},this.formatSize=function(e){if("number"!=typeof e)return"null";var t=e>0?Math.floor(Math.log(e)/Math.log(1e3)):0,n=["","K","M","G","T"];t=Math.min(n.length,t);var i=t>0?(e/Math.pow(1e3,t)).toFixed(2):e;return i+" "+n[t]+"B"},this.chainPromises=function(t){var n=this;return new e(function(e){n._chainPromisesInner(t,e,[])})},this.cancelEvents=function(e){e&&(e.stopPropagation(),e.preventDefault())},this.cssNameToJS=function(e){var t=e.split("-"),n="";return t.forEach(function(e,t){n+=t?e[0].toUpperCase()+e.substr(1):e}),n}}]),onix.service("$cookie",["$date",function(e){this._CONST={EXPIRES:{MAX:"Fri, 31 Dec 9999 23:59:59 GMT",MIN:"Thu, 01 Jan 1970 00:00:00 GMT"}},this.set=function(t,n,i){if(!t||/^(?:expires|max\-age|path|domain|secure)$/i.test(t))return!1;var o={expiration:e.addDays(new Date,30),path:"",domain:"",secure:""},r="";if(o.expiration)switch(o.expiration.constructor){case Number:r=o.expiration===1/0?"; expires="+this._CONST.EXPIRES.MAX:"; max-age="+o.expiration;break;case String:r="; expires="+o.expiration;break;case Date:r="; expires="+o.expiration.toUTCString()}return document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(n)+r+(o.domain?"; domain="+o.domain:"")+(o.path?"; path="+o.path:"")+(o.secure?"; secure":""),!0},this.get=function(e){e=e||"";var t=null;if(document.cookie&&""!=document.cookie){var n=document.cookie.split(";");n.every(function(n){return n=n.trim(),n.substring(0,e.length+1)!=e+"="||(t=decodeURIComponent(n.substring(e.length+1)),!1)})}return t},this.remove=function(e,t,n){return!!this.contains(e)&&(document.cookie=encodeURIComponent(e)+"=; expires="+this._CONST.EXPIRES.MIN+(t?"; domain="+t:"")+(n?"; path="+n:""),!0)},this.contains=function(e){return!!e&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie);
}}]),onix.service("$date",function(){this.dateENtoCS=function(e){e=e||"";var t=e.split("-");return 3==t.length?[t[2].replace(/^0/,""),t[1].replace(/^0/,""),t[0]].join(". "):""},this.dateCStoEN=function(e){e=e||"";var t=e.split(".");if(3==t.length){var n=t[2].trim(),i=t[1].trim(),o=t[0].trim();return o=1==o.length?"0"+o:o,i=1==i.length?"0"+i:i,[n,i,o].join("-")}return""},this.isCSdate=function(e){return e=e||"",!!e.match(/([1-9]|[1-3][0-9])\.[ ]*([1-9]|1[0-2])\.[ ]*[1-9][0-9]{3}/)},this.addDays=function(e,t){t=t||0;var n=864e5*t;return new Date(e.getTime()+n)}});var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":"undefined"==typeof e?"undefined":_typeof2(e)};onix.service("$dom",["$common",function(e){this.create=function(t,n){var i=this,o=document.createElement(t.el||"div");return Object.keys(t).forEach(function(r){var s=void 0;switch(r){case"el":break;case"attrs":s=t.attrs,s&&"object"===("undefined"==typeof s?"undefined":_typeof(s))&&!Array.isArray(s)&&Object.keys(s).forEach(function(e){o.setAttribute(e,s[e])});break;case"css":s=t.css,s&&"object"===("undefined"==typeof s?"undefined":_typeof(s))&&!Array.isArray(s)&&Object.keys(s).forEach(function(t){o.style[e.cssNameToJS(t)]=s[t]});break;case"events":s=t.events,Array.isArray(s)||(s=[s]),s.forEach(function(e){o.addEventListener(e.event,e.fn)});break;case"child":s=t.child,Array.isArray(s)||(s=[s]),s.forEach(function(e){o.appendChild(i.create(e,n))});break;case"_exported":n[t._exported]=o;break;case"class":s=t.class,"string"==typeof s?o.classList.add(s):Array.isArray(s)&&s.forEach(function(e){o.classList.add(e)});break;default:o[r]=t[r]}}),o},this.get=function(e,t){t=t||document;var n=void 0;return"string"==typeof e&&e?n=t.querySelector(e):Array.isArray(e)&&(n={},e.forEach(function(e){var i=void 0;"string"==typeof e?(i=e.replace(/^[.# ]+/g,""),n[i]=t.querySelector(e)):(i=e.sel.replace(/^[.# ]+/g,""),n[e.name||i]=t.querySelector(e.sel))})),n}}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();onix.factory("$event",function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"_eventInit",value:function(){this._allEvents=[]}},{key:"on",value:function(e,t,n){e&&t&&this._allEvents.push({name:e,fn:t,scope:n})}},{key:"off",value:function(e,t,n){if(e)for(var i=this._allEvents.length-1,o=i;o>=0;o--){var r=this._allEvents[o];r.name==e&&(t&&t!=r.fn||n&&n!=r.scope||this._allEvents.splice(o,1))}}},{key:"once",value:function(e,t,n){e&&t&&this._allEvents.push({name:e,fn:t,scope:n,once:!0})}},{key:"trigger",value:function(e){if(e)for(var t=Array.prototype.slice.call(arguments,1),n=this._allEvents.length-1,i=n;i>=0;i--){var o=this._allEvents[i];o.name==e&&(o.fn.apply(o.scope||this,t),o.once&&this._allEvents.splice(i,1))}}}]),e}();return e});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();onix.factory("$resize",["$event",function(e){var t=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));return e._eventInit(),e._active=!1,e._resizeObj={id:null,timeout:333},e._binds={resize:e._resize.bind(e),resizeInner:e._resizeInner.bind(e)},e}return _inherits(t,e),_createClass(t,[{key:"_resize",value:function(){this._resizeObj.id&&(clearTimeout(this._resizeObj.id),this._resizeObj.id=null),this._resizeObj.id=setTimeout(this._binds.resizeInner,this._resizeObj.timeout)}},{key:"_resizeInner",value:function(){this.trigger("resize")}},{key:"start",value:function(){this._active||(window.addEventListener("resize",this._binds.resize),this._active=!0)}},{key:"end",value:function(){this._active&&(window.removeEventListener("resize",this._binds.resize),this._active=!1)}}]),t}(e);return new t}]);var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":"undefined"==typeof e?"undefined":_typeof2(e)};onix.filter("lowercase",function(){return function(e){return"string"==typeof e?e.toLowerCase():e}}),onix.filter("uppercase",function(){return function(e){return"string"==typeof e?e.toUpperCase():e}}),onix.filter("json",function(){return function(e,t){if("object"===("undefined"==typeof e?"undefined":_typeof(e))){var n=null;return t&&(t=parseInt(t,10),n=isNaN(t)?null:t),JSON.stringify(e,null,n)}return e}}),onix.service("$http",["$promise","$common","$location",function(e,t,n){this._preparePostData=function(e){var t=new FormData;return e&&(Array.isArray(e)?e.forEach(function(e){t.append(e.name,e.value)}):Object.keys(e).forEach(function(n){t.append(n,e[n])})),t},this._updateURL=function(e,t){var i=n.objToURL(t);return i&&(e+=(e.indexOf("?")==-1?"?":"")+i),e},this.POST_TYPES={JSON:1,FORM_DATA:2},this.METHOD={POST:"POST",GET:"GET",DELETE:"DELETE",PATCH:"PATCH"},this.createRequest=function(n){var i=this;return new e(function(e,o){n=n||{};var r=new XMLHttpRequest,s=n.method||i.METHOD.GET,a=n.url||"";if(!a)return void o();a=i._updateURL(a,n.getData),r.onerror=function(e){o(e)},r.open(s,a,!0),r.onreadystatechange=function(){if(4==r.readyState){var t=r.responseText||"",n=r.getResponseHeader("Content-Type"),i=null;i="application/json"==n?t.length?JSON.parse(t):{}:t;var c={status:r.status,data:i,url:a,method:s};r.status>=200&&r.status<300?e(c):o(c)}};try{!function(){var e=n.headers;t.isObject(e)&&Object.keys(e).forEach(function(t){r.setRequestHeader(t,e[t])}),s==i.METHOD.GET&&r.setRequestHeader("Accept","application/json");var o=n.postType||i.POST_TYPES.JSON;n.postData&&o==i.POST_TYPES.JSON?(r.setRequestHeader("Content-Type","application/json; charset=UTF-8"),r.send(JSON.stringify(n.postData))):n.postData&&o==i.POST_TYPES.FORM_DATA?r.send(i._preparePostData(n.postData)):r.send()}()}catch(e){o(e)}})}}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();onix.provider("$i18n",function(){var e={},t="",n=!0,i=function(e,t){e=e||"",t=t||{};var n=e.match(/{[^}]+,.*}|{[^}]*}/g);return n&&!function(){var i={};n.forEach(function(e){var n=e;n.length>2&&(n=n.substr(1,n.length-2));var o=n.split(","),r=o[0].trim(),s={};if(2==o.length){var a=o[1].match(/[a-zA-Z0-9_]+{[^}]*}/g);a&&a.forEach(function(e){var t=e.split("{"),n=t[1];n=n.substr(0,n.length-1),s[t[0].trim()]=n})}var c=r in t?t[r]:"";if("number"==typeof c&&Object.keys(s).length){var u=void 0;switch(c){case 1:u="one";break;case 2:case 3:case 4:u="few";break;default:u="other"}c=u in s?s[u]:""}i[e]=c}),Object.keys(i).forEach(function(t){e=e.replace(new RegExp(t,"g"),i[t])})}(),e},o=function(n,o){var r=e[t],s=n||"";return r&&!function(){var e=n.split("."),t=e.length;e.every(function(e,n){return e in r&&(r=r[e],n!=t-1||(s=r,!1))})}(),i(s,o)},r=function(t,n){t&&n&&(e[t]||(e[t]={}),Object.keys(n).forEach(function(i){e[t][i]=n[i]}))},s=function(e){t=e||""};this.disableGlobalTranslation=function(){n=!1},this.addLanguage=function(e,t){r(e,t)},this.setLanguage=function(e){s(e)},this.postProcess=function(){n&&(window._=o)},this.$get=["$http","$promise",function(n,i){var a=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"_",value:function(e,t){return o(e,t)}},{key:"addLanguage",value:function(e,t){r(e,t)}},{key:"setLanguage",value:function(e){s(e)}},{key:"getLanguage",value:function(e){return t}},{key:"getAllLanguages",value:function(t){return Object.keys(e)}},{key:"loadLanguage",value:function(e,t){return new i(function(i,o){n.createRequest({url:t}).then(function(t){r(e,t.data),i()},function(e){o(e)})})}}]),a}();return new a}]}),onix.config(["$i18nProvider",function(e){e.postProcess()}]),onix.service("$image",["$promise","$features",function(e,t){this.readFromFile=function(n,i){var o=this;return new e(function(e,r){if(!t.FILE_READER)return void r();var s=new FileReader,a={img:null,exif:null,canvas:null};s.onload=function(t){var r=s.result,c=new Uint8Array(r),u=null;"image/jpeg"!=n.type&&"image/pjpeg"!=n.type||(u=o.getEXIF(r));var h=new Image;h.onload=function(){var t=o.getImageDim(h,i),n=o.getCanvas(h,{width:t.width,height:t.height,orientation:u?u.Orientation:0,scaled:1!=t.scale});a.img=h,a.exif=u,a.canvas=n,e(a)},h.src=o.fileToBase64(n.type,c)},s.readAsArrayBuffer(n)})},this.getImageDim=function(e,t){t=t||0;var n=t>0&&e.width>t,i=t>0&&e.height>t,o={width:e.width,height:e.height,scale:1};if(n||i){var r=e.width,s=e.height;e.width>e.height?(s=t*s/r,r=t):(r=t*r/s,s=t),o.scale=e.width/r,o.width=r,o.height=s}return o},this.getCanvas=function(e,n){var i={width:e.width||0,height:e.height||0,orientation:0,scaled:!1,canvas:null};for(var o in n)i[o]=n[o];if(!t.CANVAS)return null;var r=i.canvas||document.createElement("canvas");r.width=i.width,r.height=i.height;var s=r.getContext("2d"),a=!0;if(i.orientation)switch(i.orientation){case 2:s.translate(i.width,0),s.scale(-1,1);break;case 180:case 3:s.translate(i.width,i.height),s.rotate(Math.PI);break;case 4:s.translate(0,i.height),s.scale(1,-1);break;case 5:r.width=i.height,r.height=i.width,s.rotate(.5*Math.PI),s.scale(1,-1),i.scaled&&(s.clearRect(0,0,r.width,r.height),s.drawImage(e,0,0,e.width,e.height,0,0,r.height,r.width),a=!1);break;case 90:case 6:r.width=i.height,r.height=i.width,s.rotate(.5*Math.PI),s.translate(0,-i.height),i.scaled&&(s.clearRect(0,0,r.width,r.height),s.drawImage(e,0,0,e.width,e.height,0,0,r.height,r.width),a=!1);break;case 7:r.width=i.height,r.height=i.width,s.rotate(.5*Math.PI),s.translate(i.width,-i.height),s.scale(-1,1),i.scaled&&(s.clearRect(0,0,r.width,r.height),s.drawImage(e,0,0,e.width,e.height,0,0,r.height,r.width),a=!1);break;case 270:case 8:r.width=i.height,r.height=i.width,s.rotate(-.5*Math.PI),s.translate(-i.width,0),i.scaled&&(s.clearRect(0,0,r.width,r.height),s.drawImage(e,0,0,e.width,e.height,0,0,r.height,r.width),a=!1)}return a&&(s.clearRect(0,0,r.width,r.height),i.scaled?s.drawImage(e,0,0,e.width,e.height,0,0,r.width,r.height):s.drawImage(e,0,0)),r},this.fileToBase64=function(e,t){for(var n=t.length,i="",o=0;o<n;o+=1)i+=String.fromCharCode(t[o]);return"data:"+e+";base64,"+btoa(i)},this.isPicture=function(e){return e&&("image/jpeg"==e.type||"image/pjpeg"==e.type||"image/png"==e.type)},this.getPictureFiles=function(e){var t=[];if(e&&e.length)for(var n=0;n<e.length;n++){var i=e[n];this.isPicture(i)&&t.push(i)}return t},this.getPicturesCount=function(e){return this.getPictureFiles(e).length},this.getEXIF=function(e){return"EXIF"in window?EXIF.readFromBinaryFile(e):{}}}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();onix.factory("$job",["$promise",function(e){var t=function(){function t(){_classCallCheck(this,t),this._isRunning=!1,this._tasks=[],this._taskDone={cb:null,scope:null}}return _createClass(t,[{key:"add",value:function(e,t,n){n=n||[],Array.isArray(n)||(n=[n]),this._tasks.push({task:e,scope:t,args:n})}},{key:"start",value:function(){var t=this;return new e(function(e,n){return t._isRunning||!t._tasks.length?void n():(t._isRunning=!0,t._tasks.reverse(),void t._doJob(e))})}},{key:"clear",value:function(){this._tasks=[]}},{key:"setTaskDone",value:function(e,t){this._taskDone.cb=e,this._taskDone.scope=t}},{key:"_doJob",value:function(e){var t=this,n=arguments,i=this._tasks.length;if(0==i)this._isRunning=!1,e();else{var o=this._tasks.pop();o.task.apply(o.scope||o.task,o.args.concat(function(){if(t._taskDone.cb){var i=Array.prototype.slice.call(n,0);t._taskDone.cb.apply(t._taskDone.scope||t._taskDone.cb,i)}t._doJob(e)}))}}}]),t}();return{create:function(){return new t},multipleJobs:function(t,n,i){for(var o=t.length,r=[],s=0;s<o;s++){var a=n>0?s%n:s,c=t[s];r[a]||(r[a]=this.create(),i&&r[a].setTaskDone(i.cb,i.scope)),r[a].add(c.task,c.scope,c.args)}var u=[];return r.forEach(function(e){u.push(e.start())}),e.all(u)}}}]),onix.factory("$localStorage",["$features",function(e){var t=e.LOCAL_STORAGE?window.localStorage:{_data:{},setItem:function(e,t){e&&(this._data[e]=t)},getItem:function(e){return e?this._data[e]:null},removeItem:function(e){e&&e in this._data&&delete this._data[e]}};return{set:function(e,n){t.setItem(e,n)},get:function(e){return t.getItem(e)},remove:function(e){t.removeItem(e)}}}]);var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":"undefined"==typeof e?"undefined":_typeof2(e)};onix.service("$location",function(){this.refresh=function(){window.location.reload()},this.createSearchURL=function(e){var t=this.objToURL(e);return t?"?"+t:""},this.objToURL=function(e){var t=[];return Array.isArray(e)?e.forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}):"object"===("undefined"==typeof e?"undefined":_typeof(e))&&Object.keys(e).forEach(function(n){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]))}),t.join("&")},this.search=function(e){if(e){var t=this.createSearchURL(e);t&&(window.location.search=t)}else{var n=function(){var e=location.search,t={};return e&&(e=e.replace("?",""),e.split("&").forEach(function(e){var n=e.split("="),i=decodeURIComponent(n[0]);t[i]=decodeURIComponent(n[1])})),{v:t}}();if("object"===("undefined"==typeof n?"undefined":_typeof(n)))return n.v}},this.get=function(){return window.location.pathname+window.location.search}}),onix.service("$math",function(){this._CONST={ZOOM:156543.034},this.isBBoxIntersection=function(e,t){var n=Math.max(e.x,t.x),i=Math.max(e.y,t.y),o=Math.min(e.x+e.width,t.x+t.width),r=Math.min(e.y+e.height,t.y+t.height),s=Math.abs(o-n),a=Math.abs(r-i);return n<=o&&i<=r&&s*a>0},this.getBBox=function(e){for(var t=1/0,n=1/0,i=-(1/0),o=-(1/0),r=0;r<e.length;r++)t=Math.min(e[r].x,t),n=Math.min(e[r].y,n),i=Math.max(e[r].x,i),o=Math.max(e[r].y,o);return{x:t,y:n,width:Math.abs(i-t),height:Math.abs(o-n)}},this.det2=function(e,t,n,i){return e*i-n*t},this.linesIntersection=function(e,t){var n=1e-6,i=this.det2(e.x1-e.x2,e.y1-e.y2,t.x1-t.x2,t.y1-t.y2);if(Math.abs(i)<n)return null;var o=this.det2(e.x1,e.y1,e.x2,e.y2),r=this.det2(t.x1,t.y1,t.x2,t.y2),s=this.det2(o,e.x1-e.x2,r,t.x1-t.x2)/i,a=this.det2(o,e.y1-e.y2,r,t.y1-t.y2)/i;return s<Math.min(e.x1,e.x2)-n||s>Math.max(e.x1,e.x2)+n?null:a<Math.min(e.y1,e.y2)-n||a>Math.max(e.y1,e.y2)+n?null:s<Math.min(t.x1,t.x2)-n||s>Math.max(t.x1,t.x2)+n?null:a<Math.min(t.y1,t.y2)-n||a>Math.max(t.y1,t.y2)+n?null:{x:Math.round(s),y:Math.round(a)}},this.pointBBoxIntersection=function(e,t){return e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height},this.log2=function(e){return Math.log(e)/Math.log(2)},this.zoomToDistance=function(e,t,n){var i=this._CONST.ZOOM/Math.pow(2,e),o=n/2,r=Math.floor(i*o),s=t/360*Math.PI;return Math.floor(r/Math.tan(s))},this.distanceToZoom=function(e,t,n){var i=t/360*Math.PI,o=Math.tan(i)*e,r=2*o/n;return Math.floor(this.log2(this._CONST.ZOOM/r))},this.movePointByAngle=function(e,t){var n=(360-t)/180*Math.PI,i=e.x,o=e.y;e.x=i*Math.cos(n)-o*Math.sin(n),e.y=i*Math.sin(n)+o*Math.cos(n)},this.movePointByVector=function(e,t,n){var i={x:t.x,y:t.y};this.movePointByAngle(i,n||0),e.x+=i.x,e.y+=i.y},this.setRange=function(e,t,n){return e<t?t:e>n?n:e}});var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":"undefined"==typeof e?"undefined":_typeof2(e)},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();onix.factory("$myQuery",["$common",function(e){var t=function(){function t(e,n){return _classCallCheck(this,t),this._els=this._getElementsFromValue(e,n),this}return _createClass(t,[{key:"_getElementsFromValue",value:function(n,i){n=Array.isArray(n)?n:[n];var o=[];return n.forEach(function(n){if("string"!=typeof n)n&&n instanceof t&&(n=n.getEl()),(e.isElement(n)||n==document||n==window)&&o.push(n);else if(n.match(/[<]\s*[a-zA-Z0-9]+[^>]*[>]/)){var r=document.createDocumentFragment(),s=document.createElement("div");for(s.insertAdjacentHTML("afterbegin",n);s.firstChild;)r.appendChild(s.firstChild);o.push(r)}else{i&&i instanceof t&&(i=i.getEl()),i=i&&i instanceof Element||i==window||i==document?i:document;var a=i.querySelectorAll(n);a&&(o=o.concat(Array.prototype.slice.call(a)))}}),o}},{key:"_operation",value:function(e,t){Array.isArray(this._els)||(this._els=Array.prototype.slice.call(this._els)),this._els.forEach(function(n,i){e.apply(t||e,[n,i])})}},{key:"_setGetAll",value:function(e,t){var n=this;if("undefined"==typeof e)return this;if("undefined"!=typeof t)return this._operation(function(n){n[e]=t}),this;var i=function(){var t=[];return n._operation(function(n){t.push(n[e])}),t.length?1==t.length?{v:t[0]}:{v:t}:{v:null}}();return"object"===("undefined"==typeof i?"undefined":_typeof(i))?i.v:void 0}},{key:"_bindEvent",value:function(e,t,n){return this._operation(function(i){i.addEventListener(e,function(e){t.apply(n||t,[e,i])})}),this}},{key:"get",value:function(e){return e=e||0,e>this._els.length?null:this._els[e]}},{key:"getEl",value:function(e){return this.get(e)}},{key:"attr",value:function(e,t){var n=this;if("undefined"==typeof e)return this;if("undefined"!=typeof t)return this._operation(function(n){n.setAttribute(e,t)}),this;var i=function(){var t=[];return n._operation(function(n){t.push(n.getAttribute(e))}),t.length?1==t.length?{v:t[0]}:{v:t}:{v:null}}();return"object"===("undefined"==typeof i?"undefined":_typeof(i))?i.v:void 0}},{key:"css",value:function(t,n){var i=this;if("undefined"!=typeof t){if("undefined"!=typeof n)return this._operation(function(i){i.style[e.cssNameToJS(t)]=n}),this;if("object"!==("undefined"==typeof t?"undefined":_typeof(t))||Array.isArray(t)){var o=this.getEl();return o?o.style[e.cssNameToJS(t)]:null}return Object.keys(t).forEach(function(n){i._operation(function(i){i.style[e.cssNameToJS(n)]=t[n]})}),this}return this}},{key:"src",value:function(e){return this._setGetAll("src",e)}},{key:"hide",value:function(){return this.css("display","none")}},{key:"show",value:function(e){return this.css("display",e||"")}},{key:"val",value:function(e){return this._setGetAll("value",e)}},{key:"html",value:function(e){return this._setGetAll("innerHTML",e)}},{key:"addClass",value:function(e){return this._operation(function(t){t.classList.add(e)}),this}},{key:"removeClass",value:function(e){return this._operation(function(t){t.classList.remove(e)}),this}},{key:"toggleClass",value:function(e){return this._operation(function(t){t.classList.toggle(e)}),this}},{key:"width",value:function e(){var e=0;return this._operation(function(t){e+=t.offsetWidth}),e}},{key:"height",value:function e(){var e=0;return this._operation(function(t){e+=t.offsetHeight}),e}},{key:"click",value:function(e,t){return this._bindEvent("click",e,t)}},{key:"change",value:function(e,t){return this._bindEvent("change",e,t)}},{key:"mouseenter",value:function(e,t){return this._bindEvent("mouseenter",e,t)}},{key:"mouseleave",value:function(e,t){return this._bindEvent("mouseleave",e,t)}},{key:"mousemove",value:function(e,t){return this._bindEvent("mousemove",e,t)}},{key:"keydown",value:function(e,t){return this._bindEvent("keydown",e,t)}},{key:"keyup",value:function(e,t){return this._bindEvent("keyup",e,t)}},{key:"keypress",value:function(e,t){return this._bindEvent("keypress",e,t)}},{key:"blur",value:function(e,t){return this._bindEvent("blur",e,t)}},{key:"focus",value:function(e,t){return this._bindEvent("focus",e,t)}},{key:"each",value:function(e,t){return this._operation(function(n,i){e.apply(t||e,[n,i])}),this}},{key:"forEach",value:function(e,t){return this.each(e,t)}},{key:"remove",value:function(){return this._operation(function(e){e.parentNode.removeChild(e)}),this}},{key:"append",value:function(e){return e=this._getElementsFromValue(e),e.length&&this._operation(function(t,n){var i=n?e[0].cloneNode(!0):e[0];t.appendChild(i)}),this}},{key:"prepend",value:function(e){return e=this._getElementsFromValue(e),e.length&&this._operation(function(t,n){var i=n?e[0].cloneNode(!0):e[0];t.insertBefore(i,t.firstChild)}),this}},{key:"insertBefore",value:function(e){e=this._getElementsFromValue(e);var t=this.getEl();return t&&e.length&&e[0].parentNode.insertBefore(t,e[0]),this}},{key:"empty",value:function(){return this._operation(function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}),this}},{key:"len",value:function(){return this._els.length}},{key:"parent",value:function(){var e=this.getEl();return e?new this(e):null}},{key:"children",value:function(){var e=this.getEl();return e?e.children:[]}},{key:"scrollTop",value:function(){var e=this.getEl(),t=document.body.scrollTop;return e?e.scrollTop+t:t+0}},{key:"scrollLeft",value:function(){var e=this.getEl(),t=document.body.scrollLeft;return e?e.scrollLeft+t:t+0}}]),t}();return onix.element=function(e,n){return new t(e,n)},{get:function(e,n){return new t(e,n)}}}]),onix.run(["$myQuery",function(){}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();onix.factory("$promise",function(){var e=function(){function e(t){if(_classCallCheck(this,e),this._STATES={IDLE:0,RESOLVED:1,REJECTED:2},this._state=this._STATES.IDLE,this._thens=[],this._fulfillData=null,t&&"function"==typeof t)try{t.apply(t,[this._resolve.bind(this),this._reject.bind(this)])}catch(e){console.error("$promise exception "+e)}}return _createClass(e,[{key:"_resolve",value:function(e){this._fulfillData=e,this._state=this._STATES.RESOLVED,this._resolveFuncs()}},{key:"_reject",value:function(e){this._fulfillData=e,this._state=this._STATES.REJECTED,this._resolveFuncs()}},{key:"_resolveFuncs",value:function(){for(var t=this,n=this._thens.length,i=this._state==this._STATES.REJECTED,o=0;o<n;o++){var r=this._thens[o],s=i&&r.rejectCb?r.rejectCb:!i&&r.resolveCb?r.resolveCb:null;if(s)try{var a=s(this._fulfillData);if(a&&o!=n-1){var c=function(){var n=null,i=t._thens.slice(o+1),r=void 0;return r=a instanceof e?a:new e(function(e){n=e}),i.forEach(function(e){r.then(e.resolveCb,e.rejectCb)}),n&&n(a),"break"}();if("break"===c)break}}catch(e){console.error(e)}}this._thens.length=0}},{key:"_isAlreadyFinished",value:function(){this._state!=this._STATES.IDLE&&this._resolveFuncs()}},{key:"then",value:function(e,t){return this._thens.push({resolveCb:e&&"function"==typeof e?e:null,rejectCb:t&&"function"==typeof t?t:null}),this._isAlreadyFinished(),this}},{key:"catch",value:function(e){return this._thens.push({resolveCb:null,rejectCb:e&&"function"==typeof e?e:null}),this._isAlreadyFinished(),this}}],[{key:"_multiplePromises",value:function(t,n){return new e(function(e){Array.isArray(t)&&t.length?!function(){var i=n?1:t.length,o=function(t){i--,0==i&&e(n?t:null)};t.forEach(function(e){e.then(function(e){o(e)},function(e){o(e)})})}():e()})}},{key:"all",value:function(t){return e._multiplePromises(t)}},{key:"race",value:function(t){return e._multiplePromises(t,!0)}},{key:"resolve",value:function(t){return new e(function(e){e(t)})}},{key:"reject",value:function(t){return new e(function(e,n){n(t)})}}]),e}();return e}),onix.service("$route",["$location","$template","$di","$routeParams",function(e,t,n,i){this._routes=[],this._otherwise=null,this._setRouteParams=function(e){Object.keys(i).forEach(function(e){delete i[e]}),e=e||{},Object.keys(e).forEach(function(t){i[t]=e[t]})},this.when=function(e,t){return this._routes.push({url:e,config:t}),this},this.otherwise=function(e){return this._otherwise={config:e},this},this._runController=function(e,t){var i=n.parseParam(e);this._setRouteParams(t),n.run({fn:i.fn,inject:i.inject})},this.go=function(){var n=this,i=e.get(),o=!1,r=null;this._routes.every(function(e){return i!=e.url&&!i.match(new RegExp(e.url))||(r=e.config,o=!0,!1)}),!o&&this._otherwise&&(r=this._otherwise.config),r&&!function(){var e="",i=null,o=null,s={};Object.keys(r).forEach(function(t){var n=r[t];switch(t){case"templateId":e=n;break;case"templateUrl":i=n;break;case"controller":o=n;break;default:s[t]=n}});var a=function(){o&&n._runController(o,s)};i?t.load(r.templateId||r.templateUrl,r.templateUrl).then(a):a()}()}}]),onix.factory("$routeParams",function(){return{}});var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":"undefined"==typeof e?"undefined":_typeof2(e)},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();onix.provider("$template",function(){var e={left:"{{",right:"}}",elPrefix:"data-",elDataBind:"data-bind"};this.setConfig=function(t){Object.keys(t).forEach(function(n){e[n]=t[n]})},this.$get=["$common","$promise","$http","$filter",function(t,n,i,o){var r=function(){function t(){_classCallCheck(this,t),this._cache={},this._RE={VARIABLE:/[$_a-zA-Z][$_a-zA-Z0-9]+/g,NUMBERS:/[-]?[0-9]+[.]?([0-9e]+)?/g,STRINGS:/["'][^"']+["']/g,JSONS:/[{][^}]+[}]/g,ALL:/[-]?[0-9]+[.]?([0-9e]+)?|["'][^"']+["']|[{][^}]+[}]|[$_a-zA-Z][$_a-zA-Z0-9]+/g},this._CONST={FILTER_DELIMETER:"|",FILTER_PARAM_DELIMETER:":",TEMPLATE_SCRIPT_SELECTOR:"script[type='text/template']"},this._init()}return _createClass(t,[{key:"_parseFnName",value:function(e){return e=e||"",e.match(/[a-zA-Z0-9_]+/)[0]}},{key:"_parseArgs",value:function(e,t){var n=this,i=e?e.replace(/^[^(]+./,"").replace(/\).*$/,""):"",o=[],r=i.match(this._RE.ALL);return r&&!function(){var e=[];r.forEach(function(o){var r=void 0;if(o.match(n._RE.STRINGS))r=o.substr(1,o.length-2);else if(o.match(n._RE.NUMBERS))r=parseFloat(o);else if(o.match(n._RE.JSONS))r=JSON.parse(o);else if(o.match(n._RE.VARIABLE)){var s=o.match(n._RE.VARIABLE)[0];r="$event"==s?t.event:"$element"==s?t.el:null}e.push({value:r,pos:i.indexOf(o)})}),e.length&&e.sort(function(e,t){return e.pos-t.pos}).forEach(function(e){o.push(e.value)})}(),o}},{key:"_bindEvent",value:function(t,n,i){var o=this;if(t&&n&&i){var r=n.name.replace(e.elPrefix,""),s=this._parseFnName(n.value);r&&s in i&&t.addEventListener(r,function(e){var r=o._parseArgs(n.value,{el:t,event:e});i[s].apply(i,r)})}}},{key:"_getAttributes",value:function(t){var n=[];return t&&"attributes"in t&&Object.keys(t.attributes).forEach(function(i){var o=t.attributes[i];o&&"object"===("undefined"==typeof o?"undefined":_typeof(o))&&o.name&&o.name.indexOf(e.elPrefix)!=-1&&n.push({name:o.name,value:o.value})}),n}},{key:"_init",value:function(){var e=this;onix.element(this._CONST.TEMPLATE_SCRIPT_SELECTOR).forEach(function(t){e.add(t.id||"",t.innerHTML)})}},{key:"add",value:function(e,t){this._cache[e]=t}},{key:"compile",value:function(t,n){var i=this,r=this.get(t);if(n){var s=r.match(new RegExp(e.left+"(.*?)"+e.right,"g"))||[];s.forEach(function(t){var s=t;if(t=t.replace(new RegExp("^"+e.left),"").replace(new RegExp(e.right+"$"),""),t.indexOf(i._CONST.FILTER_DELIMETER)!=-1)!function(){var e=void 0;t.split(i._CONST.FILTER_DELIMETER).forEach(function(t,r){t=t.trim(),r?!function(){var n=[e],r=t.split(i._CONST.FILTER_PARAM_DELIMETER),s="";1==r.length?s=r[0].trim():r.forEach(function(e,t){e=e.trim(),t?n.push(e):s=e});var a=o(s);e=a.apply(a,n)}():t in n&&(e=n[t])}),r=r.replace(s,e||"")}();else{var a="";t=t.trim(),t in n&&(a=n[t]),r=r.replace(s,a)}})}return r}},{key:"get",value:function(e){return this._cache[e]||""}},{key:"bindTemplate",value:function(t,n,i){var o=this,r=onix.element("*",t);r.len()&&!function(){var t={};r.forEach(function(i){var r=o._getAttributes(i);r.forEach(function(r){r.name==e.elDataBind?t[r.value]=i:o._bindEvent(i,r,n)})}),i&&"function"==typeof i&&i(t)}()}},{key:"load",value:function(e,t){var o=this;return new n(function(n,r){i.createRequest({url:t}).then(function(t){o.add(e,t.data),n()},function(e){r(e)})})}}]),t}();return new r}]}),onix.service("$features",function(){this.FILE_READER="FileReader"in window,this.CANVAS=!!document.createElement("canvas").getContext;var e=!0;try{window.localStorage}catch(t){e=!1}this.LOCAL_STORAGE=e,this.MEDIA_QUERY="matchMedia"in window&&"matches"in window.matchMedia("(min-width: 500px)")});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();onix.factory("$anonymizer",["$math","$event","$loader","$promise","$common","$features",function(e,t,n,i,o,r){var s=function(t){function s(e,t){_classCallCheck(this,s);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(s).call(this));if(i._eventInit(),!r.CANVAS)return console.error("Canvas is not available!"),_possibleConstructorReturn(i);i._parent=e,i._parent.classList.add("anonymizer"),i._opts={canWidth:e.offsetWidth||0,canHeight:e.offsetHeight||0,zoom:100,minZoom:20,maxZoom:100,zoomStep:10,zoomMoveStep:1,curEntity:s.ENTITES.CIRCLE,showPreview:!0,previewLeft:17,previewTop:17,previewWidth:200,entityPreview:null};for(var o in t)i._opts[o]=t[o];return i._canWidth=i._opts.canWidth,i._canHeight=i._opts.canHeight,i._zoom=i._opts.zoom,i._zoomStep=i._opts.zoomStep,i._zoomMoveStep=0,i._curWidth=0,i._curHeight=0,i._canvas=document.createElement("canvas"),i._canvas.width=i._canWidth,i._canvas.height=i._canHeight,i._ctx=i._canvas.getContext("2d"),i._img=null,i._imgWidth=0,i._imgHeight=0,i._lineCanvas=null,i._lineCanvasCtx=null,i._entityCanvas=null,i._entityCanvasCtx=null,i._entites=[],i._x=0,i._y=0,i._THRESHOLD={MIN:-1,MAX:1},i._mouse={startXSave:0,startYSave:0,startX:0,startY:0,bcr:null},i._flags={wasRightClick:!1,wasMove:!1,wasPreview:!1,wasLine:!1,wasImgMove:!1},i._binds={mouseWheel:i._mouseWheel.bind(i),mouseDown:i._mouseDown.bind(i),mouseMove:i._mouseMove.bind(i),mouseUp:i._mouseUp.bind(i),mouseMoveLine:i._mouseMoveLine.bind(i),mouseUpLine:i._mouseUpLine.bind(i),contextMenu:i._cancelEvents.bind(i)},i._canvas.addEventListener("DOMMouseScroll",i._binds.mouseWheel),i._canvas.addEventListener("mousewheel",i._binds.mouseWheel),i._canvas.addEventListener("mousedown",i._binds.mouseDown),i._canvas.addEventListener("contextmenu",i._binds.contextMenu),i._spinner=n.getSpinner(),e.appendChild(i._spinner),e.appendChild(i._canvas),i._opts.entityPreview&&(i._entityCanvas=document.createElement("canvas"),i._entityCanvas.width=300,i._entityCanvas.height=150,i._entityCanvasCtx=i._entityCanvas.getContext("2d"),i._opts.entityPreview.appendChild(i._entityCanvas)),i}return _inherits(s,t),_createClass(s,[{key:"_redraw",value:function(){var e=this;this._ctx.clearRect(0,0,this._canWidth,this._canHeight),this._ctx.drawImage(this._img,this._x,this._y,this._img.width,this._img.height,0,0,this._curWidth,this._curHeight),
this._entites.length&&!function(){var t=e._zoom/100,n=e._x*t,i=e._y*t;e._entites.forEach(function(o){var r=void 0,a=void 0;switch(o.id){case s.ENTITES.CIRCLE.id:var c=Math.round(o.value*t);r=Math.round(e._curWidth*o.xRatio-n),a=Math.round(e._curHeight*o.yRatio-i),e._drawCircle(e._ctx,r,a,c);break;case s.ENTITES.LINE.id:var u=Math.round(o.value*t);r=Math.round(e._curWidth*o.xRatio-n),a=Math.round(e._curHeight*o.yRatio-i);var h=Math.round(e._curWidth*o.x2Ratio-n),l=Math.round(e._curHeight*o.y2Ratio-i);e._drawLine(e._ctx,r,a,h,l,u)}})}(),this._drawPreview()}},{key:"_setWhiteCanvas",value:function(){this._ctx.clearRect(0,0,this._canWidth,this._canHeight),this._drawFillRect(this._ctx,0,0,this._canWidth,this._canHeight,"#fff")}},{key:"_drawCircle",value:function(e,t,n,i){e.beginPath(),e.arc(t,n,i,0,2*Math.PI),e.fillStyle=s.ENTITES.CIRCLE.fillStyle,e.closePath(),e.fill()}},{key:"_drawLine",value:function(e,t,n,i,o,r){e.beginPath(),e.moveTo(t,n),e.lineTo(i,o),e.lineWidth=r,e.strokeStyle=s.ENTITES.LINE.strokeStyle,e.closePath(),e.stroke()}},{key:"_drawFillRect",value:function(e,t,n,i,o,r){e.beginPath(),e.fillStyle=r||"",e.fillRect(t,n,i,o),e.closePath()}},{key:"_drawRect",value:function(e,t,n,i,o,r,s){e.beginPath(),e.rect(t,n,i,o),e.lineWidth=s||1,e.strokeStyle=r||"",e.closePath(),e.stroke()}},{key:"_drawPreview",value:function(){if(this._opts.showPreview){var t=this._imgWidth/this._imgHeight,n=Math.round(this._opts.previewWidth/t);this._drawFillRect(this._ctx,this._opts.previewLeft-1,this._opts.previewTop-1,this._opts.previewWidth+2,n+2,"rgba(255, 255, 255, 0.5)"),this._ctx.drawImage(this._img,0,0,this._img.width,this._img.height,this._opts.previewLeft,this._opts.previewTop,this._opts.previewWidth,n);var i=this._zoom/100,o=this._x*i,r=this._y*i,s=o/this._curWidth,a=r/this._curHeight,c=(o+this._canWidth)/this._curWidth,u=(r+this._canHeight)/this._curHeight;s=e.setRange(s,0,1),a=e.setRange(a,0,1),c=e.setRange(c,0,1),u=e.setRange(u,0,1);var h=Math.round(this._opts.previewLeft+s*this._opts.previewWidth),l=Math.round(this._opts.previewTop+a*n),f=Math.round(this._opts.previewLeft+c*this._opts.previewWidth),d=Math.round(this._opts.previewTop+u*n);this._drawRect(this._ctx,h,l,f-h,d-l,"#C01",1)}}},{key:"_drawEntityPreview",value:function(){if(this._opts.entityPreview){var e=this._entityCanvas.width,t=this._entityCanvas.height;this._entityCanvasCtx.clearRect(0,0,e,t),this._drawFillRect(this._entityCanvasCtx,0,0,e,t,"#f9f9f9");var n=this._opts.curEntity,i=this._zoom/100;switch(n.id){case s.ENTITES.CIRCLE.id:var o=Math.round(n.value*i),r=Math.round(e/2),a=Math.round(t/2);this._drawCircle(this._entityCanvasCtx,r,a,o);break;case s.ENTITES.LINE.id:var c=Math.round(.2*e),u=Math.round(t/2),h=Math.round(.8*e),l=Math.round(n.value*i);this._drawLine(this._entityCanvasCtx,c,u,h,u,l)}}}},{key:"_getFromPoint",value:function(e,t){var n={x:e||Math.round(this._canWidth/2),y:t||Math.round(this._canHeight/2)},i=this._zoom/100,o=Math.round(this._x*i)+n.x,r=Math.round(this._y*i)+n.y;return n.xRatio=o/this._curWidth,n.yRatio=r/this._curHeight,n}},{key:"_postZoom",value:function(){var e=this._zoom/100;this._curWidth=Math.round(this._img.width*e),this._curHeight=Math.round(this._img.height*e),this._zoom<100&&(this._zoomMoveStep=Math.max((100-this._zoom)/10*this._opts.zoomMoveStep/2,1))}},{key:"_setCenter",value:function(){this._setPosition(.5,.5)}},{key:"_setPosition",value:function(t,n,i,o){i=i||this._canWidth/2,o=o||this._canHeight/2,t=e.setRange(t,0,1),n=e.setRange(n,0,1);var r=this._zoom/100,s=this._curWidth*t-i,a=this._curHeight*n-o;this._x=Math.max(Math.round(s/r),0),this._y=Math.max(Math.round(a/r),0)}},{key:"_alignImgToCanvas",value:function(){var e=Math.max(this._curWidth-this._canWidth,0),t=Math.round(this._x*this._zoom/100);this._x<0?this._x=0:t>e&&(this._x=Math.round(100*e/this._zoom));var n=Math.max(this._curHeight-this._canHeight,0),i=Math.round(this._y*this._zoom/100);this._y<0?this._y=0:i>n&&(this._y=Math.round(100*n/this._zoom))}},{key:"_isRightClick",value:function(e){return!(!e||!(e.which&&3==e.which||e.button&&2==e.button))}},{key:"_cancelEvents",value:function(e){o.cancelEvents(e)}},{key:"_mouseWheel",value:function(e){if(this._imgWidth||this._imgHeight){var t=e.wheelDelta||-e.detail;if(t){this._cancelEvents(e),this._setBCR();var n=this._getMouseXY(e),i=this._getFromPoint(n.x,n.y);t>0?this._setZoom(this._zoom+this._zoomStep,i):this._setZoom(this._zoom-this._zoomStep,i)}}}},{key:"_getMouseXY",value:function(e){return{x:e.clientX-this._mouse.bcr.left,y:e.clientY-this._mouse.bcr.top}}},{key:"_setBCR",value:function(){this._mouse.bcr=this._canvas.getBoundingClientRect()}},{key:"_mouseDown",value:function(e){if(this._imgWidth||this._imgHeight){this._cancelEvents(e),this._setBCR();var t=this._getMouseXY(e);if(this._mouse.startXSave=t.x,this._mouse.startYSave=t.y,this._mouse.startX=this._mouse.startXSave,this._mouse.startY=this._mouse.startYSave,this._flags.wasMove=!1,this._flags.wasRightClick=this._isRightClick(e),this._opts.curEntity==s.ENTITES.CIRCLE)this._flags.wasImgMove=!1,this._flags.wasPreview=!1,document.addEventListener("mousemove",this._binds.mouseMove),document.addEventListener("mouseup",this._binds.mouseUp);else if(this._opts.curEntity==s.ENTITES.LINE){var n=document.createElement("canvas");n.width=this._canWidth,n.height=this._canHeight,n.classList.add("line-canvas"),this._flags.wasPreview=!1,this._flags.wasLine=!1,this._lineCanvas=n,this._lineCanvas.addEventListener("contextmenu",this._binds.contextMenu),document.addEventListener("mousemove",this._binds.mouseMoveLine),document.addEventListener("mouseup",this._binds.mouseUpLine),this._flags.wasRightClick&&this._lineCanvas.classList.add("is-dragged"),this._lineCanvasCtx=this._lineCanvas.getContext("2d"),this._parent.appendChild(n)}}}},{key:"_imgMove",value:function(e,t){var n=this._mouse.startX-e,i=this._mouse.startY-t;if(0!=n||0!=i){var o=this._zoomMoveStep>0?this._zoomMoveStep:1;this._x=n*o+this._x,this._y=i*o+this._y,this._alignImgToCanvas(),this._redraw()}}},{key:"_mouseMove",value:function(e){var t=this._getMouseXY(e);this._flags.wasMove||this._canvas.classList.add("is-dragged"),this._flags.wasMove=!0;var n=this._isPreview(t.x,t.y);this._flags.wasRightClick||this._flags.wasImgMove||!n?this._flags.wasPreview||(this._flags.wasImgMove=!0,this._imgMove(t.x,t.y)):(this._flags.wasPreview=!0,this._setPosition(n.xRatio,n.yRatio),this._alignImgToCanvas(),this._redraw()),this._mouse.startX=t.x,this._mouse.startY=t.y}},{key:"_isPreview",value:function(e,t){if(!this._opts.showPreview)return null;var n=this._imgWidth/this._imgHeight,i=this._opts.previewWidth,o=Math.round(this._opts.previewWidth/n),r=this._opts.previewLeft,s=this._opts.previewTop;this._zoom/100;return e=e||0,t=t||0,e>=r&&e<=r+i&&t>=s&&t<=s+o?{xRatio:(e-r)/i,yRatio:(t-s)/o}:null}},{key:"_mouseUp",value:function(e){var t=this._getMouseXY(e),n=!1;if(this._flags.wasMove){var i=this._mouse.startXSave-t.x,o=this._mouse.startYSave-t.y;i>=this._THRESHOLD.MIN&&i<=this._THRESHOLD.MAX&&o>=this._THRESHOLD.MIN&&o<=this._THRESHOLD.MAX&&(n=!0)}if(!this._flags.wasRightClick&&(!this._flags.wasMove||n)){var r=this._isPreview(t.x,t.y);if(r)this._setPosition(r.xRatio,r.yRatio),this._alignImgToCanvas(),this._redraw();else{var s=this._zoom/100,a=Math.round(this._x*s)+t.x,c=Math.round(this._y*s)+t.y;this._entites.push({id:this._opts.curEntity.id,value:this._opts.curEntity.value,xRatio:a/this._curWidth,yRatio:c/this._curHeight}),this._redraw()}}this._canvas.classList.remove("is-dragged"),document.removeEventListener("mousemove",this._binds.mouseMove),document.removeEventListener("mouseup",this._binds.mouseUp)}},{key:"_mouseMoveLine",value:function(e){var t=this._getMouseXY(e);if(this._flags.wasMove=!0,this._flags.wasRightClick)this._imgMove(t.x,t.y),this._mouse.startX=t.x,this._mouse.startY=t.y;else{var n=this._isPreview(t.x,t.y),i=this._flags.wasPreview;if(!this._flags.wasLine&&n)this._flags.wasPreview=!0,this._setPosition(n.xRatio,n.yRatio),this._alignImgToCanvas(),this._redraw();else if(!this._flags.wasPreview){this._flags.wasLine=!0;var o=Math.round(this._opts.curEntity.value*this._zoom/100);this._lineCanvasCtx.clearRect(0,0,this._canWidth,this._canHeight),this._drawLine(this._lineCanvasCtx,this._mouse.startX,this._mouse.startY,t.x,t.y,o)}!i&&this._flags.wasPreview&&this._lineCanvas.classList.add("is-dragged")}}},{key:"_mouseUpLine",value:function(e){var t=this._getMouseXY(e),n=null;if(this._flags.wasMove||(n=this._isPreview(t.x,t.y)),!this._flags.wasRightClick)if(n)this._setPosition(n.xRatio,n.yRatio),this._alignImgToCanvas(),this._redraw();else if(this._flags.wasLine){var i=this._zoom/100,o=Math.round(this._x*i),r=Math.round(this._y*i),s=o+this._mouse.startX,a=r+this._mouse.startY,c=o+t.x,u=r+t.y;this._entites.push({id:this._opts.curEntity.id,value:this._opts.curEntity.value,xRatio:s/this._curWidth,yRatio:a/this._curHeight,x2Ratio:c/this._curWidth,y2Ratio:u/this._curHeight}),this._redraw()}this._lineCanvas.classList.remove("is-dragged"),this._lineCanvas.removeEventListener("contextmenu",this._binds.contextMenu),document.removeEventListener("mousemove",this._binds.mouseMoveLine),document.removeEventListener("mouseup",this._binds.mouseUpLine),this._parent.removeChild(this._lineCanvas),this._lineCanvas=null}},{key:"_setZoom",value:function(t,n){n=n||this._getFromPoint();var i=this._zoom,o=e.setRange(t,this._opts.minZoom,this._opts.maxZoom);o!=i&&(this._zoom=o,this.trigger("zoom",this._zoom),this._postZoom(),this._setPosition(n.xRatio,n.yRatio,n.x,n.y),this._alignImgToCanvas(),this._drawEntityPreview(),this._redraw())}},{key:"loadImage",value:function(e){var t=this;return new i(function(n,i){t._setWhiteCanvas(),t._spinner.classList.remove("hide");var o=new Image;o.addEventListener("load",function(){t._spinner.classList.add("hide"),t._img=o,t._imgWidth=o.width,t._imgHeight=o.height,t._zoom=t._opts.zoom,t.trigger("zoom",t._zoom),t._postZoom(),t._setCenter(),t._alignImgToCanvas(),t._drawEntityPreview(),t._redraw(),n()}),o.addEventListener("error",function(){t._spinner.classList.add("hide"),t._img=null,t._imgWidth=0,t._imgHeight=0,i()}),o.src=e||""})}},{key:"zoomPlus",value:function(){this._setZoom(this._zoom+this._zoomStep)}},{key:"zoomMinus",value:function(){this._setZoom(this._zoom-this._zoomStep)}},{key:"setZoom",value:function(e){this._setZoom(e)}},{key:"getEntityId",value:function(){return this._opts.curEntity.id}},{key:"switchEntity",value:function(){var e=this,t=Object.keys(s.ENTITES),n=(this._opts.curEntity.priority,null),i=null;t.forEach(function(t){var o=s.ENTITES[t];!n&&o.priority>e._opts.curEntity.priority&&(n=o),(!i||o.priority<i.priority)&&(i=o)}),n||(n=i),this._opts.curEntity=n,this._drawEntityPreview()}},{key:"getEntity",value:function(){return this._opts.curEntity}},{key:"setEntityValue",value:function(e){return e=e||0,e>=this._opts.curEntity.min&&e<=this._opts.curEntity.max&&(this._opts.curEntity.value=e,this._drawEntityPreview(),!0)}},{key:"setCircleEntity",value:function(){this._opts.curEntity=s.ENTITES.CIRCLE,this._drawEntityPreview()}},{key:"setLineEntity",value:function(){this._opts.curEntity=s.ENTITES.LINE,this._drawEntityPreview()}},{key:"stepBack",value:function(){(this._imgWidth||this._imgHeight)&&(this._entites.pop(),this._redraw())}},{key:"removeAll",value:function(){(this._imgWidth||this._imgHeight)&&(this._entites=[],this._redraw())}},{key:"exportEntites",value:function(){var t=this,n={actions:[],image:{width:this._imgWidth,height:this._imgHeight}};return this._entites.forEach(function(i){switch(i.id){case s.ENTITES.CIRCLE.id:n.actions.push({type:i.id.toLowerCase(),x:e.setRange(Math.round(t._imgWidth*i.xRatio),0,t._imgWidth),y:e.setRange(Math.round(t._imgHeight*i.yRatio),0,t._imgHeight),r:i.value});break;case s.ENTITES.LINE.id:n.actions.push({type:i.id.toLowerCase(),x1:e.setRange(Math.round(t._imgWidth*i.xRatio),0,t._imgWidth),y1:e.setRange(Math.round(t._imgHeight*i.yRatio),0,t._imgHeight),x2:e.setRange(Math.round(t._imgWidth*i.x2Ratio),0,t._imgWidth),y2:e.setRange(Math.round(t._imgHeight*i.y2Ratio),0,t._imgHeight),width:i.value})}}),n}},{key:"syncPort",value:function(e,t){e=e||this._parent.offsetWidth,t=t||this._parent.offsetHeight,this._canWidth=e,this._canHeight=t,this._canvas.width=e,this._canvas.height=t,this._img&&(this._postZoom(),this._setCenter(),this._alignImgToCanvas(),this._drawEntityPreview(),this._redraw())}}]),s}(t);return s.ENTITES={CIRCLE:{min:10,value:50,max:100,id:"CIRCLE",fillStyle:"rgba(0, 0, 255, 0.5)",priority:1},LINE:{min:10,value:20,max:100,id:"LINE",strokeStyle:"rgba(0, 255, 0, 0.5)",priority:2}},s}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();onix.factory("$loader",["$dom",function(e){var t=function(){function t(){_classCallCheck(this,t),this._create()}return _createClass(t,[{key:"_create",value:function(){this._el=e.create({el:"div",class:"loader"}),document.body.insertBefore(this._el,document.body.firstChild)}},{key:"start",value:function(){this._el.classList.add("start")}},{key:"end",value:function(){var e=this;this._el.classList.remove("start"),this._el.classList.add("end"),setTimeout(function(){e._el.classList.remove("end"),e._el.classList.add("hide"),setTimeout(function(){e._el.classList.remove("hide")},350)},150)}},{key:"getSpinner",value:function(t){for(var n=[],i=1;i<6;i++)n.push({el:"div",class:"rect"+i});var o={el:"div",class:"spinner",child:n};return t?o:e.create(o)}}]),t}();return new t}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();onix.service("$notify",["$common","$promise",function(e,t){var n=function(){function n(e){return _classCallCheck(this,n),this._el=e,this._HIDE_TIMEOUT=1500,this._options={ok:"alert-success",error:"alert-danger",info:"alert-info",warn:"alert-warning"},this}return _createClass(n,[{key:"_setValue",value:function(t){e.isElement(t)?onix.element(this._el).empty().append(t):"string"==typeof t&&(this._el.innerHTML=t)}},{key:"reset",value:function(){var e=this;return Object.keys(this._options).forEach(function(t){e._el.classList.remove(e._options[t])}),this}},{key:"ok",value:function(e){return this._el.classList.add(this._options.ok),this._setValue(e),this}},{key:"error",value:function(e){return this._el.classList.add(this._options.error),this._setValue(e),this}},{key:"info",value:function(e){return this._el.classList.add(this._options.info),this._setValue(e),this}},{key:"warn",value:function(e){return this._el.classList.add(this._options.warn),this._setValue(e),this}},{key:"hide",value:function(e){var n=this;return new t(function(t){setTimeout(function(){n.reset(),t()},e||n._HIDE_TIMEOUT)})}}]),n}();this.get=function(e){return new n(e)}}]);var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":"undefined"==typeof e?"undefined":_typeof2(e)};onix.service("$previewImages",["$image","$dom","$job","$loader",function(e,t,n,i){this._createPreview=function(e,n){var o={},r=t.create({el:"span",class:["preview-item","preview-loading"],child:[{el:"span",class:"canvas-cover",child:i.getSpinner(!0),style:"height: "+(n||100)+"px",_exported:"canvasCover"},{el:"span",class:"title",innerHTML:e.name.replace(/\..*/g,"")}]},o);return{cont:r,canvasCover:o.canvasCover}},this._createPreviewHolders=function(e,n){if(e&&(4==n||7==n)){var i={};7==n&&e.appendChild(t.create({el:"div",child:{el:"span",_exported:"img_06"}},i));for(var o=[],r=7==n?6:4,s=0;s<r;s++)o.push({el:"span",_exported:"img_0"+s});e.appendChild(t.create({el:"div",child:o},i));for(var a=0;a<n;a++)this._dom["img_0"+a]=i["img_0"+a]}},this._jobTask=function(t,n,i){var o=t.file,r=t.previewID,s=this._createPreview(o,n);r in this._dom?this._dom[r].appendChild(s.cont):this._dom.previewItems.appendChild(s.cont),e.readFromFile(o,n).then(function(e){s.cont.classList.remove("preview-loading"),s.canvasCover.innerHTML="",s.canvasCover.appendChild(e.canvas),i()})},this.show=function(t,i,o){var r=this;t.innerHTML="",t.classList.add("preview-images");var s={maxSize:0,count:0,createHolder:!1};for(var a in o)s[a]=o[a];this._dom={previewItems:t};var c=e.getPictureFiles(i),u=c.length;if(!u)return!1;var h=function(){s.createHolder&&r._createPreviewHolders(t,u);var e=[];return c=c.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}).forEach(function(t,n){e.push({task:r._jobTask,scope:r,args:[{file:t,previewID:"img_0"+n},s.maxSize]})}),n.multipleJobs(e,s.count),{v:!0}}();return"object"===("undefined"==typeof h?"undefined":_typeof(h))?h.v:void 0}}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();onix.factory("$select",["$common","$event","$dom",function(e,t,n){var i=function(e){function t(e,n){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this));i._eventInit(),i._opts={addCaption:!1};for(var o in n)i._opts[o]=n[o];return i._CONST={CAPTION_SEL:".dropdown-toggle",OPTIONS_SEL:".dropdown-menu a",CARET_SEL:".caret",OPEN_DROPDOWN_SEL:".dropdown.open",OPEN_CLASS:"open",ACTIVE_CLASS:"active"},i._el=e,i._optinsRef=[],i._captionEl=null,i.captionTextEl=null,i._binds={captionClick:i._captionClick.bind(i),choiceClick:i._choiceClick.bind(i),removeAllOpened:i._removeAllOpened.bind(i),click:i._click.bind(i)},i._bind(),i}return _inherits(t,e),_createClass(t,[{key:"_bind",value:function(){this._bindCaption(),this._bindChoices()}},{key:"_bindCaption",value:function(){var e=this._el.querySelector(this._CONST.CAPTION_SEL);if(e&&(e.addEventListener("click",this._binds.captionClick),this._opts.addCaption)){var t=e.querySelector(this._CONST.CARET_SEL);if(t){var i=n.create({el:"span",class:"add-caption"});e.insertBefore(i,t),this._captionTextEl=i}}this._captionEl=e}},{key:"_removeAllOpened",value:function(){var e=this;onix.element(this._CONST.OPEN_DROPDOWN_SEL).forEach(function(t){t.classList.remove(e._CONST.OPEN_CLASS)})}},{key:"_click",value:function(){this._removeAllOpened(),document.removeEventListener("click",this._binds.click)}},{key:"_captionClick",value:function(e){e.stopPropagation();var t=this._el.classList.contains(this._CONST.OPEN_CLASS);this._binds.removeAllOpened(),t?document.removeEventListener("click",this._binds.click):(document.addEventListener("click",this._binds.click),this._el.classList.add(this._CONST.OPEN_CLASS))}},{key:"_bindChoices",value:function(){var e=this;onix.element(this._CONST.OPTIONS_SEL,this._el).forEach(function(t){t.addEventListener("click",e._binds.choiceClick),e._optinsRef.push({el:t,event:"click",fn:e._binds.choiceClick})})}},{key:"_choiceClick",value:function(e){e.stopPropagation();var t=e.target||e.srcElement;if(t&&!t.parentNode.classList.contains(this._CONST.ACTIVE_CLASS)){var n=t.parentNode.parentNode.querySelector("."+this._CONST.ACTIVE_CLASS);n&&n.classList.remove(this._CONST.ACTIVE_CLASS),t.parentNode.classList.add(this._CONST.ACTIVE_CLASS),this._el.classList.remove(this._CONST.OPEN_CLASS),this._opts.addCaption&&this._captionTextEl&&(this._captionTextEl.innerHTML=t.innerHTML);var i=t.getAttribute("data-value")||"";this.trigger("change",i)}}},{key:"unbindChoices",value:function(){this._optinsRef.length&&(this._optinsRef.forEach(function(e){e.el.removeEventListener(e.event,e.fn)}),this._optinsRef=[])}},{key:"rebindChoices",value:function(){this.unbindChoices(),this._bindChoices()}},{key:"selectOption",value:function(e){e=e||0;var t=this._optinsRef.length;if(t>0&&e>=0&&e<t){var n=this._optinsRef[e].el,i=this._optinsRef[e].el.parentNode;if(!i.classList.contains(this._CONST.ACTIVE_CLASS)){i.classList.add(this._CONST.ACTIVE_CLASS),this._opts.addCaption&&this._captionTextEl&&(this._captionTextEl.innerHTML=n.innerHTML);var o=n.getAttribute("data-value")||"";this.trigger("change",o)}}}},{key:"setAddCaption",value:function(){var e=this;this._opts.addCaption&&this._optinsRef.every(function(t){var n=t.el.parentNode;return!n.classList.contains(e._CONST.ACTIVE_CLASS)||(e._captionTextEl.innerHTML=t.el.innerHTML,!1)})}}]),t}(t);return i}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();onix.factory("$slider",["$dom","$event","$common","$math",function(e,t,n,i){var o=function(t){function o(e,t){_classCallCheck(this,o);var n=_possibleConstructorReturn(this,Object.getPrototypeOf(o).call(this));n._eventInit(),n._parent=e,n._root=n._create(),n._opts={min:0,max:100,wheelStep:1,timeout:333};for(var i in t)n._opts[i]=t[i];return n._value=null,n._signalObj={id:null,lastValue:null},e.appendChild(n._root),n._binds={keyUp:n._keyUp.bind(n),click:n._click.bind(n),mouseDownCaret:n._mouseDownCaret.bind(n),mouseMove:n._mouseMove.bind(n),mouseWheel:n._mouseWheel.bind(n),mouseUp:n._mouseUp.bind(n),sendSignalInner:n._sendSignalInner.bind(n)},n._mouse={bcr:null},n._els.input.addEventListener("keyup",n._binds.keyUp),n._els.tube.addEventListener("click",n._binds.click),n._els.caret.addEventListener("mousedown",n._binds.mouseDownCaret),n._els.lineHolder.addEventListener("DOMMouseScroll",n._binds.mouseWheel),n._els.lineHolder.addEventListener("mousewheel",n._binds.mouseWheel),n.setValue(n._opts.max),n}return _inherits(o,t),_createClass(o,[{key:"_create",value:function(){return this._els={},e.create({el:"div",class:"slider",child:[{el:"input",type:"text",value:"",_exported:"input"},{el:"span",class:"line-holder",_exported:"lineHolder",child:[{el:"span",class:"lh-tube",_exported:"tube"},{el:"span",class:"lh-caret",_exported:"caret"}]}]},this._els)}},{key:"_setCaret",value:function(e){var t=this._els.lineHolder.offsetWidth;e<0?e=0:e>t&&(e=t),this._els.caret.style.left=e.toFixed(2)+"px"}},{key:"_getMouseXY",value:function(e){return{x:e.clientX-this._mouse.bcr.left,y:e.clientY-this._mouse.bcr.top}}},{key:"_setBCR",value:function(){this._mouse.bcr=this._els.lineHolder.getBoundingClientRect()}},{key:"_keyUp",value:function(){var e=this._els.input,t=parseFloat(e.value),n=!1;isNaN(t)||t<this._opts.min||t>this._opts.max?n=!0:(this.setValue(t),this._sendSignal(!0)),e.classList[n?"add":"remove"]("error")}},{key:"_click",value:function(e){n.cancelEvents(e),this._setBCR();var t=this._els.lineHolder.offsetWidth,i=this._getMouseXY(e).x,o=i/t;o<=.05?i=0:o>=.95&&(i=t),this._setCaret(i),this._setValue(i,!0)}},{key:"_mouseDownCaret",value:function(e){n.cancelEvents(e),this._setBCR(),document.addEventListener("mousemove",this._binds.mouseMove),document.addEventListener("mouseup",this._binds.mouseUp)}},{key:"_mouseMove",value:function(e){var t=(this._els.caret,this._getMouseXY(e).x);this._setCaret(t),this._setValue(t)}},{key:"_mouseUp",value:function(){document.removeEventListener("mousemove",this._binds.mouseMove),document.removeEventListener("mouseup",this._binds.mouseUp)}},{key:"_mouseWheel",value:function(e){var t=e.wheelDelta||-e.detail;t&&(n.cancelEvents(e),t>0?(this.setValue(this._value+this._opts.wheelStep),this._sendSignal()):(this.setValue(this._value-this._opts.wheelStep),this._sendSignal()))}},{key:"_getPosFromValue",value:function(e){e=e||this._value;var t=this._els.lineHolder.offsetWidth,n=this._opts.max-this._opts.min,i=(e-this._opts.min)/n*t;return i}},{key:"_setValue",value:function(e,t){e=e||0;var n=this._els.lineHolder.offsetWidth,i=this._opts.max-this._opts.min;e<0?e=0:e>n&&(e=n);var o=Math.round(e/n*i+this._opts.min);this._value=o,this._els.input.value=o,this._els.input.classList.remove("error"),this._sendSignal(!t)}},{key:"_sendSignal",value:function(e){this._signalObj.id&&(clearTimeout(this._signalObj.id),this._signalObj.id=null),e?this._signalObj.id=setTimeout(this._binds.sendSignalInner,this._opts.timeout):this._sendSignalInner()}},{key:"_sendSignalInner",value:function(){this._value!=this._signalObj.lastValue&&(this._signalObj.lastValue=this._value,this.trigger("change",this._value))}},{key:"setValue",value:function(e){return"number"==typeof e&&(e=i.setRange(e,this._opts.min,this._opts.max),this._value=e,this._els.input.value=e,this._els.input.classList.remove("error"),this._setCaret(this._getPosFromValue(e)),!0)}},{key:"getValue",value:function(){return this._value}},{key:"rewriteOpts",value:function(e){for(var t in e)this._opts[t]=e[t];this._value=i.setRange(this._value,this._opts.min,this._opts.max),this.setValue(this._value)}}]),o}(t);return o}]);var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();onix.factory("$crop",["$dom","$math","$common",function(e,t,n){var i=function(){function i(e){_classCallCheck(this,i),this._CONST={HIDE_CLASS:"hide"},this._options={width:250,height:250,minWidth:10,minHeight:10,maxWidth:1/0,maxHeight:1/0,resizable:!0,aspectRatio:0};for(var t in e)this._options[t]=e[t];this._dim={areaWidth:0,areaHeight:0,width:this._options.width,height:this._options.height},this._changed=!1,this._backupData=null,this._groups={"point-nw":[{type:"nw",x:!0,y:!0},{type:"sw",x:!0},{type:"ne",y:!0}],"point-ne":[{type:"ne",x:!0,y:!0},{type:"se",x:!0},{type:"nw",y:!0}],"point-sw":[{type:"sw",x:!0,y:!0},{type:"nw",x:!0},{type:"se",y:!0}],"point-se":[{type:"se",x:!0,y:!0},{type:"ne",x:!0},{type:"sw",y:!0}]},this._points={nw:{x:0,y:0},ne:{x:0,y:0},sw:{x:0,y:0},se:{x:0,y:0}},this._type=null,this._mouse={startXSave:0,startYSave:0,startX:0,startY:0},this._binds={mouseDown:this._mouseDown.bind(this),mouseMove:this._mouseMove.bind(this),mouseUp:this._mouseUp.bind(this)},this._dom={},this._create(),this._dom.container.addEventListener("mousedown",this._binds.mouseDown),this.hide()}return _createClass(i,[{key:"_create",value:function(){var t=["crop"];this._options.resizable&&t.push("resizable"),e.create({el:"div",class:t,child:[{el:"div",class:"crop-top",child:[{el:"span",class:"point-nw"},{el:"span",class:"point-ne"}],_exported:"cropTop"},{el:"div",class:"crop-bottom",child:[{el:"span",class:"point-sw"},{el:"span",class:"point-se"}],_exported:"cropBottom"},{el:"div",class:"crop-left",_exported:"cropLeft"},{el:"div",class:"crop-right",_exported:"cropRight"},{el:"div",class:"crop-middle",_exported:"cropMiddle"}],_exported:"container"},this._dom)}},{key:"_setCenter",value:function(){var e=this._dim.width,t=this._dim.height,n=Math.round((this._dim.areaWidth-e)/2),i=Math.round((this._dim.areaHeight-t)/2),o=this._points;o.nw.x=n,o.nw.y=i,o.ne.x=o.nw.x+e,o.ne.y=o.nw.y+t,o.sw.x=this._dim.areaWidth-n,o.sw.y=this._dim.areaHeight-i,o.se.x=o.ne.x,o.se.y=o.ne.y}},{key:"_alignPoints",value:function(){var e=this._points,n=this._dim.areaWidth-this._dim.width,i=this._dim.areaHeight-this._dim.height;e.nw.x=t.setRange(e.nw.x,0,n),e.sw.x=t.setRange(e.sw.x,0,n),e.ne.x=t.setRange(e.ne.x,this._dim.width,this._dim.areaWidth),e.se.x=t.setRange(e.se.x,this._dim.width,this._dim.areaWidth),e.nw.y=t.setRange(e.nw.y,0,i),e.ne.y=t.setRange(e.ne.y,0,i),e.sw.y=t.setRange(e.sw.y,this._dim.height,this._dim.areaHeight),e.se.y=t.setRange(e.se.y,this._dim.height,this._dim.areaHeight)}},{key:"_redraw",value:function(){var e=this._points,t=e.nw.x,n=e.nw.y,i=this._getSize();this._dom.cropTop.style.left=t+"px",this._dom.cropTop.style.width=i.width+"px",this._dom.cropTop.style.height=n+"px",this._dom.cropBottom.style.left=t+"px",this._dom.cropBottom.style.width=i.width+"px",this._dom.cropBottom.style.height=this._dim.areaHeight-e.sw.y+"px",this._dom.cropLeft.style.width=t+"px",this._dom.cropLeft.style.height=this._dim.areaHeight+"px",this._dom.cropRight.style.width=this._dim.areaWidth-e.ne.x+"px",this._dom.cropRight.style.height=this._dim.areaHeight+"px",this._dom.cropMiddle.style.width=i.width+"px",this._dom.cropMiddle.style.height=i.height+"px",this._dom.cropMiddle.style.left=t+"px",this._dom.cropMiddle.style.top=n+"px"}},{key:"_mouseDown",value:function(e){n.cancelEvents(e);var t=e.target||e.srcElement;switch(this._type=t.getAttribute("class"),this._type){case"crop-top":case"crop-bottom":case"crop-left":case"crop-right":return}this._mouse.startX=e.clientX,this._mouse.startY=e.clientY,this._mouse.startXSave=e.clientX,this._mouse.startYSave=e.clientY,document.addEventListener("mousemove",this._binds.mouseMove),document.addEventListener("mouseup",this._binds.mouseUp)}},{key:"_mouseMove",value:function(e){var t=this;n.cancelEvents(e);var i=e.clientX-this._mouse.startX,o=e.clientY-this._mouse.startY;if("crop-middle"==this._type)Object.keys(this._points).forEach(function(e){t._points[e].x+=i,t._points[e].y+=o}),this._alignPoints(),this._redraw();else{var r=this._groups[this._type];if(this._options.aspectRatio&&(o=i/this._options.aspectRatio*("point-nw"==this._type||"point-se"==this._type?1:-1)),this._resizeTest(i,o,r)){r.forEach(function(e){var n=t._points[e.type];n.x+=e.x?i:0,n.y+=e.y?o:0});var s=this._getSize();this._dim.width=s.width,this._dim.height=s.height,this._redraw()}}this._mouse.startX=e.clientX,this._mouse.startY=e.clientY}},{key:"_mouseUp",value:function(e){n.cancelEvents(e),document.removeEventListener("mousemove",this._binds.mouseMove),document.removeEventListener("mouseup",this._binds.mouseUp),this._mouse.startXSave==e.clientX&&this._mouse.startYSave==e.clientY||(this._changed=!0)}},{key:"_getSize",value:function(e){return e=e||this._points,{width:Math.abs(e.ne.x-e.nw.x),height:Math.abs(e.sw.y-e.nw.y)}}},{key:"_resizeTest",value:function(e,t,n){var i=this;if(!this._options.aspectRatio)return!1;var o={nw:{x:this._points.nw.x,y:this._points.nw.y},ne:{x:this._points.ne.x,y:this._points.ne.y},sw:{x:this._points.sw.x,y:this._points.sw.y},se:{x:this._points.se.x,y:this._points.se.y}};n.forEach(function(n){var r=o[n.type];r.x=i._points[n.type].x+(n.x?e:0),r.y=i._points[n.type].y+(n.y?t:0)});var r=this._getSize(o);return!(r.width<this._options.minWidth||r.width>this._options.maxWidth||r.height<this._options.minHeight||r.height>this._options.maxHeight||o.nw.x<0||o.se.x>this._dim.areaWidth||o.nw.y<0||o.sw.y>this._dim.areaHeight)}},{key:"setCenter",value:function(){this._setCenter(),this._redraw()}},{key:"fitToArea",value:function(){var e=void 0,t=void 0;if(this._options.aspectRatio){var n=this._options.aspectRatio;e=this._dim.areaWidth,t=Math.round(e/n),t>this._dim.areaHeight&&(t=this._dim.areaHeight,e=Math.round(t*n))}else e=Math.min(this._options.maxWidth,this._dim.areaWidth),t=Math.min(this._options.maxHeight,this._dim.areaHeight);this._dim.width=e,this._dim.height=t,this.setCenter()}},{key:"destroy",value:function(){var e=this.getContainer();e.parentNode&&e.parentNode.removeChild(e),this._dom.container.removeEventListener("mousedown",this._binds.mouseDown)}},{key:"getContainer",value:function(){return this._dom.container}},{key:"setDim",value:function(e){e=e||{},e.areaWidth&&(this._dim.areaWidth=e.areaWidth,this._dom.container.style.width=this._dim.areaWidth+"px"),e.areaHeight&&(this._dim.areaHeight=e.areaHeight,this._dom.container.style.height=this._dim.areaHeight+"px")}},{key:"show",value:function(){this._dom.container.classList.remove(this._CONST.HIDE_CLASS)}},{key:"hide",value:function(){this._dom.container.classList.add(this._CONST.HIDE_CLASS)}},{key:"isVisible",value:function(){return!this._dom.container.classList.contains(this._CONST.HIDE_CLASS)}},{key:"isChanged",value:function(){return this._changed}},{key:"backup",value:function(){this._backupData={changed:this._changed,aabb:this.getAABB()
}}},{key:"restore",value:function(){if(this._backupData){this._changed=this._backupData.changed;var e=this._backupData.aabb,t=this._points.nw,n=this._points.ne,i=this._points.sw,o=this._points.se;t.x=e[0],t.y=e[1],o.x=e[2],o.y=e[3],n.x=o.x,n.y=t.y,i.x=t.x,i.y=o.y,this._redraw(),this._backupData=null}}},{key:"getAABB",value:function(e){var t=this._points.nw,n=this._points.se;return e=e||1,[Math.round(t.x*e),Math.round(t.y*e),Math.round(n.x*e),Math.round(n.y*e)]}}]),i}();return i}]);