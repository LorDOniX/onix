/**
 * OnixJS framework
 * 2.2.0/18. 4. 2016
 * source: https://gitlab.com/LorDOniX/onix
 * documentation: https://gitlab.com/LorDOniX/onix/tree/master/docs
 */
;if(function(){Event=Event||window.Event,Event.prototype.stopPropagation=Event.prototype.stopPropagation||function(){this.cancelBubble=!0},Event.prototype.preventDefault=Event.prototype.preventDefault||function(){this.returnValue=!1}}(),Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){for(var c=this.length,d=0;c>d;d++)d in this&&a.call(b,this[d],d,this)}),Array.prototype.every||(Array.prototype.every=function(a,b){for(var c=this.length,d=0;c>d;d++)if(d in this&&!a.call(b,this[d],d,this))return!1;return!0}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c=this.length,d=b||0;for(0>d&&(d+=c);c>d;d++)if(d in this&&this[d]===a)return d;return-1}),!("console"in window)){var emptyFn=function(){};window.console={},["log","warn","error","clear","info"].forEach(function(a){window.console[a]=emptyFn})}if(Object.keys||(Object.keys=function(){"use strict";var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var f,g,h=[];for(f in e)a.call(e,f)&&h.push(f);if(b)for(g=0;d>g;g++)a.call(e,c[g])&&h.push(c[g]);return h}}()),function(){if(navigator.appVersion.indexOf("MSIE 8")>0){var a=Array.prototype.slice;Array.prototype.slice=function(){if(this instanceof Array)return a.apply(this,arguments);for(var b=[],c=arguments.length>=1?arguments[0]:0,d=arguments.length>=2?arguments[1]:this.length,e=c;d>e;e++)b.push(this[e]);return b}}}(),Object.create||(Object.create=function(a){if(arguments.length>1)throw new Error("Object.create polyfill only accepts the first parameter");var b=function(){};return b.prototype=a,new b}),Function.prototype.bind||(Function.prototype.bind=function(a){var b=this,c=Array.prototype.slice.call(arguments,1);return function(){return b.apply(a,c.concat(Array.prototype.slice.call(arguments)))}}),!("addEventListener"in document)){var w=Window.prototype,h=HTMLDocument.prototype,e=Element.prototype;w.addEventListener=h.addEventListener=e.addEventListener=function(a,b){if("DOMContentLoaded"==a)document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&b()});else{var c=this;this.attachEvent("on"+a,function(){return b.apply(c,arguments)})}},w.removeEventListener=h.removeEventListener=e.removeEventListener=function(a,b){return this.detachEvent("on"+a,b)}}"classList"in document.documentElement||!window.Element||!function(){function a(a){if(this._element=a,a.className!=this._classCache&&(this._classCache=a.className,this._classCache))for(var b=this._classCache.replace(/^\s+|\s+$/g,"").split(/\s+/),c=0;c<b.length;c++)g.call(this,b[c])}function b(a,b){a.className=b.join(" ")}function c(a,b,c){Object.defineProperty?Object.defineProperty(a,b,{get:c}):a.__defineGetter__(b,c)}var d=Array.prototype,e=d.indexOf,f=d.slice,g=d.push,h=d.splice,i=d.join;window.DOMTokenList=a,a.prototype={add:function(a){this.contains(a)||(g.call(this,a),b(this._element,f.call(this,0)))},contains:function(a){return-1!=e.call(this,a)},item:function(a){return this[a]||null},remove:function(a){var c=e.call(this,a);-1!=c&&(h.call(this,c,1),b(this._element,f.call(this,0)))},toString:function(){return i.call(this," ")},toggle:function(a){return-1==e.call(this,a)?(this.add(a),!0):(this.remove(a),!1)}},c(Element.prototype,"classList",function(){return new a(this)})}(),function(){function a(a){return!!a.exifdata}function b(a,b){b=b||a.match(/^data\:([^\;]+)\;base64,/im)[1]||"",a=a.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var c=atob(a),d=c.length,e=new ArrayBuffer(d),f=new Uint8Array(e),g=0;d>g;g++)f[g]=c.charCodeAt(g);return e}function c(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.responseType="blob",c.onload=function(a){(200==this.status||0===this.status)&&b(this.response)},c.send()}function d(a,d){function g(b){var c=e(b),g=f(b);a.exifdata=c||{},a.iptcdata=g||{},d&&d.call(a)}if(a.src)if(/^data\:/i.test(a.src)){var h=b(a.src);g(h)}else if(/^blob\:/i.test(a.src)){var i=new FileReader;i.onload=function(a){g(a.target.result)},c(a.src,function(a){i.readAsArrayBuffer(a)})}else{var j=new XMLHttpRequest;j.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";g(j.response),j=null},j.open("GET",a.src,!0),j.responseType="arraybuffer",j.send(null)}else if(window.FileReader&&(a instanceof window.Blob||a instanceof window.File)){var i=new FileReader;i.onload=function(a){l&&console.log("Got file of length "+a.target.result.byteLength),g(a.target.result)},i.readAsArrayBuffer(a)}}function e(a){var b=new DataView(a);if(l&&console.log("Got file of length "+a.byteLength),255!=b.getUint8(0)||216!=b.getUint8(1))return l&&console.log("Not a valid JPEG"),!1;for(var c,d=2,e=a.byteLength;e>d;){if(255!=b.getUint8(d))return l&&console.log("Not a valid marker at offset "+d+", found: "+b.getUint8(d)),!1;if(c=b.getUint8(d+1),l&&console.log(c),225==c)return l&&console.log("Found 0xFFE1 marker"),k(b,d+4,b.getUint16(d+2)-2);d+=2+b.getUint16(d+2)}}function f(a){var b=new DataView(a);if(l&&console.log("Got file of length "+a.byteLength),255!=b.getUint8(0)||216!=b.getUint8(1))return l&&console.log("Not a valid JPEG"),!1;for(var c=2,d=a.byteLength,e=function(a,b){return 56===a.getUint8(b)&&66===a.getUint8(b+1)&&73===a.getUint8(b+2)&&77===a.getUint8(b+3)&&4===a.getUint8(b+4)&&4===a.getUint8(b+5)};d>c;){if(e(b,c)){var f=b.getUint8(c+7);f%2!==0&&(f+=1),0===f&&(f=4);var h=c+8+f,i=b.getUint16(c+6+f);return g(a,h,i)}c++}}function g(a,b,c){for(var d,e,f,g,h,i=new DataView(a),k={},l=b;b+c>l;)28===i.getUint8(l)&&2===i.getUint8(l+1)&&(g=i.getUint8(l+2),g in t&&(f=i.getInt16(l+3),h=f+5,e=t[g],d=j(i,l+5,f),k.hasOwnProperty(e)?k[e]instanceof Array?k[e].push(d):k[e]=[k[e],d]:k[e]=d)),l++;return k}function h(a,b,c,d,e){var f,g,h,j=a.getUint16(c,!e),k={};for(h=0;j>h;h++)f=c+12*h+2,g=d[a.getUint16(f,!e)],!g&&l&&console.log("Unknown tag: "+a.getUint16(f,!e)),k[g]=i(a,f,b,c,e);return k}function i(a,b,c,d,e){var f,g,h,i,k,l,m=a.getUint16(b+2,!e),n=a.getUint32(b+4,!e),o=a.getUint32(b+8,!e)+c;switch(m){case 1:case 7:if(1==n)return a.getUint8(b+8,!e);for(f=n>4?o:b+8,g=[],i=0;n>i;i++)g[i]=a.getUint8(f+i);return g;case 2:return f=n>4?o:b+8,j(a,f,n-1);case 3:if(1==n)return a.getUint16(b+8,!e);for(f=n>2?o:b+8,g=[],i=0;n>i;i++)g[i]=a.getUint16(f+2*i,!e);return g;case 4:if(1==n)return a.getUint32(b+8,!e);for(g=[],i=0;n>i;i++)g[i]=a.getUint32(o+4*i,!e);return g;case 5:if(1==n)return k=a.getUint32(o,!e),l=a.getUint32(o+4,!e),h=new Number(k/l),h.numerator=k,h.denominator=l,h;for(g=[],i=0;n>i;i++)k=a.getUint32(o+8*i,!e),l=a.getUint32(o+4+8*i,!e),g[i]=new Number(k/l),g[i].numerator=k,g[i].denominator=l;return g;case 9:if(1==n)return a.getInt32(b+8,!e);for(g=[],i=0;n>i;i++)g[i]=a.getInt32(o+4*i,!e);return g;case 10:if(1==n)return a.getInt32(o,!e)/a.getInt32(o+4,!e);for(g=[],i=0;n>i;i++)g[i]=a.getInt32(o+8*i,!e)/a.getInt32(o+4+8*i,!e);return g}}function j(a,b,c){var d="";for(n=b;n<b+c;n++)d+=String.fromCharCode(a.getUint8(n));return d}function k(a,b){if("Exif"!=j(a,b,4))return l&&console.log("Not valid EXIF data! "+j(a,b,4)),!1;var c,d,e,f,g,i=b+6;if(18761==a.getUint16(i))c=!1;else{if(19789!=a.getUint16(i))return l&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)"),!1;c=!0}if(42!=a.getUint16(i+2,!c))return l&&console.log("Not valid TIFF data! (no 0x002A)"),!1;var k=a.getUint32(i+4,!c);if(8>k)return l&&console.log("Not valid TIFF data! (First offset less than 8)",a.getUint32(i+4,!c)),!1;if(d=h(a,i,i+k,q,c),d.ExifIFDPointer){f=h(a,i,i+d.ExifIFDPointer,p,c);for(e in f){switch(e){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":f[e]=s[e][f[e]];break;case"ExifVersion":case"FlashpixVersion":f[e]=String.fromCharCode(f[e][0],f[e][1],f[e][2],f[e][3]);break;case"ComponentsConfiguration":f[e]=s.Components[f[e][0]]+s.Components[f[e][1]]+s.Components[f[e][2]]+s.Components[f[e][3]]}d[e]=f[e]}}if(d.GPSInfoIFDPointer){g=h(a,i,i+d.GPSInfoIFDPointer,r,c);for(e in g){switch(e){case"GPSVersionID":g[e]=g[e][0]+"."+g[e][1]+"."+g[e][2]+"."+g[e][3]}d[e]=g[e]}}return d}var l=!1,m=this,o=function(a){return a instanceof o?a:this instanceof o?void(this.EXIFwrapped=a):new o(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=o),exports.EXIF=o):m.EXIF=o;var p=o.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},q=o.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},r=o.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},s=o.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}},t={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};o.getData=function(b,c){return(b instanceof Image||b instanceof HTMLImageElement)&&!b.complete?!1:(a(b)?c&&c.call(b):d(b,c),!0)},o.getTag=function(b,c){return a(b)?b.exifdata[c]:void 0},o.getAllTags=function(b){if(!a(b))return{};var c,d=b.exifdata,e={};for(c in d)d.hasOwnProperty(c)&&(e[c]=d[c]);return e},o.pretty=function(b){if(!a(b))return"";var c,d=b.exifdata,e="";for(c in d)d.hasOwnProperty(c)&&(e+="object"==typeof d[c]?d[c]instanceof Number?c+" : "+d[c]+" ["+d[c].numerator+"/"+d[c].denominator+"]\r\n":c+" : ["+d[c].length+" values]\r\n":c+" : "+d[c]+"\r\n");return e},o.readFromBinaryFile=function(a){return e(a)},"function"==typeof define&&define.amd&&define("exif-js",[],function(){return o})}.call(this),onix=function(){var a=function(){this._allObj=[],this._objects={},this._CONFIG_NAME="$config"};a.TYPES={SERVICE:1,FACTORY:2,CONSTANT:3,RUN:4},a.prototype.init=function(){this._objects[this._CONFIG_NAME]={},document.addEventListener("DOMContentLoaded",this._domLoad.bind(this))},a.prototype.bindDI=function(a,b){var c,d=[];return b=b||{},Array.isArray(a)?a.every(function(a){return"function"==typeof a?(c=a,!1):(d.push(a in b?b[a]:this._objects[a]),!0)},this):c=a,function(a,b){if(b){var e=Object.create(c.prototype);return c.apply(e,d),e}return c.apply(a||c,d)}},a.prototype._domLoad=function(){var b=[];this._allObj.forEach(function(c){switch(c.type){case a.TYPES.SERVICE:this._objects[c.name]=this.bindDI(c.param)(null,!0);break;case a.TYPES.FACTORY:this._objects[c.name]=this.bindDI(c.param)();break;case a.TYPES.CONSTANT:this._objects[c.name]=c.param;break;case a.TYPES.RUN:b.push(c.param)}},this),this._allObj.length=0,this.bindDI(this._run)(this),b.forEach(function(a){this.bindDI(a)()},this)},a.prototype._run=["$i18n","$template","$loader","$route","$myQuery",function(a,b,c,d,e){this.element=function(a,b){return new e.get(a,b)},c.init(),b.init(),window._=a._.bind(a)}],a.prototype.config=function(a){return"string"==typeof a?this._objects[this._CONFIG_NAME][a]:void("object"==typeof a&&Object.keys(a).forEach(function(b){this._objects[this._CONFIG_NAME][b]=a[b]}.bind(this)))},a.prototype.service=function(b,c){this._allObj.push({name:b,param:c,type:a.TYPES.SERVICE})},a.prototype.factory=function(b,c){this._allObj.push({name:b,param:c,type:a.TYPES.FACTORY})},a.prototype.constant=function(b,c){this._allObj.push({name:b,param:c,type:a.TYPES.CONSTANT})},a.prototype.run=function(b){this._allObj.push({param:b,type:a.TYPES.RUN})},a.prototype.getObject=function(a){return a=a||"",this._objects[a]},a.prototype.noop=function(){},a.prototype.info=function(){console.log("Onix JS Framework\nVersion: 2.2.0\nDate: 18. 4. 2016")};var b=new a;return b.init(),b}(),onix.config({TMPL_DELIMITER:{LEFT:"{{",RIGHT:"}}"}}),onix.service("$localStorage",function(){this._disable=!("localStorage"in window),this.set=function(a,b){!this._disable&&a&&localStorage.setItem(a,b)},this.get=function(a){return this._disable||!a?null:localStorage.getItem(a)},this.remove=function(a){return this._disable||!a?null:localStorage.removeItem(a)}}),onix.factory("$q",function(){var a=function(){this._E_STATES={IDLE:0,RESOLVED:1,REJECTED:2},this._state=this._E_STATES.IDLE,this._funcs=[],this._finishData=null};return a.prototype._resolveFuncs=function(a){this._funcs.forEach(function(b){(b["finally"]||b.isError&&a||!b.isError&&!a)&&b.fn(this._finishData)},this),this._funcs.length=0,this._state=a?this._E_STATES.REJECTED:this._E_STATES.RESOLVED},a.prototype._isAlreadyFinished=function(){this._state!=this._E_STATES.IDLE&&this._resolveFuncs(this._state==this._E_STATES.REJECTED)},a.prototype.resolve=function(a){this._finishData=a,this._resolveFuncs(!1)},a.prototype.reject=function(a){this._finishData=a,this._resolveFuncs(!0)},a.prototype.then=function(a,b){return a&&"function"==typeof a&&this._funcs.push({fn:a,isError:!1}),b&&"function"==typeof b&&this._funcs.push({fn:b,isError:!0}),this._isAlreadyFinished(),this},a.prototype.done=function(a){return this._funcs.push({fn:a,isError:!1}),this._isAlreadyFinished(),this},a.prototype.error=function(a){return this._funcs.push({fn:a,isError:!0}),this._isAlreadyFinished(),this},a.prototype["finally"]=function(a){return this._funcs.push({fn:a,"finally":!0}),this._isAlreadyFinished(),this},{all:function(b){var c=new a;if(Array.isArray(b)){var d=b.length,e=function(){d--,0==d&&c.resolve()};b.forEach(function(a){a["finally"](e)})}else c.resolve();return c},defer:function(){return new a}}}),onix.factory("$job",["$q",function(a){var b=function(){this._donePromise=a.defer(),this._tasks=[],this._taskDone={cb:null,scope:null}};return b.prototype.add=function(a,b,c){c=c||[],Array.isArray(c)||(c=[c]),this._tasks.push({task:a,scope:b,args:c})},b.prototype.start=function(){return this._tasks.length?(this._tasks.reverse(),this._doJob(),this._donePromise):void 0},b.prototype.clear=function(){this._tasks=[]},b.prototype.setTaskDone=function(a,b){this._taskDone.cb=a,this._taskDone.scope=b},b.prototype._doJob=function(){var a=this._tasks.length;if(0==a)this._donePromise.resolve();else{var b=this._tasks.pop(),c=function(){if(this._taskDone.cb){var a=Array.prototype.slice.call(arguments,0);this._taskDone.cb.apply(this._taskDone.scope||this._taskDone.cb,a)}this._doJob()}.bind(this);b.task.apply(b.scope||b.task,b.args.concat(c))}},{create:function(){return new b}}}]),onix.factory("$myQuery",function(){var a=function(a,b){return this._els=[],b=b||document,"string"==typeof a?this._els=b.querySelectorAll(a):Array.isArray(a)?this._els=a:this._els.push(a),this};return a.prototype._operation=function(a,b){Array.isArray(this._els)||(this._els=Array.prototype.slice.call(this._els)),this._els.forEach(function(c,d){a.apply(b||a,[c,d])})},a.prototype._setGetAll=function(a,b){if(a)return this._operation(function(c){c[b]=a}),this;var c=[];return this._operation(function(a){c.push(a[b])}),c.length?1==c.length?c[0]:c:null},a.prototype.getEl=function(a){return a=a||0,a>this._els.length?null:this._els[a]},a.prototype.attr=function(a,b){if(b)return this._operation(function(c){c.setAttribute(a,b)}),this;var c=[];return this._operation(function(b){c.push(b.getAttribute(a))}),c.length?1==c.length?c[0]:c:null},a.prototype.src=function(a){return this._setGetAll(a,"src")},a.prototype.hide=function(){return this._operation(function(a){a.style.display="none"}),this},a.prototype.show=function(a){return this._operation(function(b){b.style.display=a||""}),this},a.prototype.val=function(a){return this._setGetAll(a,"value")},a.prototype.html=function(a){return this._setGetAll(a,"innerHTML")},a.prototype.append=function(a){return this._operation(function(b){b.appendChild(a)}),this},a.prototype.addClass=function(a){return this._operation(function(b){b.classList.add(a)}),this},a.prototype.removeClass=function(a){return this._operation(function(b){b.classList.remove(a)}),this},a.prototype.toggleClass=function(a){return this._operation(function(b){b.classList.toggle(a)}),this},a.prototype.width=function(){var a=0;return this._operation(function(b){a+=b.offsetWidth}),a},a.prototype.height=function(){var a=0;return this._operation(function(b){a+=b.offsetHeight}),a},a.prototype.click=function(a,b){return this._operation(function(c){c.addEventListener("click",function(d){a.apply(b||a,[d,c])})}),this},a.prototype.change=function(a,b){return this._operation(function(c){c.addEventListener("change",function(d){a.apply(b||a,[d,c])})}),this},a.prototype.forEach=function(a,b){return this._operation(function(c,d){a.apply(b||a,[c,d])}),this},a.prototype.remove=function(){return this._operation(function(a){a.parentNode.removeChild(a)}),this},a.prototype.prepend=function(a){return this._operation(function(b){b.parentNode.insertBefore(a,b)}),this},a.prototype.empty=function(){return this._operation(function(a){for(;a.firstChild;)a.removeChild(a.firstChild)}),this},a.prototype.len=function(){return this._els.length},{get:function(b,c){return new a(b,c)}}}),onix.service("$dom",function(){this.create=function(a,b){var c=document.createElement(a.el);return Object.keys(a).forEach(function(d){switch(d){case"el":break;case"attrs":Object.keys(a.attrs).forEach(function(b){c.setAttribute(b,a.attrs[b])});break;case"events":a.events.forEach(function(a){c.addEventListener(a.event,a.fn)});break;case"child":a.child.forEach(function(a){c.appendChild(this.create(a,b))},this);break;case"_exported":b[a._exported]=c;break;case"class":var e=a["class"];"string"==typeof e?c.classList.add(e):Array.isArray(e)&&e.forEach(function(a){c.classList.add(a)});break;default:c[d]=a[d]}},this),c},this.get=function(a,b){var c;return b=b||document,"string"==typeof a&&a?c=b.querySelector(a):Array.isArray(a)&&(c={},a.forEach(function(a){if("string"==typeof a){var d=a.replace(/^[.# ]+/g,"");c[d]=b.querySelector(a)}else{var d=a.sel.replace(/^[.# ]+/g,"");c[a.name||d]=b.querySelector(a.sel)}})),c}}),onix.service("$location",function(){this.refresh=function(){window.location.reload()},this.createSearchURL=function(a){var b=[];if(a){var b=[];Object.keys(a).forEach(function(c){b.push(c+"="+encodeURIComponent(a[c]))})}return b.length?"?"+b.join("&"):""},this.search=function(a){if(!a){var b=location.search,c={};return b&&(b=b.replace("?",""),b.split("&").forEach(function(a){var b=a.split("=");c[b[0]]=decodeURIComponent(b[1])})),c}var d=this.createSearchURL(a);d&&(window.location.search=d)},this.get=function(){return window.location.pathname}}),onix.service("$common",["$q",function(a){this._objCopy=function(a,b){Object.keys(b).forEach(function(c){if(b.hasOwnProperty(c)){var d=b[c],e=typeof d;if(Array.isArray(d)){var f=[];d.forEach(function(a){f.push(a)}),a[c]=f}else d&&"object"===e?(c in a||(a[c]={}),this._objCopy(a[c],d)):a[c]=d}}.bind(this))},this.getCookie=function(a){var b=null;if(document.cookie&&""!=document.cookie){var c=document.cookie.split(";");c.every(function(c){return c=c.trim(),c.substring(0,a.length+1)==a+"="?(b=decodeURIComponent(c.substring(a.length+1)),!1):!0})}return b},this.confirm=function(b){var c=a.defer();return confirm(b)?c.resolve():c.reject(),c},this.create=function(a,b,c){var d=[];return b&&c&&Array.isArray(b)&&b.forEach(function(a){d.push(onix.getObject(a))}),d.push(a),d.push(c||b),this.merge.apply(this,d)},this.merge=function(){var a=arguments.length,b={};if(a>0)for(var c=0;a>c;c++){var d=arguments[c];this._objCopy(b,d)}return b},this.extend=function(a,b){a=a||{},b=b||{},this._objCopy(a,b)},this.bindWithoutScope=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){var c=Array.prototype.slice.call(arguments,0),d=Array.prototype.concat(c,b);return a.apply(this,d)}},this.nodesForEach=function(a,b,c){b=b||function(){},a&&Array.prototype.slice.call(a).forEach(function(a,d){b.apply(c||b,[a,d])})},this.reverseForEach=function(a,b,c){a=a||[],b=b||function(){};for(var d=a.length-1;d>=0;d--)b.apply(c||this,[a[d],d])},this.hxToDe=function(a){switch(a=a.toLowerCase()){case"a":return 10;case"b":return 11;case"c":return 12;case"d":return 13;case"e":return 14;case"f":return 15;default:return parseInt(a,10)}},this.hexToRGB=function(a){return"#"==a[0]?(a=a.replace("#",""),3==a.length?{r:16*this.hxToDe(a[0])+this.hxToDe(a[0]),g:16*this.hxToDe(a[1])+this.hxToDe(a[1]),b:16*this.hxToDe(a[2])+this.hxToDe(a[2])}:{r:16*this.hxToDe(a[0])+this.hxToDe(a[1]),g:16*this.hxToDe(a[2])+this.hxToDe(a[3]),b:16*this.hxToDe(a[4])+this.hxToDe(a[5])}):a},this.isElement=function(a){return a instanceof HTMLElement},this.isObject=function(a){return"object"==typeof a&&!Array.isArray(a)&&null!==a}}]),onix.service("$notify",function(){var a=function(a){return this._el=a,this._HIDE_TIMEOUT=1500,this._options={ok:"alert-success",error:"alert-danger",info:"alert-info",warn:"alert-warning"},this};a.prototype._setValue=function(a){$common.isElement(a)?onix.element(this._el).empty().append(a):"string"==typeof a&&(this._el.innerHTML=a)},a.prototype.reset=function(){return Object.keys(this._options).forEach(function(a){this._el.classList.remove(this._options[a])}.bind(this)),this},a.prototype.ok=function(a){return this._el.classList.add(this._options.ok),this._setValue(a),this},a.prototype.error=function(a){return this._el.classList.add(this._options.error),this._setValue(a),this},a.prototype.info=function(a){return this._el.classList.add(this._options.info),this._setValue(a),this},a.prototype.warn=function(a){return this._el.classList.add(this._options.warn),this._setValue(a),this},a.prototype.hide=function(){var a=$q.defer();return setTimeout(function(){this.reset(),a.resolve()}.bind(this),this._HIDE_TIMEOUT),a},this.get=function(b){return new a(b)}}),onix.factory("$event",["$common",function(a){return{_allEvents:[],_getEvents:function(a){var b=[];return this._allEvents.forEach(function(c,d){a==c.name&&b.push({item:c,pos:d})}),b},on:function(a,b,c){this._allEvents.push({name:a,fn:b,scope:c})},off:function(b,c){var d=this._getEvents(b);a.reverseForEach(d,function(a){(!c||c&&a.fn==c)&&this._allEvents.splice(a.pos,1)},this)},once:function(a,b,c){this._allEvents.push({name:a,fn:b,scope:c,once:!0})},trigger:function(b){var c=this._getEvents(b),d=arguments,e=[];c.forEach(function(a){var b=Array.prototype.slice.call(d,0);b.shift();var c=a.item;c.fn.apply(c.scope||this,b),c.once&&e.push(a.pos)},this),a.reverseForEach(e,function(a){this._allEvents.splice(a,1)},this)}}}]),onix.service("$loader",["$dom",function(a){this._create=function(){this._el=a.create({el:"div","class":"loader"}),document.body.insertBefore(this._el,document.body.firstChild)},this.init=function(){this._create()},this.start=function(){this._el.classList.add("start")},this.end=function(){this._el.classList.remove("start"),this._el.classList.add("end"),setTimeout(function(){this._el.classList.remove("end"),this._el.classList.add("hide"),setTimeout(function(){this._el.classList.remove("hide")}.bind(this),350)}.bind(this),150)}}]),onix.service("$http",["$q","$common",function(a,b){this._preparePostData=function(a){var b=new FormData;return a&&(Array.isArray(a)?a.forEach(function(a){b.append(a.name,a.value)}):Object.keys(a).forEach(function(c){b.append(c,a[c])})),b},this._updateURL=function(a,b){if(b){var c=[];Array.isArray(b)&&(b.forEach(function(a){c.push(a.name+"="+encodeURIComponent(a.value))}),a+=(-1==a.indexOf("?")?"?":"")+c.join("&"))}return a},this.POST_TYPES={JSON:1,FORM_DATA:2},this.METHOD={POST:"POST",GET:"GET",DELETE:"DELETE",PATCH:"PATCH"},this.createRequest=function(c){var d=a.defer(),e=new XMLHttpRequest;c=c||{};var f=c.method||this.METHOD.GET,g=c.url||"";if(!g)return d.reject(),d;g=this._updateURL(g,c.getData),e.onerror=function(){d.reject()},e.open(f,g,!0),e.onreadystatechange=function(){if(4==e.readyState){var a=e.responseText||"",b=e.getResponseHeader("Content-Type"),c=null;c="application/json"==b?a.length?JSON.parse(a):{}:a,d[e.status>=200&&e.status<300?"resolve":"reject"]({status:e.status,data:c,url:g,method:f})}};try{var h=c.headers;b.isObject(h)&&Object.keys(h).forEach(function(a){e.setRequestHeader(a,h[a])}),f==this.METHOD.GET&&e.setRequestHeader("Accept","application/json");var i=c.postType||this.POST_TYPES.JSON;c.postData&&i==this.POST_TYPES.JSON?(e.setRequestHeader("Content-Type","application/json; charset=UTF-8"),e.send(JSON.stringify(c.postData))):c.postData&&i==this.POST_TYPES.FORM_DATA?e.send(this._preparePostData(c.postData)):e.send()}catch(j){d.reject()}return d}}]),onix.service("$i18n",["$http","$q",function(a,b){this._langs={},this._currentLang="",this.addLanguage=function(a,b){this._langs[a]=b},this.setLanguage=function(a){this._currentLang=a},this._=function(a,b){a=a||"";var c=this._langs[this._currentLang],d="";if(c){var e=a.split("."),f=e.length;e.every(function(a,b){return a in c?(c=c[a],b==f-1?(d=c,!1):!0):!1})}return this._transReplace(d,b)},this._transReplace=function(a,b){a=a||"",b=b||{};var c=a.match(/{[^}]+,.*}|{[^}]*}/g);if(c){var d={};c.forEach(function(a){var c=a;c.length>2&&(c=c.substr(1,c.length-2));var e=c.split(","),f=e[0].trim(),g={};if(2==e.length){var h=e[1].match(/[a-zA-Z0-9_]+{[^}]*}/g);h&&h.forEach(function(a){var b=a.split("{"),c=b[1];c=c.substr(0,c.length-1),g[b[0].trim()]=c})}var i=f in b?b[f]:"";if("number"==typeof i&&Object.keys(g).length){var j;switch(i){case 1:j="one";break;case 2:case 3:case 4:j="few";break;default:j="other"}i=j in g?g[j]:""}d[a]=i}),Object.keys(d).forEach(function(b){a=a.replace(new RegExp(b,"g"),d[b])})}return a},this.loadLanguage=function(c,d){var e=b.defer();return a.createRequest({url:d}).then(function(a){this.addLanguage(c,a.data),e.resolve()}.bind(this),function(a){e.resolve()}),e}}]),onix.service("$template",["$common","$q","$http","$config",function(a,b,c,d){this._cache={},this._RE={VARIABLE:/[$_a-zA-Z][$_a-zA-Z0-9]+/g,NUMBERS:/[-]?[0-9]+[.]?([0-9e]+)?/g,STRINGS:/["'][^"']+["']/g,JSONS:/[{][^}]+[}]/g,ALL:/[-]?[0-9]+[.]?([0-9e]+)?|["'][^"']+["']|[{][^}]+[}]|[$_a-zA-Z][$_a-zA-Z0-9]+/g},this._parseFnName=function(a){return a=a||"",a.match(/[a-zA-Z0-9_]+/)[0]},this._parseArgs=function(a,b){argsValue=a?a.replace(/^[^(]+./,"").replace(/\).*$/,""):"";var c=[],d=argsValue.match(this._RE.ALL);if(d){var e=[];d.forEach(function(a){var c;if(a.match(this._RE.STRINGS))c=a.substr(1,a.length-2);else if(a.match(this._RE.NUMBERS))c=parseFloat(a);else if(a.match(this._RE.JSONS))c=JSON.parse(a);else if(a.match(this._RE.VARIABLE)){var d=a.match(this._RE.VARIABLE)[0];c="$event"==d?b.event:"$element"==d?b.el:null}e.push({value:c,pos:argsValue.indexOf(a)})},this),e.length&&e.sort(function(a,b){return a.pos-b.pos}).forEach(function(a){c.push(a.value)})}return c},this._bindEvent=function(b,c,d,e){d&&this._parseFnName(d)in e&&b.addEventListener(c,a.bindWithoutScope(function(a,b){var d=this.getAttribute("data-"+c),f=b._parseFnName(d),g=b._parseArgs(d,{
el:this,event:a});e[f].apply(e,g)},this))},this.init=function(){onix.element("script[type='text/template']").forEach(function(a){this.add(a.id,a.innerHTML)},this)},this.add=function(a,b){this._cache[a]=b},this.compile=function(a,b){var c=this.get(a),e=d.TMPL_DELIMITER;return b&&Object.keys(b).forEach(function(a){c=c.replace(new RegExp(e.LEFT+"[ ]*"+a+"[ ]*"+e.RIGHT,"g"),b[a])}),c},this.get=function(a){return this._cache[a]||""},this.bindTemplate=function(a,b){var c=onix.element("*[data-click], *[data-change], *[data-bind], *[data-keydown]",a);if(c.len()){var d={};c.forEach(function(a){this._bindEvent(a,"click",a.getAttribute("data-click"),b),this._bindEvent(a,"change",a.getAttribute("data-change"),b),this._bindEvent(a,"keydown",a.getAttribute("data-keydown"),b);var c=a.getAttribute("data-bind");c&&(d[c]=a)},this),"addEls"in b&&"function"==typeof b.addEls&&b.addEls(d)}},this.load=function(a,d){var e=b.defer();return c.createRequest({url:d}).then(function(b){this.add(a,b.data),e.resolve()}.bind(this),function(a){e.reject()}),e}}]),onix.service("$route",["$location","$template",function(a,b){this._routes=[],this._otherwise=null,this.when=function(a,b){return this._routes.push({url:a,config:b}),this},this.otherwise=function(a){return this._otherwise={config:a},this},this._runController=function(a,b){if("string"==typeof a){var c=onix.getObject(a);onix.bindDI(c,b)()}else Array.isArray(a)?onix.bindDI(a,b)():"function"==typeof a&&a.apply(a,[b])},this.go=function(){var c=a.get(),d=!1,e=null;if(this._routes.every(function(a){return c.match(new RegExp(a.url))?(e=a.config,d=!0,!1):!0}),!d&&this._otherwise&&(e=this._otherwise.config),e){var f=null,g=null,h={};Object.keys(e).forEach(function(a){var b=e[a];switch(a){case"templateUrl":f=b;break;case"controller":g=b;break;default:h[a]=b}}),f?b.load(e.templateUrl,e.templateUrl).done(function(){g&&this._runController(g,h)}.bind(this)):g&&this._runController(g,h)}}}]),onix.factory("$select",["$common","$event","$dom",function(a,b,c){var d=function(c,d){a.extend(this,b),this._opts={addCaption:!1};for(var e in d)this._opts[e]=d[e];this._const={CAPTION_SEL:".dropdown-toggle",OPTIONS_SEL:".dropdown-menu a",CARET_SEL:".caret",OPEN_DROPDOWN_SEL:".dropdown.open",OPEN_CLASS:"open",ACTIVE_CLASS:"active"},this._el=c,this._optinsRef=[],this._captionEl=null,this.captionTextEl=null,this._binds={captionClick:a.bindWithoutScope(this._captionClick,this),choiceClick:a.bindWithoutScope(this._choiceClick,this)},this._bind()};return d.prototype._bind=function(){this._bindCaption(),this._bindChoices()},d.prototype._bindCaption=function(){var a=this._el.querySelector(this._const.CAPTION_SEL);if(a&&(a.addEventListener("click",this._binds.captionClick),this._opts.addCaption)){var b=a.querySelector(this._const.CARET_SEL);if(b){var d=c.create({el:"span","class":"add-caption"});a.insertBefore(d,b),this._captionTextEl=d}}this._captionEl=a},d.prototype._captionClick=function(a,b){var c=b._const;a.stopPropagation();var d=b._el.classList.contains(c.OPEN_CLASS),e=function(){onix.element(c.OPEN_DROPDOWN_SEL).forEach(function(a){a.classList.remove("open")})},f=function(){e(),window.removeEventListener("click",f)};e(),d?window.removeEventListener("click",f):(window.addEventListener("click",f),b._el.classList.add(c.OPEN_CLASS))},d.prototype._bindChoices=function(){onix.element(this._const.OPTIONS_SEL,this._el).forEach(function(a){a.addEventListener("click",this._binds.choiceClick),this._optinsRef.push({el:a,event:"click",fn:this._binds.choiceClick})},this)},d.prototype._choiceClick=function(a,b){var c=b._const;if(a.stopPropagation(),!this.parentNode.classList.contains(c.ACTIVE_CLASS)){var d=this.parentNode.parentNode.querySelector("."+c.ACTIVE_CLASS);d&&d.classList.remove(c.ACTIVE_CLASS),this.parentNode.classList.add(c.ACTIVE_CLASS),b._el.classList.remove(c.OPEN_CLASS),b._opts.addCaption&&b._captionTextEl&&(b._captionTextEl.innerHTML=this.innerHTML);var e=this.getAttribute("data-value")||"";b.trigger("change",e)}},d.prototype.unbindChoices=function(){this._optinsRef.length&&(this._optinsRef.forEach(function(a){a.el.removeEventListener(a.event,a.fn)}),this._optinsRef=[])},d.prototype.rebindChoices=function(){this.unbindChoices(),this._bindChoices()},d.prototype.selectOption=function(a){"undefined"==typeof a&&(a=0);var b=this._optinsRef.length;if(b>0&&a>=0&&b>a){var c=this._optinsRef[a].el,d=this._optinsRef[a].el.parentNode;if(!d.classList.contains(this._const.ACTIVE_CLASS)){d.classList.add(this._const.ACTIVE_CLASS),this._opts.addCaption&&this._captionTextEl&&(this._captionTextEl.innerHTML=c.innerHTML);var e=c.getAttribute("data-value")||"";this.trigger("change",e)}}},d.prototype.setAddCaption=function(){this._opts.addCaption&&this._optinsRef.every(function(a){var b=a.el.parentNode;return b.classList.contains(this._const.ACTIVE_CLASS)?(this._captionTextEl.innerHTML=a.el.innerHTML,!1):!0},this)},d}]),onix.factory("$uploadImages",["$job","$q","$dom",function(a,b,c){var d=function(){this._disable=!("FileReader"in window),this._const={previewMaxSize:180}};return d.prototype._doJobs=function(c,d,e,f){for(var g=c.length,h=[],i=0;g>i;i++){var j=i%e;h[j]||(h[j]=a.create(),f&&h[j].setTaskDone(f.cb,f.scope)),h[j].add(d,this,c[i])}var k=[];return h.forEach(function(a){k.push(a.start())}),b.all(k)},d.prototype._isPicture=function(a){return a?"image/jpeg"==a.type||"image/pjpeg"==a.type||"image/png"==a.type:!1},d.prototype._readFile=function(a,b){var c=a.file,d=a.previewID,a={file:c,exif:null,img:null},e=this._createPreview(c);d in this._dom?this._dom[d].appendChild(e.cont):this._dom.previewItems.appendChild(e.cont);var f=new FileReader;f.onload=function(d){var g=f.result,h=new Uint8Array(g),i=null;"png"!=c.type&&(i=EXIF.readFromBinaryFile(g));var j=new Image;j.onload=function(){var c=this._getImageDim(j),d=this._processInputImage(j,c,i.Orientation);e.cont.classList.remove("preview-loading"),e.canvasCover.innerHTML="",e.canvasCover.appendChild(d),a.exif=i,a.img=j,b()}.bind(this),j.src=this._fileToBase64(c.type,h)}.bind(this),f.readAsArrayBuffer(c)},d.prototype._createPreview=function(a){var b={},d=c.create({el:"span","class":["preview-item","preview-loading"],child:[{el:"span","class":"canvas-cover",child:[{el:"img","class":"preview-loader",src:"/static/img/loading.gif"}],_exported:"canvasCover"},{el:"span","class":"title",innerHTML:a.name.replace(/\..*/g,"")}]},b);return{cont:d,canvasCover:b.canvasCover}},d.prototype._getImageDim=function(a){var b=this._const.previewMaxSize,c=a.width>b,d=a.height>b,e={width:a.width,height:a.height,scale:1,large:!1};if(c||d){var f=a.width,g=a.height;a.width>a.height?(g=b*g/f,f=b):(f=b*f/g,g=b),e.scale=a.width/f,e.width=f,e.height=g,e.large=!0}return e},d.prototype._processInputImage=function(a,b,c){var d=document.createElement("canvas"),e=d.getContext("2d"),f=!0;if(d.width=b.width,d.height=b.height,c)switch(c){case 2:e.translate(b.width,0),e.scale(-1,1);break;case 3:e.translate(b.width,b.height),e.rotate(Math.PI);break;case 4:e.translate(0,b.height),e.scale(1,-1);break;case 5:d.width=b.height,d.height=b.width,e.rotate(.5*Math.PI),e.scale(1,-1),b.large&&(e.clearRect(0,0,d.width,d.height),e.drawImage(a,0,0,a.width,a.height,0,0,d.height,d.width),f=!1);break;case 6:d.width=b.height,d.height=b.width,e.rotate(.5*Math.PI),e.translate(0,-b.height),b.large&&(e.clearRect(0,0,d.width,d.height),e.drawImage(a,0,0,a.width,a.height,0,0,d.height,d.width),f=!1);break;case 7:d.width=b.height,d.height=b.width,e.rotate(.5*Math.PI),e.translate(b.width,-b.height),e.scale(-1,1),b.large&&(e.clearRect(0,0,d.width,d.height),e.drawImage(a,0,0,a.width,a.height,0,0,d.height,d.width),f=!1);break;case 8:d.width=b.height,d.height=b.width,e.rotate(-.5*Math.PI),e.translate(-b.width,0),b.large&&(e.clearRect(0,0,d.width,d.height),e.drawImage(a,0,0,a.width,a.height,0,0,d.height,d.width),f=!1)}return f&&(e.clearRect(0,0,d.width,d.height),b.large?e.drawImage(a,0,0,a.width,a.height,0,0,d.width,d.height):e.drawImage(a,0,0)),d},d.prototype._fileToBase64=function(a,b){for(var c=b.length,d="",e=0;c>e;e+=1)d+=String.fromCharCode(b[e]);return"data:"+a+";base64,"+btoa(d)},d.prototype._createPreviewHolders=function(a,b){if(a&&(4==b||7==b)){var d={};7==b&&a.appendChild(c.create({el:"div",child:[{el:"span",_exported:"img_06"}]},d));for(var e=[],f=7==b?6:4,g=0;f>g;g++)e.push({el:"span",_exported:"img_0"+g});a.appendChild(c.create({el:"div",child:e},d));for(var g=0;b>g;g++)this._dom["img_0"+g]=d["img_0"+g]}},d.prototype.show=function(a,b){if(!this._disable&&a&&b){a.innerHTML="",this._dom={previewItems:a};var c=this.getPictureFiles(b),d=c.length;d&&(this._createPreviewHolders(a,d),c=c.sort(function(a,b){return a.name<b.name?-1:a.name>b.name?1:0}).map(function(a,b){return{file:a,previewID:"img_0"+b}}),this._doJobs(c,this._readFile,2))}},d.prototype.getPictureFiles=function(a){var b=[];if(a&&a.length)for(var c=0;c<a.length;c++){var d=a[c];this._isPicture(d)&&b.push(d)}return b},d.prototype.getPicturesCount=function(a){return this.getPictureFiles(a).length},d}]);